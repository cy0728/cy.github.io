<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>微信小程序 | 小逸的博客</title><meta name="description" content="1.微信小程序1.1 简介微信小程序是一种不需要下载安装即可使用的应用，用户搜一搜或扫一扫即可打开应用。   小程序与传统APP相比又有哪些优势？  1：小程序开发成本比APP低； 2：小程序获客成本远低于APP； 3：APP开发周期慢，制作成本高、而小程序符合快速创业的精神，降低创业门槛； 4：APP生态体系已饱和，App Store排名竞争激烈，而小程序属于新生事物，发展空间充满无限想象。"><meta name="author" content="小逸"><meta name="copyright" content="小逸"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/logo.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="微信小程序"><meta name="twitter:description" content="1.微信小程序1.1 简介微信小程序是一种不需要下载安装即可使用的应用，用户搜一搜或扫一扫即可打开应用。   小程序与传统APP相比又有哪些优势？  1：小程序开发成本比APP低； 2：小程序获客成本远低于APP； 3：APP开发周期慢，制作成本高、而小程序符合快速创业的精神，降低创业门槛； 4：APP生态体系已饱和，App Store排名竞争激烈，而小程序属于新生事物，发展空间充满无限想象。"><meta name="twitter:image" content="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2455514678,1879015385&amp;fm=26&amp;gp=0.jpg"><meta property="og:type" content="article"><meta property="og:title" content="微信小程序"><meta property="og:url" content="http://yoursite.com/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><meta property="og:site_name" content="小逸的博客"><meta property="og:description" content="1.微信小程序1.1 简介微信小程序是一种不需要下载安装即可使用的应用，用户搜一搜或扫一扫即可打开应用。   小程序与传统APP相比又有哪些优势？  1：小程序开发成本比APP低； 2：小程序获客成本远低于APP； 3：APP开发周期慢，制作成本高、而小程序符合快速创业的精神，降低创业门槛； 4：APP生态体系已饱和，App Store排名竞争激烈，而小程序属于新生事物，发展空间充满无限想象。"><meta property="og:image" content="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2455514678,1879015385&amp;fm=26&amp;gp=0.jpg"><meta property="article:published_time" content="2019-11-10T16:00:00.000Z"><meta property="article:modified_time" content="2020-04-28T02:54:49.424Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://yoursite.com/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><link rel="prev" title="Flex布局教程：语法篇-阮一峰" href="http://yoursite.com/2019/11/25/Flex%E5%B8%83%E5%B1%80%E6%95%99%E7%A8%8B%EF%BC%9A%E8%AF%AD%E6%B3%95%E7%AF%87-%E9%98%AE%E4%B8%80%E5%B3%B0/"><link rel="next" title="Create-React-App" href="http://yoursite.com/2019/10/20/Create-React-App/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="小逸的博客" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-微信小程序"><span class="toc-number">1.</span> <span class="toc-text">1.微信小程序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-简介"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-小程序开发者账号注册"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 小程序开发者账号注册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-微信开发工具的使用"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 微信开发工具的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-微信小程序文件结构"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 微信小程序文件结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-主体文件结构"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.4.1 主体文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-页面文件结构"><span class="toc-number">1.4.2.</span> <span class="toc-text">1.4.2 页面文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-3-其他文件"><span class="toc-number">1.4.3.</span> <span class="toc-text">1.4.3 其他文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-微信小程序配置-app-json"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 微信小程序配置-app.json</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-1-app-json-配置项列表"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.5.1 app.json 配置项列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-2-window配置"><span class="toc-number">1.5.2.</span> <span class="toc-text">1.5.2 window配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-3-tabBar"><span class="toc-number">1.5.3.</span> <span class="toc-text">1.5.3 tabBar</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-页面配置-index-index-json"><span class="toc-number">1.6.</span> <span class="toc-text">1.6 页面配置-index&#x2F;index.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-微信小程序代码解析"><span class="toc-number">1.7.</span> <span class="toc-text">1.7 微信小程序代码解析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-页面层数据、事件"><span class="toc-number">2.</span> <span class="toc-text">2.页面层数据、事件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-页面层数据绑定"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 页面层数据绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-wxs语法"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 wxs语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-wxml语法"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 wxml语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-列表渲染"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 列表渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wx-key-提高列表渲染时排序的效率"><span class="toc-number">2.3.2.</span> <span class="toc-text">wx:key   提高列表渲染时排序的效率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-条件渲染"><span class="toc-number">2.3.3.</span> <span class="toc-text">2.3.2 条件渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-3-模板语法"><span class="toc-number">2.3.4.</span> <span class="toc-text">2.3.3 模板语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-4-import-和-include"><span class="toc-number">2.3.5.</span> <span class="toc-text">2.3.4 import 和 include</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-尺寸单位和样式"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 尺寸单位和样式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-1-尺寸单位"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 尺寸单位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-2-样式导入"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2 样式导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-3-选择器"><span class="toc-number">2.4.3.</span> <span class="toc-text">2.4.3 选择器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-4-小程序中使用less"><span class="toc-number">2.4.4.</span> <span class="toc-text">2.4.4 小程序中使用less</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-事件"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-事件绑定"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1 事件绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-事件冒泡"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2 事件冒泡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3-单向数据流"><span class="toc-number">2.5.3.</span> <span class="toc-text">2.5.3 单向数据流</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-获取页面元素"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 获取页面元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-动画"><span class="toc-number">2.7.</span> <span class="toc-text">2.7 动画</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1-CSS动画"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.7.1 CSS动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2-使用wx-createAnimation接口"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.7.2 使用wx.createAnimation接口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-登陆页面案例"><span class="toc-number">3.</span> <span class="toc-text">3.登陆页面案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-没有抽象事件处理函数"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 没有抽象事件处理函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-抽象公共的事件处理函数"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 抽象公共的事件处理函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-使用表单实现登陆"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 使用表单实现登陆</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-微信小程序组件"><span class="toc-number">4.</span> <span class="toc-text">4.微信小程序组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-基础内容组件"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 基础内容组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-表单组件"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 表单组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-button组件"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1 button组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-常用表单组件"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2 常用表单组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-3-picker"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.2.3 picker</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-交互组件"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 交互组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-媒体组件"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 媒体组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-1-image"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.4.1 image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-2-audio"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.4.2 audio</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-3-camera"><span class="toc-number">4.4.3.</span> <span class="toc-text">4.4.3 camera</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-4-vedio组件"><span class="toc-number">4.4.4.</span> <span class="toc-text">4.4.4 vedio组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-常用布局标签"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 常用布局标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-1-scroll-view"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.5.1 scroll-view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-2-swiper"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.5.2 swiper</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-地图组件"><span class="toc-number">4.6.</span> <span class="toc-text">4.6 地图组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-画布"><span class="toc-number">4.7.</span> <span class="toc-text">4.7 画布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8-flex布局"><span class="toc-number">4.8.</span> <span class="toc-text">4.8 flex布局</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-1-flex简介"><span class="toc-number">4.8.1.</span> <span class="toc-text">4.8.1 flex简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-2-flex使用说明"><span class="toc-number">4.8.2.</span> <span class="toc-text">4.8.2 flex使用说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-3-flex各个属性介绍"><span class="toc-number">4.8.3.</span> <span class="toc-text">4.8.3 flex各个属性介绍</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9-cloud-music的flex布局案例"><span class="toc-number">4.9.</span> <span class="toc-text">4.9 cloud music的flex布局案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-1-导航栏颜色"><span class="toc-number">4.9.1.</span> <span class="toc-text">4.9.1 导航栏颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-2-首页结构划分"><span class="toc-number">4.9.2.</span> <span class="toc-text">4.9.2 首页结构划分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-3-首页标签栏"><span class="toc-number">4.9.3.</span> <span class="toc-text">4.9.3 首页标签栏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-4-播放栏"><span class="toc-number">4.9.4.</span> <span class="toc-text">4.9.4 播放栏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-5-内容栏"><span class="toc-number">4.9.5.</span> <span class="toc-text">4.9.5 内容栏</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-自定义组件"><span class="toc-number">5.</span> <span class="toc-text">5.自定义组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-自定义组件的基本步骤"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 自定义组件的基本步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-使用自定义组件"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 使用自定义组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-父子组件的通信"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 父子组件的通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-父传子"><span class="toc-number">5.3.1.</span> <span class="toc-text">5.3.1 父传子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-子传父"><span class="toc-number">5.3.2.</span> <span class="toc-text">5.3.2 子传父</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-组件的生命周期"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 组件的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-组件数据监听"><span class="toc-number">5.5.</span> <span class="toc-text">5.5 组件数据监听</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-常用第三方组件库"><span class="toc-number">5.6.</span> <span class="toc-text">5.6 常用第三方组件库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-1-组件库介绍"><span class="toc-number">5.6.1.</span> <span class="toc-text">5.6.1 组件库介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-2-iView基本使用"><span class="toc-number">5.6.2.</span> <span class="toc-text">5.6.2 iView基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-3-字体图标的使用"><span class="toc-number">5.6.3.</span> <span class="toc-text">5.6.3 字体图标的使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-小程序的页面跳转"><span class="toc-number">6.</span> <span class="toc-text">6.小程序的页面跳转</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-页面跳转传值"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 页面跳转传值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-1-使用url传参"><span class="toc-number">6.1.1.</span> <span class="toc-text">6.1.1 使用url传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-2-编程式导航传参"><span class="toc-number">6.1.2.</span> <span class="toc-text">6.1.2 编程式导航传参</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-导航模式"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 导航模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-页面数据共享"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 页面数据共享</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-1-使用全局变量"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1 使用全局变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-2-使用缓存"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2 使用缓存</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-生命周期"><span class="toc-number">7.</span> <span class="toc-text">7 生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-应用的生命周期"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 应用的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-页面的生命周期"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 页面的生命周期</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-微信小程序开放能力"><span class="toc-number">8.</span> <span class="toc-text">8.微信小程序开放能力</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-获取用户信息"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 获取用户信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-登陆"><span class="toc-number">8.2.</span> <span class="toc-text">8.2 登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-打开客服"><span class="toc-number">8.3.</span> <span class="toc-text">8.3 打开客服</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-转发"><span class="toc-number">8.4.</span> <span class="toc-text">8.4 转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-获取用户地址"><span class="toc-number">8.5.</span> <span class="toc-text">8.5 获取用户地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-1-基于回调的解决方案"><span class="toc-number">8.5.1.</span> <span class="toc-text">8.5.1 基于回调的解决方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-2-基于async-的解决放案"><span class="toc-number">8.5.2.</span> <span class="toc-text">8.5.2 基于async 的解决放案</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-本地生活项目"><span class="toc-number">9.</span> <span class="toc-text">9.本地生活项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-小程序外观、工具栏和公共样式"><span class="toc-number">9.1.</span> <span class="toc-text">9.1 小程序外观、工具栏和公共样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-首页布局"><span class="toc-number">9.2.</span> <span class="toc-text">9.2 首页布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-首页请求数据"><span class="toc-number">9.3.</span> <span class="toc-text">9.3 首页请求数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-1-wx-request基本使用"><span class="toc-number">9.3.1.</span> <span class="toc-text">9.3.1 wx.request基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-2-首页完成数据请求和绑定"><span class="toc-number">9.3.2.</span> <span class="toc-text">9.3.2 首页完成数据请求和绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-3-请求工具类的封装"><span class="toc-number">9.3.3.</span> <span class="toc-text">9.3.3 请求工具类的封装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-列表页面"><span class="toc-number">9.4.</span> <span class="toc-text">9.4 列表页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-1-首页跳转到列表页面"><span class="toc-number">9.4.1.</span> <span class="toc-text">9.4.1 首页跳转到列表页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-2-扩展组件的使用"><span class="toc-number">9.4.2.</span> <span class="toc-text">9.4.2 扩展组件的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-3-列表页面布局"><span class="toc-number">9.4.3.</span> <span class="toc-text">9.4.3 列表页面布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-4-列表页面导航栏标题"><span class="toc-number">9.4.4.</span> <span class="toc-text">9.4.4 列表页面导航栏标题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-5-列表页面数据获取显示"><span class="toc-number">9.4.5.</span> <span class="toc-text">9.4.5 列表页面数据获取显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-6-上拉加载实现"><span class="toc-number">9.4.6.</span> <span class="toc-text">9.4.6 上拉加载实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-5-使用微信小程序API实现加载动画"><span class="toc-number">9.4.7.</span> <span class="toc-text">9.4.5 使用微信小程序API实现加载动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-6-下拉刷新"><span class="toc-number">9.4.8.</span> <span class="toc-text">9.4.6 下拉刷新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-详情页"><span class="toc-number">9.5.</span> <span class="toc-text">9.5 详情页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-1-wxs的使用"><span class="toc-number">9.5.1.</span> <span class="toc-text">9.5.1 wxs的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-2-详情页实现"><span class="toc-number">9.5.2.</span> <span class="toc-text">9.5.2 详情页实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-消息页"><span class="toc-number">9.6.</span> <span class="toc-text">9.6 消息页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-个人页"><span class="toc-number">9.7.</span> <span class="toc-text">9.7 个人页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-8-小程序调试"><span class="toc-number">9.8.</span> <span class="toc-text">9.8 小程序调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-9-小程序发布"><span class="toc-number">9.9.</span> <span class="toc-text">9.9 小程序发布</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-微信公众号开发"><span class="toc-number">10.</span> <span class="toc-text">10.微信公众号开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-公众号分类"><span class="toc-number">10.1.</span> <span class="toc-text">10.1 公众号分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-公众号注册"><span class="toc-number">10.2.</span> <span class="toc-text">10.2 公众号注册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-微信公众号基本功能"><span class="toc-number">10.3.</span> <span class="toc-text">10.3 微信公众号基本功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-1-自动回复"><span class="toc-number">10.3.1.</span> <span class="toc-text">10.3.1 自动回复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-2-自定义菜单"><span class="toc-number">10.3.2.</span> <span class="toc-text">10.3.2 自定义菜单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-3-投票管理"><span class="toc-number">10.3.3.</span> <span class="toc-text">10.3.3 投票管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-4-页面模板使用"><span class="toc-number">10.3.4.</span> <span class="toc-text">10.3.4 页面模板使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-添加页面模板"><span class="toc-number">10.3.4.1.</span> <span class="toc-text">a) 添加页面模板</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-绑定页面模板"><span class="toc-number">10.3.4.2.</span> <span class="toc-text">b) 绑定页面模板</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-公众号后台开发"><span class="toc-number">10.3.5.</span> <span class="toc-text">10.4 公众号后台开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-1-后台接入"><span class="toc-number">10.3.5.1.</span> <span class="toc-text">10.4.1 后台接入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-2-回复消息"><span class="toc-number">10.3.5.2.</span> <span class="toc-text">10.4.2 回复消息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-3-重新开启自定义菜单"><span class="toc-number">10.3.5.3.</span> <span class="toc-text">10.4.3 重新开启自定义菜单</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2455514678,1879015385&amp;fm=26&amp;gp=0.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">小逸的博客</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">微信小程序</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-11-11 00:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-11-11</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-04-28 10:54:49"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-04-28</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="1-微信小程序"><a href="#1-微信小程序" class="headerlink" title="1.微信小程序"></a>1.微信小程序</h1><h2 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h2><p>微信小程序是一种不需要下载安装即可使用的应用，用户搜一搜或扫一扫即可打开应用。</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569371811187.png"  alt="1569371811187"></p>
<blockquote>
<p><strong>小程序与传统APP相比又有哪些优势？</strong></p>
</blockquote>
<p>1：小程序开发成本比APP低；</p>
<p>2：小程序获客成本远低于APP；</p>
<p>3：APP开发周期慢，制作成本高、而小程序符合快速创业的精神，降低创业门槛；</p>
<p>4：APP生态体系已饱和，App Store排名竞争激烈，而小程序属于新生事物，发展空间充满无限想象。</p>
<blockquote>
<p><strong>小程序会给我们带来怎样的市场机会？</strong></p>
</blockquote>
<p>小程序的横空出世将彻底改变微信大流量小电商的格局，近乎APP的用户体验，极低的开发和获客成本必然使原先依附于公众号、传统APP的企业和个人快速向小程序迁移，特别是 O2O 场景化应用、生活服务、工具类、社群社交类等领域的创业门槛将大大降低，一个全民创业的时代正在来临！</p>
<blockquote>
<p><strong>微信小程序如何推广？</strong></p>
</blockquote>
<p>微信搜索入口：发现–&gt;小程序–&gt;搜索小程序</p>
<blockquote>
<p><strong>小程序可以做什么</strong></p>
</blockquote>
 class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/weChatAppdemo.jpg" <img src="/">

<h2 id="1-2-小程序开发者账号注册"><a href="#1-2-小程序开发者账号注册" class="headerlink" title="1.2 小程序开发者账号注册"></a>1.2 小程序开发者账号注册</h2><p>微信公众平台：<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener">https://mp.weixin.qq.com/</a></p>
<p>小程序开发者账号注册：<a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1" target="_blank" rel="noopener">https://mp.weixin.qq.com/wxopen/waregister?action=step1</a></p>
<p>在线文档：<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/" target="_blank" rel="noopener">https://mp.weixin.qq.com/debug/wxadoc/dev/</a></p>
<p>微信开发工具：<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html" target="_blank" rel="noopener">https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html</a></p>
<p>微信小程序注册需要一个新的邮箱  (<a href="mailto:mazg1987@126.com">mazg1987@126.com</a>)</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576212410097.png"  alt="1576212410097"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576212494534.png"  alt="1576212494534"></p>
<h2 id="1-3-微信开发工具的使用"><a href="#1-3-微信开发工具的使用" class="headerlink" title="1.3 微信开发工具的使用"></a>1.3 微信开发工具的使用</h2><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569390295737.png"  alt="1569390295737"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569373062381.png"  alt="1569373062381"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569373346615.png"  alt="1569373346615"></p>
<blockquote>
<p>注意：</p>
<p>1.wechat_devtools.exe的开发体验并不好，所以我们可以用vscode进行编码，用wechat_devtools负责预览</p>
<p>2.我们可以在vscode中安装 –  小程序开发助手 插件来提升开发速度 。比如输入在vscode中输入 ‘wx-page’ 会快速生成页面。其他插件：</p>
<pre><code>微信小程序扩展  支持wx:if  wx:for语法

Minapp          格式化wxml文件代码</code></pre></blockquote>
<h2 id="1-4-微信小程序文件结构"><a href="#1-4-微信小程序文件结构" class="headerlink" title="1.4 微信小程序文件结构"></a>1.4 微信小程序文件结构</h2> class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/fileTree.png" <img src="/">

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569390828047.png"  alt="1569390828047"></p>
<h3 id="1-4-1-主体文件结构"><a href="#1-4-1-主体文件结构" class="headerlink" title="1.4.1 主体文件结构"></a>1.4.1 主体文件结构</h3><p>主体部分由三个文件组成，必须放在项目的根目录，如下：</p>
<table>
<thead>
<tr>
<th>文件</th>
<th>必填</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/app.html" target="_blank" rel="noopener">app.js</a></td>
<td>是</td>
<td>小程序逻辑</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html" target="_blank" rel="noopener">app.json</a></td>
<td>是</td>
<td>小程序公共设置( 严格的JSON语法，不能用单引号，不能写注释，否则编译报错 )</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxss.html" target="_blank" rel="noopener">app.wxss</a></td>
<td>否</td>
<td>小程序公共样式表( <strong>拓展了rpx尺寸单位，微信专属响应式像素</strong> )</td>
</tr>
</tbody></table>
<h3 id="1-4-2-页面文件结构"><a href="#1-4-2-页面文件结构" class="headerlink" title="1.4.2 页面文件结构"></a>1.4.2 页面文件结构</h3><p>页面由四个文件组成，分别是：</p>
<table>
<thead>
<tr>
<th>文件类型</th>
<th>必填</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/page.html" target="_blank" rel="noopener">js</a></td>
<td>是</td>
<td>页面逻辑 ( 微信小程序没有window和document对象 )</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/" target="_blank" rel="noopener">wxml</a></td>
<td>是</td>
<td>页面结构  ( XML语法，不是HTML语法 )</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxss.html" target="_blank" rel="noopener">wxss</a></td>
<td>否</td>
<td>页面样式表 ( <strong>拓展了rpx尺寸单位，微信专属响应式像素</strong> )</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#pagejson" target="_blank" rel="noopener">json</a></td>
<td>否</td>
<td>页面配置 ( 严格的JSON语法，不能用单引号，不能写注释，否则编译报错 )</td>
</tr>
</tbody></table>
<h3 id="1-4-3-其他文件"><a href="#1-4-3-其他文件" class="headerlink" title="1.4.3 其他文件"></a>1.4.3 其他文件</h3><p>project.config.json : 项目的配置文件</p>
<p>sitemap.json : 用来配置小程序及其页面是否允许被微信索引（上线的时候使用）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;rules&quot;:[&#123;</span><br><span class="line">    &quot;action&quot;: &quot;allow&quot;,</span><br><span class="line">    &quot;page&quot;: &quot;path&#x2F;to&#x2F;page&quot;</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    &quot;action&quot;: &quot;disallow&quot;,</span><br><span class="line">    &quot;page&quot;: &quot;*&quot;</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-5-微信小程序配置-app-json"><a href="#1-5-微信小程序配置-app-json" class="headerlink" title="1.5 微信小程序配置-app.json"></a>1.5 微信小程序配置-app.json</h2><h3 id="1-5-1-app-json-配置项列表"><a href="#1-5-1-app-json-配置项列表" class="headerlink" title="1.5.1 app.json 配置项列表"></a>1.5.1 app.json 配置项列表</h3><p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"pages"</span>: [</span><br><span class="line">    <span class="string">"pages/index/index"</span>,</span><br><span class="line">    <span class="string">"pages/logs/index"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"window"</span>: &#123;</span><br><span class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"Demo"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"tabBar"</span>: &#123;</span><br><span class="line">    <span class="string">"color"</span>: <span class="string">"#dddddd"</span>,</span><br><span class="line">    <span class="string">"selectedColor"</span>: <span class="string">"#3cc51f"</span>,</span><br><span class="line">    <span class="string">"borderStyle"</span>: <span class="string">"black"</span>,</span><br><span class="line">    <span class="string">"backgroundColor"</span>: <span class="string">"#ffffff"</span>,</span><br><span class="line">    <span class="string">"list"</span>: [&#123;</span><br><span class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/component/index"</span>,</span><br><span class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_component.png"</span>,</span><br><span class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_component_HL.png"</span>,</span><br><span class="line">      <span class="string">"text"</span>: <span class="string">"组件"</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/API/index/index"</span>,</span><br><span class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_API.png"</span>,</span><br><span class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_API_HL.png"</span>,</span><br><span class="line">      <span class="string">"text"</span>: <span class="string">"接口"</span></span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"networkTimeout"</span>: &#123;</span><br><span class="line">    <span class="string">"request"</span>: <span class="number">10000</span>,</span><br><span class="line">    <span class="string">"downloadFile"</span>: <span class="number">10000</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"debug"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"navigateToMiniProgramAppIdList"</span>: [</span><br><span class="line">    <span class="string">"wxe5f52902cf4de896"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果要新增页面可以直接在pages里面编辑</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>app.json</code>文件用来对微信小程序进行全局配置，决定页面文件的路径、窗口表现、设置网络超时时间、设置多 tab 等。</p>
</blockquote>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>必填</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#pages" target="_blank" rel="noopener">pages</a></td>
<td>String Array</td>
<td>是</td>
<td>设置页面路径</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#window" target="_blank" rel="noopener">window</a></td>
<td>Object</td>
<td>否</td>
<td>设置默认页面的窗口表现</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#tabbar" target="_blank" rel="noopener">tabBar</a></td>
<td>Object</td>
<td>否</td>
<td>设置底部 tab 的表现</td>
</tr>
<tr>
<td><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#debug" target="_blank" rel="noopener">debug</a></td>
<td>Boolean</td>
<td>否</td>
<td>设置是否开启 debug 模式</td>
</tr>
</tbody></table>
<h3 id="1-5-2-window配置"><a href="#1-5-2-window配置" class="headerlink" title="1.5.2 window配置"></a>1.5.2 window配置</h3><blockquote>
<p>用于设置小程序的状态栏、导航条、标题、窗口背景色。</p>
<p>注意：页面的<code>.json</code>只能设置 <code>window</code> 相关的配置项，以决定本页面的窗口表现，所以无需写 <code>window</code> 这个键。</p>
</blockquote>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>navigationBarBackgroundColor</td>
<td>HexColor</td>
<td>#000000</td>
<td>导航栏背景颜色，如”#000000”</td>
</tr>
<tr>
<td>navigationBarTextStyle</td>
<td>String</td>
<td>white</td>
<td>导航栏标题颜色，仅支持 black/white</td>
</tr>
<tr>
<td>navigationBarTitleText</td>
<td>String</td>
<td></td>
<td>导航栏标题文字内容</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>HexColor</td>
<td>#ffffff</td>
<td>窗口的背景色，可以通过开启 “enablePullDownRefresh”:true来查看窗口颜色</td>
</tr>
<tr>
<td>backgroundTextStyle</td>
<td>String</td>
<td>dark</td>
<td>下拉刷新的背景字体、loading 图的样式，仅支持 dark/light</td>
</tr>
<tr>
<td>enablePullDownRefresh</td>
<td>Boolean</td>
<td>false</td>
<td>是否开启下拉刷新，详见<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/page.html#页面相关事件处理函数" target="_blank" rel="noopener">页面相关事件处理函数</a>。</td>
</tr>
<tr>
<td>onReachBottomDistance</td>
<td>Number</td>
<td>50</td>
<td>页面上拉触底事件触发时距页面底部距离，单位为px</td>
</tr>
</tbody></table>
 class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/config.jpg" <img src="/">

<h3 id="1-5-3-tabBar"><a href="#1-5-3-tabBar" class="headerlink" title="1.5.3 tabBar"></a>1.5.3 tabBar</h3><p><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#tabbar" target="_blank" rel="noopener">https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html#tabbar</a></p>
<p>如果小程序是一个多 tab 应用（客户端窗口的底部或顶部有 tab 栏可以切换页面），可以通过 tabBar 配置项指定 tab 栏的表现，以及 tab 切换时显示的对应页面。</p>
<p><strong>Tip：</strong></p>
<ol>
<li>当设置 position 为 top 时，将不会显示 icon。</li>
<li>tabBar 中的 list 是一个数组，<strong>只能配置最少2个、最多5个 tab</strong>，tab 按数组的顺序排序。</li>
</ol>
<p><strong>属性说明：</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>color</td>
<td>HexColor</td>
<td>是</td>
<td></td>
<td>tab 上的文字默认颜色</td>
</tr>
<tr>
<td>selectedColor</td>
<td>HexColor</td>
<td>是</td>
<td></td>
<td>tab 上的文字选中时的颜色</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>HexColor</td>
<td>是</td>
<td></td>
<td>tab 的背景色</td>
</tr>
<tr>
<td>borderStyle</td>
<td>String</td>
<td>否</td>
<td>black</td>
<td>tabbar上边框的颜色， 仅支持 black/white</td>
</tr>
<tr>
<td>list</td>
<td>Array</td>
<td>是</td>
<td></td>
<td>tab 的列表，详见 list 属性说明，最少2个、最多5个 tab</td>
</tr>
<tr>
<td>position</td>
<td>String</td>
<td>否</td>
<td>bottom</td>
<td>可选值 bottom、top，设置成top是无图标</td>
</tr>
</tbody></table>
<p>其中 list 接受一个数组，数组中的每个项都是一个对象，其属性值如下：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>pagePath</td>
<td>String</td>
<td>是</td>
<td>页面路径，必须在 pages 中先定义</td>
</tr>
<tr>
<td>text</td>
<td>String</td>
<td>是</td>
<td>tab 上按钮文字</td>
</tr>
<tr>
<td>iconPath</td>
<td>String</td>
<td>否</td>
<td>图片路径，icon 大小限制为40kb，建议尺寸为 81px * 81px，当 postion 为 top 时，此参数无效</td>
</tr>
<tr>
<td>selectedIconPath</td>
<td>String</td>
<td>否</td>
<td>选中时的图片路径，icon 大小限制为40kb，建议尺寸为 81px * 81px ，当 postion 为 top 时，此参数无效</td>
</tr>
</tbody></table>
<p>图示：</p>
 class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/tabBar.png" <img src="/">



<h2 id="1-6-页面配置-index-index-json"><a href="#1-6-页面配置-index-index-json" class="headerlink" title="1.6 页面配置-index/index.json"></a>1.6 页面配置-index/index.json</h2><p>在页面配置中，可以修改全局配置的部分信息，用来指定当前页面的一些特有配置</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576219606646.png"  alt="1576219606646"></p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;usingComponents&quot;: &#123;&#125;,</span><br><span class="line">  &quot;navigationBarBackgroundColor&quot;: &quot;#00bbaa&quot;,</span><br><span class="line">  &quot;navigationBarTitleText&quot;: &quot;首页&quot;,</span><br><span class="line">  &quot;navigationBarTextStyle&quot;: &quot;white&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-7-微信小程序代码解析"><a href="#1-7-微信小程序代码解析" class="headerlink" title="1.7 微信小程序代码解析"></a>1.7 微信小程序代码解析</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.小程序不是运行在浏览器中，所以没有window和document对象</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">document</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.小程序js的一些额外成员</span></span><br><span class="line"><span class="comment">//App(&#123;&#125;)方法：用于创建应用程序实例，指定应用程序的生命周期</span></span><br><span class="line"><span class="comment">//Page()方法：用于创建页面对象</span></span><br><span class="line"><span class="comment">//getApp()方法：用于获取全局的应用程序对象</span></span><br><span class="line"><span class="comment">//getCurrentPages()方法：用于获取当前页面的调用栈 </span></span><br><span class="line">   # https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html</span><br><span class="line"><span class="comment">//wx : 微信小程序获取API的对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.小程序支持CommonJS规范</span></span><br><span class="line"><span class="comment">//exports.aa 或者module.exports导出</span></span><br><span class="line"><span class="comment">//require 引入</span></span><br></pre></td></tr></table></figure>

<h1 id="2-页面层数据、事件"><a href="#2-页面层数据、事件" class="headerlink" title="2.页面层数据、事件"></a>2.页面层数据、事件</h1><h2 id="2-1-页面层数据绑定"><a href="#2-1-页面层数据绑定" class="headerlink" title="2.1 页面层数据绑定"></a>2.1 页面层数据绑定</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">   data: &#123;</span><br><span class="line">    text: <span class="string">"This is page data."</span>,</span><br><span class="line">    classname:<span class="string">"hello"</span>,</span><br><span class="line">    name:<span class="string">"xiaoming"</span>,</span><br><span class="line">    id:<span class="number">1</span>,</span><br><span class="line">    flag:<span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;text&gt;&#123;&#123;text&#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">&lt;view class="&#123;&#123;classname&#125;&#125;"&gt;&lt;/</span>view&gt;</span><br><span class="line">&lt;view&gt;&#123;&#123;<span class="string">'abc'</span>&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;view&gt;&#123;&#123;111&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line">&lt;view&gt;&#123;&#123;<span class="number">111</span>*<span class="number">999</span>&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;view&gt;&#123;&#123;"hello" + name&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line">&lt;view&gt;&#123;&#123;flag?<span class="string">"真的"</span>:<span class="string">"假的"</span>&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;checkbox checked="&#123;&#123;false&#125;&#125;"&gt;  /</span><span class="regexp">/这边不能直接&lt;checkbox checked="false"&gt;，因为js中只要不是非空字符串，他的值都是true，我们可以通过mustache插值表达式解决该问题</span></span><br><span class="line"><span class="regexp">&lt;view id="item-&#123;&#123;id&#125;&#125;"&gt; &lt;/</span>view&gt;</span><br><span class="line">&lt;view hidden=<span class="string">"&#123;&#123;flag ? true : false&#125;&#125;"</span>&gt; Hidden &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.hello&#123;</span></span><br><span class="line"><span class="regexp">  width: 100px;</span></span><br><span class="line"><span class="regexp">  height: 100px;</span></span><br><span class="line"><span class="regexp">  background: red;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-wxs语法"><a href="#2-2-wxs语法" class="headerlink" title="2.2 wxs语法"></a>2.2 wxs语法</h2><p>WXS（WeiXin Script）是小程序的一套脚本语言，结合 <code>WXML</code>，可以构建出页面的结构。</p>
<p>WXS存在的意义就是充当compute/filter这类功能</p>
<p>WXS 与 JavaScript 是不同的语言，有自己的语法，并不和 JavaScript 一致。</p>
<p>WXS 代码可以编写在 wxml 文件中的 <code>&lt;wxs&gt;</code> 标签内，或以 <code>.wxs</code> 为后缀名的文件内。</p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--wxml--&gt;</span><br><span class="line">&lt;wxs <span class="built_in">module</span>=<span class="string">"m1"</span>&gt;</span><br><span class="line"><span class="keyword">var</span> msg = <span class="string">"hello world"</span>;</span><br><span class="line"><span class="built_in">module</span>.exports.message = msg;</span><br><span class="line">&lt;<span class="regexp">/wxs&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;view&gt; &#123;&#123;m1.message&#125;&#125; &lt;/</span>view&gt;</span><br></pre></td></tr></table></figure>

<h2 id="2-3-wxml语法"><a href="#2-3-wxml语法" class="headerlink" title="2.3 wxml语法"></a>2.3 wxml语法</h2><h3 id="2-3-1-列表渲染"><a href="#2-3-1-列表渲染" class="headerlink" title="2.3.1 列表渲染"></a>2.3.1 列表渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">    text: <span class="string">"This is page data."</span>,</span><br><span class="line">    classname:<span class="string">"hello"</span>,</span><br><span class="line">    todos:[</span><br><span class="line">      &#123;</span><br><span class="line">        name:<span class="string">"javascript"</span>,</span><br><span class="line">        completed:<span class="literal">false</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: <span class="string">"java"</span>,</span><br><span class="line">        completed: <span class="literal">false</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: <span class="string">"c#"</span>,</span><br><span class="line">        completed: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&lt;!--</span><br><span class="line">  wx:<span class="keyword">for</span>-item=<span class="string">"ele"</span>  给遍历的每一项取别名，默认名字是item</span><br><span class="line">  wx:<span class="keyword">for</span>-index=<span class="string">"idx"</span>  给遍历的每一项序号取别名，默认是index</span><br><span class="line">  --&gt;</span><br><span class="line">  &lt;view wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;todos&#125;&#125;"</span> wx:<span class="keyword">for</span>-item=<span class="string">"ele"</span> wx:<span class="keyword">for</span>-index=<span class="string">"idx"</span>&gt;</span><br><span class="line">     &lt;text&gt;&#123;&#123;idx&#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">     &lt;text&gt;&#123;&#123;ele.name&#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">     &lt;checkbox checked=<span class="string">"&#123;&#123;ele.completed&#125;&#125;"</span>&gt;&lt;<span class="regexp">/checkbox&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<h3 id="wx-key-提高列表渲染时排序的效率"><a href="#wx-key-提高列表渲染时排序的效率" class="headerlink" title="wx:key   提高列表渲染时排序的效率"></a>wx:key   提高列表渲染时排序的效率</h3></blockquote>
<p><code>wx:key</code> 的值以两种形式提供</p>
<ol>
<li><p>字符串，代表在 for 循环的 array 中 item 的某个 property，该 property 的值需要是列表中唯一的字符串或数字，且不能动态改变。</p>
</li>
<li><p>保留关键字 <code>*this</code> 代表在 for 循环中的 item 本身，这种表示需要 item 本身是一个唯一的字符串或者数字。比如数组[“a”,”b”,”c”]这样的数组就可以wx:key = “*this”</p>
</li>
</ol>
<h3 id="2-3-2-条件渲染"><a href="#2-3-2-条件渲染" class="headerlink" title="2.3.2 条件渲染"></a>2.3.2 条件渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--wxml--&gt;</span><br><span class="line">&lt;view wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;view == 'WEBVIEW'&#125;&#125;"</span>&gt; WEBVIEW &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;view wx:elif="&#123;&#123;view == 'APP'&#125;&#125;"&gt; APP &lt;/</span>view&gt;</span><br><span class="line">&lt;view wx:<span class="keyword">else</span>=<span class="string">"&#123;&#123;view == 'MINA'&#125;&#125;"</span>&gt; MINA &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ page.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    view: 'MINA'</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--条件渲染和<span class="keyword">for</span>循环结合使用--&gt;</span><br><span class="line">&lt;view wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;[1,2,3,4,5,6,7,8,9]&#125;&#125;"</span>  wx:<span class="keyword">for</span>-item=<span class="string">"i"</span> &gt;</span><br><span class="line">    &lt;view wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;[1,2,3,4,5,6,7,8,9]&#125;&#125;"</span>  wx:<span class="keyword">for</span>-item=<span class="string">"j"</span> &gt;</span><br><span class="line">      &lt;view wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;i&lt;=j&#125;&#125;"</span>&gt;</span><br><span class="line">         &#123;&#123;i&#125;&#125;*&#123;&#123;j&#125;&#125;=&#123;&#123;i*j&#125;&#125;</span><br><span class="line">      &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--block标签的使用--&gt;</span><br><span class="line">&lt;block wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;show&#125;&#125;"</span>&gt;</span><br><span class="line">   &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"content"</span>&gt;</span><br><span class="line">      &lt;text&gt;内容&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">   &lt;/</span>view&gt;</span><br><span class="line">   &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"content"</span>&gt;</span><br><span class="line">      &lt;text&gt;内容&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">   &lt;/</span>view&gt;</span><br><span class="line">&lt;<span class="regexp">/block&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/block区块标签，不会渲染到页面。当有多个view要切换显示隐藏的时候，可以把多个view嵌套到block标签中</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--hidden属性和wx:<span class="keyword">if</span>的区别--&gt;</span><br><span class="line"> &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"content"</span>   wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;show&#125;&#125;"</span>&gt;</span><br><span class="line">      &lt;text&gt;内容&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"> &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"content"</span>   hidden=<span class="string">"&#123;&#123;!show&#125;&#125;"</span>&gt;</span><br><span class="line">      &lt;text&gt;内容&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//wx:if 如果条件未false，则元素不会渲染到页面</span></span><br><span class="line"><span class="comment">//hidden: 如果条件为true，则元素会渲染到页面，只不过添加了display:none的属性让元素不显示</span></span><br><span class="line"><span class="comment">//频繁切换隐藏显示用hidden，不频繁切换用:if</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-模板语法"><a href="#2-3-3-模板语法" class="headerlink" title="2.3.3 模板语法"></a>2.3.3 模板语法</h3><p>WXML提供模板（template），可以在模板中定义代码片段，然后在不同的地方调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--声明一个名字叫staffName的模板 --&gt;</span><br><span class="line">&lt;template name=<span class="string">"staffName"</span>&gt;</span><br><span class="line">  &lt;view&gt;</span><br><span class="line">    FirstName: &#123;&#123;firstName&#125;&#125;, <span class="attr">LastName</span>: &#123;&#123;lastName&#125;&#125;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!--使用模板，并且向模板传递参数--&gt;</span><br><span class="line">&lt;template is=<span class="string">"staffName"</span> data=<span class="string">"&#123;&#123;...staffA&#125;&#125;"</span>&gt;&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;template is="staffName" data="&#123;&#123;...staffB&#125;&#125;"&gt;&lt;/</span>template&gt;</span><br><span class="line">&lt;template is=<span class="string">"staffName"</span> data=<span class="string">"&#123;&#123;...staffC&#125;&#125;"</span>&gt;&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ page.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    staffA: &#123;firstName: 'Hulk', lastName: 'Hu'&#125;,</span></span><br><span class="line"><span class="regexp">    staffB: &#123;firstName: 'Shang', lastName: 'You'&#125;,</span></span><br><span class="line"><span class="regexp">    staffC: &#123;firstName: 'Gideon', lastName: 'Lin'&#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-4-import-和-include"><a href="#2-3-4-import-和-include" class="headerlink" title="2.3.4 import 和 include"></a>2.3.4 import 和 include</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;import src&#x3D;&quot;a.wxml&quot;&#x2F;&gt;   作用可以引入目标文件中定义的template，然后在当前的wxml中使用template</span><br><span class="line"></span><br><span class="line">&lt;include src&#x3D;&quot;header.wxml&quot;&#x2F;&gt;  作用可以引入目标文件中除了template wxs之外的所有代码</span><br></pre></td></tr></table></figure>

<h2 id="2-4-尺寸单位和样式"><a href="#2-4-尺寸单位和样式" class="headerlink" title="2.4 尺寸单位和样式"></a>2.4 尺寸单位和样式</h2><p>   与 CSS 相比，WXSS 扩展的特性有：</p>
<ul>
<li>尺寸单位(rpx  rem)</li>
<li>样式导入</li>
</ul>
<h3 id="2-4-1-尺寸单位"><a href="#2-4-1-尺寸单位" class="headerlink" title="2.4.1 尺寸单位"></a>2.4.1 尺寸单位</h3><ul>
<li><p>rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。如在 iPhone6 上，屏幕宽度为375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px = 1物理像素。</p>
<blockquote>
<p>当设定了容器的width:750rpx之后，那么在所有的设备上宽度都是屏幕100%，微信小程序会自动帮我们做单位换算</p>
</blockquote>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569379659990.png"  alt="img"></p>
</li>
</ul>
<blockquote>
<pre><code>**建议：** 开发微信小程序时设计师可以用 iPhone6 作为视觉稿的标准</code></pre></blockquote>
<ul>
<li>vw和vh是css3中的新单位，是一种视窗单位，在小程序中也同样适用。</li>
</ul>
<blockquote>
<p>小程序中，窗口宽度固定为100vw，将窗口宽度平均分成100份，1份是1vw</p>
<p>小程序中，窗口高度固定为100vh ，将窗口高度平均分成100份，1份是1vh</p>
</blockquote>
<h3 id="2-4-2-样式导入"><a href="#2-4-2-样式导入" class="headerlink" title="2.4.2 样式导入"></a>2.4.2 样式导入</h3><p>使用<code>@import</code>语句可以导入外联样式表，<code>@import</code>后跟需要导入的外联样式表的相对路径，用<code>;</code>表示语句结束。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** common.wxss **/</span></span><br><span class="line">.small-p &#123;</span><br><span class="line">  padding:<span class="number">5</span>px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** app.wxss **/</span></span><br><span class="line">@<span class="keyword">import</span> <span class="string">"common.wxss"</span>;</span><br><span class="line">.middle-p &#123;</span><br><span class="line">  padding:<span class="number">15</span>px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-3-选择器"><a href="#2-4-3-选择器" class="headerlink" title="2.4.3 选择器"></a>2.4.3 选择器</h3><p>特别需要注意的是小程序 不支持通配符 * ，因此以下代码无效！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">    margin:0;</span><br><span class="line">    padding:0;   </span><br><span class="line">    box-sizing:border-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>目前支持的选择器有：</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576221022785.png"  alt="1576221022785"></p>
<p><strong>“~”选择器</strong></p>
<p><strong>“+”选择器</strong></p>
<p><strong>[attribute]</strong></p>
<h3 id="2-4-4-小程序中使用less"><a href="#2-4-4-小程序中使用less" class="headerlink" title="2.4.4 小程序中使用less"></a>2.4.4 小程序中使用less</h3><p>原声小程序不支持 less ，其他基于小程序的框架基本都支持，如 wepy ， mpvue ， taro 等。<br>但是仅仅因为一个less功能，而去引用框架，肯定是不可取的。因此可以使用以下方式来实现</p>
<ol>
<li>编辑器是 vscode</li>
<li>安装插件 easy less</li>
<li>在vs code的设置中加如下，配置</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;workbench.sideBar.location&quot;: &quot;left&quot;,</span><br><span class="line">    &quot;less.compile&quot;: &#123;        </span><br><span class="line">      &quot;outExt&quot;:&quot;.wxss&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>在要编写样式的地方新建 less 文件，如 index.less ,然后正常编辑即可。</li>
</ol>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576221707533.png"  alt="1576221707533"></p>
<h2 id="2-5-事件"><a href="#2-5-事件" class="headerlink" title="2.5 事件"></a>2.5 事件</h2><h3 id="2-5-1-事件绑定"><a href="#2-5-1-事件绑定" class="headerlink" title="2.5.1 事件绑定"></a>2.5.1 事件绑定</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!--</span><br><span class="line">  <span class="number">1.</span>绑定事件的时候不可以直接通过buttonTapHandle(<span class="number">123</span>)这种方式传参，</span><br><span class="line">  如果要传递参数，可以通过data-*的方式传参，可以在事件对象中的dataset中查看该参数</span><br><span class="line">  <span class="number">2.</span>事件处理函数中的<span class="keyword">this</span>并不是当前触发事件的对象，而是当前的页面对象--&gt;</span><br><span class="line">  &lt;button bindtap=<span class="string">"buttonTapHandle"</span> data-hi=<span class="string">"WeChat"</span> &gt;点我&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!--驼峰命名法--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;button bindtap="buttonTapHandle" data-hello-world="WeChat" &gt;点我&lt;/</span>button&gt;</span><br><span class="line">   </span><br><span class="line"> </span><br><span class="line">  buttonTapHandle:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"tap事件"</span>,e)</span><br><span class="line">  &#125;,</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line"><span class="comment">//普通事件函数中this是当前的页面对象</span></span><br><span class="line"><span class="comment">//箭头函数中的this是undefined，如果要在箭头函数中使用当前的页面对象，我们可以在onload方法中把this保持一份</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//事件对象e中的信息</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"type"</span>:<span class="string">"tap"</span>,  <span class="comment">//事件类型</span></span><br><span class="line">  <span class="string">"timeStamp"</span>:<span class="number">895</span>,  <span class="comment">//事件生成时的时间戳</span></span><br><span class="line">  <span class="comment">//触发事件的组件的一些属性值集合</span></span><br><span class="line">  <span class="string">"target"</span>: &#123;</span><br><span class="line">    <span class="string">"id"</span>: <span class="string">"tapTest"</span>,</span><br><span class="line">    <span class="string">"dataset"</span>:  &#123;</span><br><span class="line">      <span class="string">"hi"</span>:<span class="string">"WeChat"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//当前组件的一些属性值集合</span></span><br><span class="line">  <span class="string">"currentTarget"</span>:  &#123;</span><br><span class="line">    <span class="string">"id"</span>: <span class="string">"tapTest"</span>,</span><br><span class="line">    <span class="string">"dataset"</span>: &#123;</span><br><span class="line">      <span class="string">"hi"</span>:<span class="string">"WeChat"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//额外的信息</span></span><br><span class="line">  <span class="string">"detail"</span>: &#123;</span><br><span class="line">    <span class="string">"x"</span>:<span class="number">53</span>,</span><br><span class="line">    <span class="string">"y"</span>:<span class="number">14</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//当前停留在屏幕中的触摸点信息的数组</span></span><br><span class="line">  <span class="string">"touches"</span>:[&#123;</span><br><span class="line">    <span class="string">"identifier"</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="string">"pageX"</span>:<span class="number">53</span>,</span><br><span class="line">    <span class="string">"pageY"</span>:<span class="number">14</span>,</span><br><span class="line">    <span class="string">"clientX"</span>:<span class="number">53</span>,</span><br><span class="line">    <span class="string">"clientY"</span>:<span class="number">14</span></span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="comment">//当前变化的触摸点信息的数组</span></span><br><span class="line">  <span class="string">"changedTouches"</span>:[&#123;</span><br><span class="line">    <span class="string">"identifier"</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="string">"pageX"</span>:<span class="number">53</span>,</span><br><span class="line">    <span class="string">"pageY"</span>:<span class="number">14</span>,</span><br><span class="line">    <span class="string">"clientX"</span>:<span class="number">53</span>,</span><br><span class="line">    <span class="string">"clientY"</span>:<span class="number">14</span></span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：绑定事件时不能带参数 不能带括号 以下为错误写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input bindinput&#x3D;&quot;handleInput(100)&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="2-5-2-事件冒泡"><a href="#2-5-2-事件冒泡" class="headerlink" title="2.5.2 事件冒泡"></a>2.5.2 事件冒泡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> &lt;!--使用bindTap绑定事件，默认会有事件冒泡--&gt;</span><br><span class="line">&lt;view bindtap=<span class="string">"outerHandler"</span> style=<span class="string">"width:200px;height:200px;background-color:red"</span>&gt;</span><br><span class="line">  &lt;view bindtap=<span class="string">"innerHandler"</span> style=<span class="string">"width:100px;height:100px;background-color:blue"</span>&gt;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!--使用catchtap阻止事件冒泡--&gt;</span><br><span class="line">&lt;view catchtap=<span class="string">"outerHandler"</span> style=<span class="string">"width:200px;height:200px;background-color:red"</span>&gt;</span><br><span class="line">  &lt;view catchtap=<span class="string">"innerHandler"</span> style=<span class="string">"width:100px;height:100px;background-color:blue"</span>&gt;   &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"> innerHandler:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"innerHandler"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  outerHandler: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"outerHandler"</span>);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="2-5-3-单向数据流"><a href="#2-5-3-单向数据流" class="headerlink" title="2.5.3 单向数据流"></a>2.5.3 单向数据流</h3><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/Snipaste_2019-09-26_09-17-49.png"  alt="Snipaste_2019-09-26_09-17-49"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">  &lt;input value=<span class="string">"&#123;&#123;message&#125;&#125;"</span> bindinput=<span class="string">"inputHandle"</span>&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">  &lt;text&gt;&#123;&#123;message&#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">inputHandle:function(e)&#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/可以通过e.detail.value来获取input输入框的值</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/微信小程序采用单向数据流，input输入框的值改变之后不会触发数据源中数据的变化，如果要页面改掉之后同步更新数据，需要通过setData()方法手动触发</span></span><br><span class="line"><span class="regexp">    console.log(e.detail.value)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/注意：修改data数据的时候不能this.data.message=""，这样数据修改之后不会触发页面刷新</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/需要通过setData(&#123;&#125;) 方法来修改数据，会触发页面同步更新</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      message:e.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-6-获取页面元素"><a href="#2-6-获取页面元素" class="headerlink" title="2.6 获取页面元素"></a>2.6 获取页面元素</h2><p><a href="https://juejin.im/post/5be7df8ff265da61590b3169" target="_blank" rel="noopener">https://juejin.im/post/5be7df8ff265da61590b3169</a></p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/wx.createSelectorQuery.html" target="_blank" rel="noopener">节点信息查询 API</a> 可以用于获取节点属性、样式、在界面上的位置等信息。</p>
<p>最常见的用法是使用这个接口来查询某个节点的当前位置，以及界面的滚动位置。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建SelectorQuery查询对象</span></span><br><span class="line"><span class="keyword">let</span> query = wx.createSelectorQuery();</span><br><span class="line"><span class="comment">//选取一个节点</span></span><br><span class="line"><span class="keyword">var</span> firstDivider = query.select(<span class="string">".divider"</span>);</span><br><span class="line"><span class="comment">//选取所有节点</span></span><br><span class="line"><span class="keyword">var</span> dividers = query.selectAll(<span class="string">".divider"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取节点的相关属性</span></span><br><span class="line">dividers.fields(&#123;</span><br><span class="line">  id: <span class="literal">false</span>,<span class="comment">//是否返回节点id</span></span><br><span class="line">  rect: <span class="literal">true</span>,<span class="comment">//是否返回节点布局位置</span></span><br><span class="line">  dataset: <span class="literal">true</span>,<span class="comment">//返回数据集</span></span><br><span class="line">  size: <span class="literal">true</span>,<span class="comment">//返回宽高</span></span><br><span class="line">  scrollOffset: <span class="literal">true</span>,<span class="comment">//返回 scrollLeft,scrollTop</span></span><br><span class="line">  properties: [<span class="string">'scrollX'</span>, <span class="string">'scrollY'</span>],<span class="comment">//只能获得组件文档中标注的常规属性值，id class style 和事件绑定的属性值不可获取</span></span><br><span class="line">  computedStyle: [<span class="string">'margin'</span>, <span class="string">'backgroundColor'</span>]<span class="comment">//此处返回指定要返回的样式名</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res,<span class="string">"aaa"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加节点的布局位置的查询请求</span></span><br><span class="line">dividers.boundingClientRect(<span class="function"><span class="keyword">function</span> (<span class="params">rect</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(rect, <span class="string">"bbb"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加节点的滚动位置查询请求</span></span><br><span class="line"><span class="comment">//query.selectViewport():选择显示区域，用于获取显示区域的尺寸、滚动位置等信息</span></span><br><span class="line">query.selectViewport().scrollOffset(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res,<span class="string">"ccc"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//query.exec: 执行所有的请求</span></span><br><span class="line">query.exec(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//res中包含所有请求的执行结果</span></span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="2-7-动画"><a href="#2-7-动画" class="headerlink" title="2.7 动画"></a>2.7 动画</h2><h3 id="2-7-1-CSS动画"><a href="#2-7-1-CSS动画" class="headerlink" title="2.7.1 CSS动画"></a>2.7.1 CSS动画</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">""</span>view&gt;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.view &#123;</span></span><br><span class="line"><span class="regexp">  width: 200rpx;</span></span><br><span class="line"><span class="regexp">  height: 200rpx;</span></span><br><span class="line"><span class="regexp">  background-color: red;</span></span><br><span class="line"><span class="regexp">  margin-left: 100rpx;</span></span><br><span class="line"><span class="regexp">  margin-top: 100rpx;</span></span><br><span class="line"><span class="regexp">  /</span>** 第一种写法**<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  animation-name: viewlinear;</span></span><br><span class="line"><span class="regexp">  animation-duration: 2s;</span></span><br><span class="line"><span class="regexp">  animation-timing-function: linear;</span></span><br><span class="line"><span class="regexp">  animation-iteration-count: infinite;</span></span><br><span class="line"><span class="regexp">  /</span>** 第二种写法**<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  animation: viewlinear 2s linear infinite;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">@keyframes viewlinear &#123;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  /</span>** 第一种写法**<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  0% &#123;</span></span><br><span class="line"><span class="regexp">    background-color: red;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  50% &#123;</span></span><br><span class="line"><span class="regexp">    background-color: orange;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  100% &#123;</span></span><br><span class="line"><span class="regexp">    background-color: yellow;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-7-2-使用wx-createAnimation接口"><a href="#2-7-2-使用wx-createAnimation接口" class="headerlink" title="2.7.2 使用wx.createAnimation接口"></a>2.7.2 使用wx.createAnimation接口</h3><p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/animation/wx.createAnimation.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/ui/animation/wx.createAnimation.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;view  animation=<span class="string">"&#123;&#123;animationData&#125;&#125;"</span> style=<span class="string">"background:red;height:100rpx;width:100rpx"</span>&gt;sss&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;button bindtap="scaleWidthOpcityBg"&gt;缩放宽度透明度背景色&lt;/</span>button&gt;</span><br><span class="line">&lt;button bindtap=<span class="string">"rotateAndScale"</span>&gt;旋转和缩放同时进行&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button bindtap="rotateThenScale"&gt;先旋转再缩放&lt;/</span>button&gt;</span><br><span class="line">&lt;button bindtap=<span class="string">"rotateAndScaleThenTranslate"</span>&gt;先旋转再平移&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    animationData: &#123;&#125;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  scaleWidthOpcityBg: function () &#123;</span></span><br><span class="line"><span class="regexp">    var animation = wx.createAnimation(&#123;</span></span><br><span class="line"><span class="regexp">      duration: 1000,</span></span><br><span class="line"><span class="regexp">      timingFunction: "ease",</span></span><br><span class="line"><span class="regexp">      transformOrigin: "50% 50%",</span></span><br><span class="line"><span class="regexp">      delay: 0</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/step()动画分组</span></span><br><span class="line"><span class="regexp">    animation.scale(2, 2).width(100).opacity(0.5).backgroundColor("blue").rotate(45).step();</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      animationData: animation.export()</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  rotateAndScale: function () &#123;</span></span><br><span class="line"><span class="regexp">    var animation = wx.createAnimation(&#123;</span></span><br><span class="line"><span class="regexp">      duration: 1000,</span></span><br><span class="line"><span class="regexp">      timingFunction: "ease",</span></span><br><span class="line"><span class="regexp">      transformOrigin: "50% 50%",</span></span><br><span class="line"><span class="regexp">      delay: 0</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 旋转同时放大</span></span><br><span class="line"><span class="regexp">    animation.rotate(45).scale(2, 2).step()</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      animationData: animation.export()</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  rotateThenScale: function () &#123;</span></span><br><span class="line"><span class="regexp">    var animation = wx.createAnimation(&#123;</span></span><br><span class="line"><span class="regexp">      duration: 1000,</span></span><br><span class="line"><span class="regexp">      timingFunction: "ease",</span></span><br><span class="line"><span class="regexp">      transformOrigin: "50% 50%",</span></span><br><span class="line"><span class="regexp">      delay: 0</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 先旋转后放大</span></span><br><span class="line"><span class="regexp">    animation.rotate(45).step()</span></span><br><span class="line"><span class="regexp">    animation.scale(2, 2).step()</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      animationData: animation.export()</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  rotateAndScaleThenTranslate: function () &#123;</span></span><br><span class="line"><span class="regexp">    var animation = wx.createAnimation(&#123;</span></span><br><span class="line"><span class="regexp">      duration: 1000,</span></span><br><span class="line"><span class="regexp">      timingFunction: "ease",</span></span><br><span class="line"><span class="regexp">      transformOrigin: "50% 50%",</span></span><br><span class="line"><span class="regexp">      delay: 0</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 先旋转同时放大，然后平移</span></span><br><span class="line"><span class="regexp">    animation.rotate(45).scale(2, 2).step()</span></span><br><span class="line"><span class="regexp">    animation.translate(100, 100).step(&#123; duration: 1000 &#125;)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      animationData: animation.export()</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/注意点：微信小程序createAnimation动画结束后会保留动画结束的状态</span></span><br></pre></td></tr></table></figure>

<h1 id="3-登陆页面案例"><a href="#3-登陆页面案例" class="headerlink" title="3.登陆页面案例"></a>3.登陆页面案例</h1><h2 id="3-1-没有抽象事件处理函数"><a href="#3-1-没有抽象事件处理函数" class="headerlink" title="3.1 没有抽象事件处理函数"></a>3.1 没有抽象事件处理函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- version <span class="number">1</span> 没有抽象事件处理函数 --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"header"</span>&gt;</span><br><span class="line">    &lt;image src=<span class="string">"../../images/sign.png"</span> mode=<span class="string">"aspectFit"</span>/&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="inputs"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;input class="username" placeholder="请输入用户名" value="&#123;&#123; username &#125;&#125;" bindinput="usernameChangeHandle"/</span>&gt;</span><br><span class="line">    &lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"password"</span> type=<span class="string">"password"</span> placeholder=<span class="string">"请输入密码"</span> value=<span class="string">"&#123;&#123; password &#125;&#125;"</span> bindinput=<span class="string">"passwordChangeHandle"</span>/&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="buttons"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button type="primary" bindtap="loginHandle"&gt;登陆&lt;/</span>button&gt;</span><br><span class="line">    &lt;button type=<span class="string">"default"</span>&gt;注册&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">   data: &#123;</span></span><br><span class="line"><span class="regexp">     username: 'admin',</span></span><br><span class="line"><span class="regexp">     password: '123'</span></span><br><span class="line"><span class="regexp">   &#125;,</span></span><br><span class="line"><span class="regexp">   usernameChangeHandle: function (e) &#123;</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ this.data.username = e.detail.value 不要用这种方式，因为界面层无法得知</span></span><br><span class="line"><span class="regexp">     this.setData(&#123;</span></span><br><span class="line"><span class="regexp">       username: e.detail.value</span></span><br><span class="line"><span class="regexp">     &#125;)</span></span><br><span class="line"><span class="regexp">   &#125;,</span></span><br><span class="line"><span class="regexp">   passwordChangeHandle: function (e) &#123;</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ this.data.password = e.detail.value 不要用这种方式，因为界面层无法得知</span></span><br><span class="line"><span class="regexp">     this.setData(&#123;</span></span><br><span class="line"><span class="regexp">       password: e.detail.value</span></span><br><span class="line"><span class="regexp">     &#125;)</span></span><br><span class="line"><span class="regexp">   &#125;,</span></span><br><span class="line"><span class="regexp">   /</span><span class="regexp">/ 用于处理登录按钮点击的事件</span></span><br><span class="line"><span class="regexp">   loginHandle: function () &#123;</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ TODO: 完成逻辑</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ 1. 先需要知道用户输入了什么</span></span><br><span class="line"><span class="regexp">     console.log(this.data)</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ 2. 根据用户输入的值判断</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ 3. 根据判断的结果做出响应</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">page &#123;</span></span><br><span class="line"><span class="regexp">  height: 100%;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.container &#123;</span></span><br><span class="line"><span class="regexp">  display: flex;</span></span><br><span class="line"><span class="regexp">  flex-direction: column;</span></span><br><span class="line"><span class="regexp">  height: 100%;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.header &#123;</span></span><br><span class="line"><span class="regexp">  display: flex;</span></span><br><span class="line"><span class="regexp">  flex: 1;</span></span><br><span class="line"><span class="regexp">  justify-content: center;</span></span><br><span class="line"><span class="regexp">  align-items: center;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.header image &#123;</span></span><br><span class="line"><span class="regexp">  width: 200rpx;</span></span><br><span class="line"><span class="regexp">  height: 200rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.inputs &#123;</span></span><br><span class="line"><span class="regexp">  margin: 50rpx;</span></span><br><span class="line"><span class="regexp">  padding: 10rpx 10rpx;</span></span><br><span class="line"><span class="regexp">  border: 1rpx solid #e0e0e0;</span></span><br><span class="line"><span class="regexp">  border-radius: 10rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.inputs input &#123;</span></span><br><span class="line"><span class="regexp">  padding: 10rpx 15rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.inputs .username &#123;</span></span><br><span class="line"><span class="regexp">  border-bottom: 1rpx solid #e0e0e0;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.buttons &#123;</span></span><br><span class="line"><span class="regexp">  margin: 50rpx 50rpx 100rpx 50rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.buttons button &#123;</span></span><br><span class="line"><span class="regexp">  margin: 10rpx 0;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-抽象公共的事件处理函数"><a href="#3-2-抽象公共的事件处理函数" class="headerlink" title="3.2 抽象公共的事件处理函数"></a>3.2 抽象公共的事件处理函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"header"</span>&gt;</span><br><span class="line">    &lt;image src=<span class="string">"../../images/sign.png"</span> mode=<span class="string">"aspectFit"</span>/&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="inputs"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;input </span></span><br><span class="line"><span class="regexp">      class="username" </span></span><br><span class="line"><span class="regexp">      placeholder="请输入用户名" </span></span><br><span class="line"><span class="regexp">      value="&#123;&#123; username &#125;&#125;" </span></span><br><span class="line"><span class="regexp">      bindinput="inputChangeHandle" </span></span><br><span class="line"><span class="regexp">      data-prop="username"/</span>&gt;</span><br><span class="line">    &lt;input </span><br><span class="line">      <span class="class"><span class="keyword">class</span></span>=<span class="string">"password"</span> </span><br><span class="line">      type=<span class="string">"password"</span> </span><br><span class="line">      placeholder=<span class="string">"请输入密码"</span> </span><br><span class="line">      value=<span class="string">"&#123;&#123; password &#125;&#125;"</span> </span><br><span class="line">      bindinput=<span class="string">"inputChangeHandle"</span> </span><br><span class="line">      data-prop=<span class="string">"password"</span>/&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="buttons"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button type="primary" bindtap="loginHandle"&gt;登陆&lt;/</span>button&gt;</span><br><span class="line">    &lt;button type=<span class="string">"default"</span>&gt;注册&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"> Page(&#123;</span></span><br><span class="line"><span class="regexp">   data: &#123;</span></span><br><span class="line"><span class="regexp">     username: 'admin',</span></span><br><span class="line"><span class="regexp">     password: '123'</span></span><br><span class="line"><span class="regexp">   &#125;,</span></span><br><span class="line"><span class="regexp">   inputChangeHandle: function (e) &#123;</span></span><br><span class="line"><span class="regexp">     var prop = e.target.dataset['prop']</span></span><br><span class="line"><span class="regexp">     var changed = &#123;&#125;</span></span><br><span class="line"><span class="regexp">     changed[prop] = e.detail.value</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">     this.setData(changed)</span></span><br><span class="line"><span class="regexp">   &#125;,</span></span><br><span class="line"><span class="regexp">   /</span><span class="regexp">/ 用于处理登录按钮点击的事件</span></span><br><span class="line"><span class="regexp">   loginHandle: function () &#123;</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ TODO: 完成逻辑</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ 1. 先需要知道用户输入了什么</span></span><br><span class="line"><span class="regexp">     console.log(this.data)</span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ 2. 根据用户输入的值判断</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">     /</span><span class="regexp">/ 3. 根据判断的结果做出响应</span></span><br><span class="line"><span class="regexp">   &#125;</span></span><br><span class="line"><span class="regexp"> &#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="3-3-使用表单实现登陆"><a href="#3-3-使用表单实现登陆" class="headerlink" title="3.3 使用表单实现登陆"></a>3.3 使用表单实现登陆</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;form bindsubmit=<span class="string">"loginHandle"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"header"</span>&gt;</span><br><span class="line">      &lt;image src=<span class="string">"../../images/sign.png"</span> mode=<span class="string">"aspectFit"</span>/&gt;</span><br><span class="line">    &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="inputs"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;input </span></span><br><span class="line"><span class="regexp">        class="username" </span></span><br><span class="line"><span class="regexp">        name="username"</span></span><br><span class="line"><span class="regexp">        placeholder="请输入用户名" </span></span><br><span class="line"><span class="regexp">        value="&#123;&#123; username &#125;&#125;"/</span>&gt;</span><br><span class="line">      &lt;input </span><br><span class="line">        <span class="class"><span class="keyword">class</span></span>=<span class="string">"password"</span> </span><br><span class="line">        type=<span class="string">"password"</span> </span><br><span class="line">        name=<span class="string">"password"</span></span><br><span class="line">        placeholder=<span class="string">"请输入密码"</span> </span><br><span class="line">        value=<span class="string">"&#123;&#123; password &#125;&#125;"</span>/&gt;</span><br><span class="line">    &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="buttons"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button type="primary" form-type="submit"&gt;登陆&lt;/</span>button&gt;</span><br><span class="line">      &lt;button type=<span class="string">"default"</span>&gt;注册&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    username: <span class="string">'admin'</span>,</span><br><span class="line">    password: <span class="string">'123'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 用于处理表单提交事件</span></span><br><span class="line">  loginHandle: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="4-微信小程序组件"><a href="#4-微信小程序组件" class="headerlink" title="4.微信小程序组件"></a>4.微信小程序组件</h1><pre><code>在微信小程序中，不建议使用html标签，而需要使用微信小程序自己定义的组件。</code></pre><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1576744927308.png"  alt="1576744927308"></p>
<p>组件文档：<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/component/" target="_blank" rel="noopener">https://mp.weixin.qq.com/debug/wxadoc/dev/component/</a></p>
<p>组件的分类：视图容器、基础内容、表单组件、导航组件、媒体组件、地图组件、画布组件等</p>
<h2 id="4-1-基础内容组件"><a href="#4-1-基础内容组件" class="headerlink" title="4.1 基础内容组件"></a>4.1 基础内容组件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--index.wxml--&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;!-<span class="number">-1.</span>view标签：替换原来的div--&gt;</span><br><span class="line">    &lt;view hover-<span class="class"><span class="keyword">class</span></span>=<span class="string">"h-class"</span>&gt;点击我试试&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    </span></span><br><span class="line"><span class="regexp">  &lt;!--2.text类似于HTML中的p标签--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!--text主要是为了可以很好的控制页面上的内容--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!--text还支持换行--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;text&gt;这是一段</span></span><br><span class="line"><span class="regexp">    &lt;text&gt;文本&lt;/</span>text&gt;</span><br><span class="line">    内容</span><br><span class="line">  &lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">   </span></span><br><span class="line"><span class="regexp">  &lt;!--长按选中文字，可对空格回车进行编码--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;text selectable="&#123;&#123;false&#125;&#125;" decode="&#123;&#123;false&#125;&#125;"&gt;</span></span><br><span class="line"><span class="regexp">    普&amp;nbsp;通 </span></span><br><span class="line"><span class="regexp">  &lt;/</span>text&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!--success, success_no_circle, info, warn, waiting, cancel, download, search, clear--&gt;</span><br><span class="line">  &lt;!--type 用于定义图标类型，只能是规定范围的类型，除了这些内置图标，其他图标必须通过图片方式使用--&gt;</span><br><span class="line">  &lt;icon type=<span class="string">"success_no_circle"</span>&gt;&lt;<span class="regexp">/icon&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!-- size 用于指定图标大小 默认是23 单位是px --&gt;</span></span><br><span class="line"><span class="regexp">  &lt;icon type="info" size="60"&gt;&lt;/i</span>con&gt;</span><br><span class="line">  &lt;!-- color 用于指定图标颜色 取值就是CSS颜色取值 --&gt;</span><br><span class="line">  &lt;icon type=<span class="string">"info"</span> size=<span class="string">"60"</span> color=<span class="string">"red"</span>&gt;&lt;<span class="regexp">/icon&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!-- 显示一个进度条 --&gt;</span></span><br><span class="line"><span class="regexp">&lt;!-- show-info 是用来控制是否显示具体数值的的 --&gt;</span></span><br><span class="line"><span class="regexp">&lt;!--这边需要去掉container的align-items属性才能看到进度条--&gt;</span></span><br><span class="line"><span class="regexp">&lt;progress percent="20" show-info /</span>&gt;</span><br><span class="line">&lt;progress percent=<span class="string">"40"</span> stroke-width=<span class="string">"12"</span> /&gt;</span><br><span class="line">&lt;progress percent=<span class="string">"60"</span> color=<span class="string">"pink"</span> /&gt;</span><br><span class="line">&lt;!--active : 动画效果--&gt;</span><br><span class="line">&lt;progress percent=<span class="string">"80"</span> active /&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!--rich-text从<span class="number">1.4</span><span class="number">.0</span>开始可以使用，低版本需要兼容，类似于vue中的v-html --&gt;</span><br><span class="line">&lt;rich-text nodes=<span class="string">"&#123;&#123;nodes&#125;&#125;"</span>&gt;&lt;<span class="regexp">/rich-text&gt;</span></span><br><span class="line"><span class="regexp">&lt;rich-text nodes="&#123;&#123;nodes1&#125;&#125;"&gt;&lt;/</span>rich-text&gt;</span><br><span class="line">&lt;rich-text nodes=<span class="string">"&#123;&#123;nodes2&#125;&#125;"</span>&gt;&lt;<span class="regexp">/rich-text&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> data: &#123;</span><br><span class="line">    nodes: <span class="string">"&lt;h1 style='color:red;'&gt;html标题&lt;/h1&gt;"</span>,</span><br><span class="line">    nodes1: [&#123;</span><br><span class="line">      name: <span class="string">"h1"</span>,</span><br><span class="line">      attrs: &#123;</span><br><span class="line">        style: <span class="string">"color:red"</span>,</span><br><span class="line">        class: "red"</span><br><span class="line">      &#125;,</span><br><span class="line">      children: [&#123;</span><br><span class="line">        type: <span class="string">"text"</span>,</span><br><span class="line">        text: <span class="string">'结点列表标题'</span></span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;],</span><br><span class="line">    nodes2: [&#123;</span><br><span class="line">      name: <span class="string">"ul"</span>,</span><br><span class="line">      attrs: &#123;</span><br><span class="line">        style: <span class="string">"padding:20px;border:1px solid blue;"</span>,</span><br><span class="line">        class: "red"</span><br><span class="line">      &#125;,</span><br><span class="line">      children: [</span><br><span class="line">        &#123;</span><br><span class="line">          name: <span class="string">"li"</span>,</span><br><span class="line">          attrs: &#123;</span><br><span class="line">            style: <span class="string">"color:red"</span>,</span><br><span class="line">            class: "red"</span><br><span class="line">          &#125;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            type: <span class="string">"text"</span>,</span><br><span class="line">            text: <span class="string">'多层结点 无序列表'</span></span><br><span class="line">          &#125;],</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          name: <span class="string">"li"</span>,</span><br><span class="line">          attrs: &#123;</span><br><span class="line">            style: <span class="string">"color:red"</span>,</span><br><span class="line">            class: "red"</span><br><span class="line">          &#125;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            type: <span class="string">"text"</span>,</span><br><span class="line">            text: <span class="string">'多层结点 无序列表1'</span></span><br><span class="line">          &#125;],</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576225843384.png"  alt="1576225843384"></p>
<h2 id="4-2-表单组件"><a href="#4-2-表单组件" class="headerlink" title="4.2 表单组件"></a>4.2 表单组件</h2><h3 id="4-2-1-button组件"><a href="#4-2-1-button组件" class="headerlink" title="4.2.1 button组件"></a>4.2.1 button组件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--1.常用按钮--&gt;</span><br><span class="line">&lt;!-- type是用来控制按钮的类型 只有三种：primary default warn --&gt;</span><br><span class="line">&lt;button type&#x3D;&quot;warn&quot;&gt;这是一个按钮&lt;&#x2F;button&gt;</span><br><span class="line">&lt;button type&#x3D;&quot;warn&quot; size&#x3D;&quot;mini&quot; plain loading&gt;这是一个按钮 &lt;&#x2F;button&gt;</span><br><span class="line">&lt;!--hover 指的是按下， hover-class指的就是按下过后的作用Class--&gt;</span><br><span class="line">&lt;button hover-class&#x3D;&quot;btn-active&quot;&gt;hover class&lt;&#x2F;button&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576223405167.png"  alt="1576223405167"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//button的常用属性</span></span><br><span class="line">size： <span class="keyword">default</span>/mini</span><br><span class="line">type:  primary/<span class="keyword">default</span>/warn</span><br><span class="line">form-type:  submit/reset</span><br><span class="line"></span><br><span class="line">open-type:</span><br><span class="line"><span class="number">1.</span>contact:打开客服会话，如果用户在会话中点击消息卡⽚后返回⼩程序，可以从bindcontact 回调中获得具体信息，具体说明</span><br><span class="line"><span class="number">2.</span>share：触发用户转发，使用前建议先阅读使用指引</span><br><span class="line"><span class="number">3.</span>getPhoneNumber：获取用户机号，可以从bindgetphonenumber回调中获取到用户信息</span><br><span class="line"><span class="number">4.</span>getUserInfo：获取用户信息，可以从bindgetuserinfo回调中获取到用户信息</span><br><span class="line"><span class="number">5.</span>launchApp：打开APP，可以通过app-parameter属性设定向APP传的参数具体说明</span><br><span class="line"><span class="number">6.</span>openSetting：打开授权设置页</span><br><span class="line"><span class="number">7.</span>feedback：打开“意见反馈”，用户提交反馈内容并上传日志，开发者可以登录小程序管理后台后进入左侧菜单“客服反馈”页面获取到反馈内容</span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-常用表单组件"><a href="#4-2-2-常用表单组件" class="headerlink" title="4.2.2 常用表单组件"></a>4.2.2 常用表单组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-<span class="number">-1.</span>form表单，可以绑定提交事件和重置表单事件--&gt;</span><br><span class="line">&lt;form bindsubmit=<span class="string">"formSubmit"</span> bindreset=<span class="string">"formReset"</span>&gt;</span><br><span class="line">  &lt;!-<span class="number">-2.</span><span class="keyword">switch</span>--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section section_gap"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;<span class="keyword">switch</span>&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;switch name="switch" /</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &lt;!--3.slider--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="section section_gap"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="section__title"&gt;slider&lt;/</span>view&gt;</span><br><span class="line">    &lt;slider name=<span class="string">"slider"</span> show-value&gt;&lt;<span class="regexp">/slider&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-<span class="number">-4.</span>输入框--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;input&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">	&lt;!--</span></span><br><span class="line"><span class="regexp">	   微信小程序中的input的type值只有下面四种：</span></span><br><span class="line"><span class="regexp">        text	文本输入键盘	</span></span><br><span class="line"><span class="regexp">        number	数字输入键盘	</span></span><br><span class="line"><span class="regexp">        idcard	身份证输入键盘	</span></span><br><span class="line"><span class="regexp">        digit	带小数点的数字键盘</span></span><br><span class="line"><span class="regexp">     --&gt;</span></span><br><span class="line"><span class="regexp">    &lt;input name="input" placeholder="please input here" /</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &lt;!--5.radio--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="section section_gap"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="section__title"&gt;radio&lt;/</span>view&gt;</span><br><span class="line">    &lt;radio-group name=<span class="string">"radio-group"</span> bindchange=<span class="string">"radioChange"</span>&gt;</span><br><span class="line">      &lt;label&gt;</span><br><span class="line">        &lt;radio value=<span class="string">"radio1"</span> /&gt;radio1&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">      &lt;label&gt;</span></span><br><span class="line"><span class="regexp">        &lt;radio value="radio2" /</span>&gt;radio2&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>radio-group&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &lt;!--6.checkbox    checkbox-group可以绑定change事件--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="section section_gap"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="section__title"&gt;checkbox&lt;/</span>view&gt;</span><br><span class="line">    &lt;checkbox-group name=<span class="string">"checkbox"</span> bindchange=<span class="string">"checkboxChange"</span>&gt;</span><br><span class="line">      &lt;label&gt;</span><br><span class="line">        &lt;checkbox value=<span class="string">"checkbox1"</span> /&gt;checkbox1&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">      &lt;label&gt;</span></span><br><span class="line"><span class="regexp">        &lt;checkbox value="checkbox2" /</span>&gt;checkbox2&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>checkbox-group&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &lt;!--7.textarea--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="section"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;textarea bindblur="bindTextAreaBlur" auto-height placeholder="自动变高" /</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &lt;!--8.提交表单按钮--&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="btn-area"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button formType="submit"&gt;Submit&lt;/</span>button&gt;</span><br><span class="line">    &lt;button formType=<span class="string">"reset"</span>&gt;Reset&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/index.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;&#125;,</span></span><br><span class="line"><span class="regexp">  checkboxChange: function(e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('checkbox发生change事件，携带value值为：', e.detail.value)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  onLoad: function(options) &#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 页面创建时执行</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-3-picker"><a href="#4-2-3-picker" class="headerlink" title="4.2.3 picker"></a>4.2.3 picker</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">  &lt;!-<span class="number">-1.</span>普通选择器--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;普通选择器&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;picker bindchange="bindPickerChange" value="&#123;&#123;index&#125;&#125;" range="&#123;&#123;array&#125;&#125;"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;view class="picker"&gt;</span></span><br><span class="line"><span class="regexp">        当前选择：&#123;&#123;array[index]&#125;&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>view&gt;</span><br><span class="line">    &lt;<span class="regexp">/picker&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-<span class="number">-2.</span>多列选择器--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;多列选择器&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;picker mode="multiSelector" bindchange="bindMultiPickerChange" bindcolumnchange="bindMultiPickerColumnChange" value="&#123;&#123;multiIndex&#125;&#125;" range="&#123;&#123;multiArray&#125;&#125;"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;view class="picker"&gt;</span></span><br><span class="line"><span class="regexp">        当前选择：&#123;&#123;multiArray[0][multiIndex[0]]&#125;&#125;，&#123;&#123;multiArray[1][multiIndex[1]]&#125;&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>view&gt;</span><br><span class="line">    &lt;<span class="regexp">/picker&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;!-<span class="number">-3.</span>时间选择器--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;时间选择器&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;picker mode="time" value="&#123;&#123;time&#125;&#125;" start="09:01" end="21:01" bindchange="bindTimeChange"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;view class="picker"&gt;</span></span><br><span class="line"><span class="regexp">        当前选择: &#123;&#123;time&#125;&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>view&gt;</span><br><span class="line">    &lt;<span class="regexp">/picker&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-<span class="number">-4.</span>日期选择器--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;日期选择器&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;picker mode="date" value="&#123;&#123;date&#125;&#125;" start="2015-09-01" end="2017-09-01" bindchange="bindDateChange"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;view class="picker"&gt;</span></span><br><span class="line"><span class="regexp">        当前选择: &#123;&#123;date&#125;&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>view&gt;</span><br><span class="line">    &lt;<span class="regexp">/picker&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-<span class="number">-5.</span>省市区选择器--&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section__title"</span>&gt;省市区选择器&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!--mode 为region会自动切换数据--&gt;</span></span><br><span class="line"><span class="regexp">    &lt;picker mode="region" bindchange="bindRegionChange" value="&#123;&#123;region&#125;&#125;" custom-item="&#123;&#123;customItem&#125;&#125;"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;view class="picker"&gt;</span></span><br><span class="line"><span class="regexp">        当前选择：&#123;&#123;region[0]&#125;&#125;，&#123;&#123;region[1]&#125;&#125;，&#123;&#123;region[2]&#125;&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>view&gt;</span><br><span class="line">    &lt;<span class="regexp">/picker&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/index.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/普通选择器的数据源</span></span><br><span class="line"><span class="regexp">    array: ['美国', '中国', '巴西', '日本'],</span></span><br><span class="line"><span class="regexp">    index: 0,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/多列选择器的数据源</span></span><br><span class="line"><span class="regexp">    multiArray: [['无脊柱动物', '脊柱动物'], ['扁性动物', '线形动物', '环节动物', '软体动物', '节肢动物']],</span></span><br><span class="line"><span class="regexp">    multiIndex: [0, 0],</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/时间选择器数据源</span></span><br><span class="line"><span class="regexp">    time: '12:01',</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/日期选择器数据源</span></span><br><span class="line"><span class="regexp">    date: '2016-09-01',</span></span><br><span class="line"><span class="regexp">   </span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/日期选择器数据</span></span><br><span class="line"><span class="regexp">    region: ['广东省', '广州市', '海珠区'],</span></span><br><span class="line"><span class="regexp">    customItem: '全部'</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/普通选择器点击确认触发事件</span></span><br><span class="line"><span class="regexp">  bindPickerChange: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('picker发送选择改变，携带值为', e.detail.value)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      index: e.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/多列选择器点击确认触发事件</span></span><br><span class="line"><span class="regexp">  bindMultiPickerChange: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('picker发送选择改变，携带值为', e.detail.value)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      multiIndex: e.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/多列选择器某列发生改变触发事件</span></span><br><span class="line"><span class="regexp">  bindMultiPickerColumnChange: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('修改的列为', e.detail.column, '，值为', e.detail.value);</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/当选择的列发生改变之后会触发数据源发生变化(所以将原来的数据源复制一份)</span></span><br><span class="line"><span class="regexp">    var data = &#123;</span></span><br><span class="line"><span class="regexp">      multiArray: this.data.multiArray,</span></span><br><span class="line"><span class="regexp">      multiIndex: this.data.multiIndex</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/根据用户选择的列修改multiIndex</span></span><br><span class="line"><span class="regexp">    data.multiIndex[e.detail.column] = e.detail.value;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/判断当前选择的列是第几列</span></span><br><span class="line"><span class="regexp">    switch (e.detail.column) &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/如果用户选择的是第0列，则需要修改数据源multiArray中第1条数据</span></span><br><span class="line"><span class="regexp">      case 0:</span></span><br><span class="line"><span class="regexp">        switch (data.multiIndex[0]) &#123;</span></span><br><span class="line"><span class="regexp">          /</span><span class="regexp">/当用户选择了第0列的第0条数据</span></span><br><span class="line"><span class="regexp">          case 0:</span></span><br><span class="line"><span class="regexp">            data.multiArray[1] = ['扁性动物', '线形动物', '环节动物', '软体动物', '节肢动物'];</span></span><br><span class="line"><span class="regexp">            break;</span></span><br><span class="line"><span class="regexp">            /</span><span class="regexp">/当用户选择了第0列的第1条数据</span></span><br><span class="line"><span class="regexp">          case 1:</span></span><br><span class="line"><span class="regexp">            data.multiArray[1] = ['鱼', '两栖动物', '爬行动物'];</span></span><br><span class="line"><span class="regexp">            break;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/让multiIndex中的第1列和第2列默认选择第0条数据</span></span><br><span class="line"><span class="regexp">        data.multiIndex[1] = 0;</span></span><br><span class="line"><span class="regexp">        break;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/如果用户修改的是第1列，无需做其他什么</span></span><br><span class="line"><span class="regexp">      case 1:</span></span><br><span class="line"><span class="regexp">        break;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    console.log(data.multiIndex);</span></span><br><span class="line"><span class="regexp">    this.setData(data);</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"> /</span><span class="regexp">/日期选择器事件</span></span><br><span class="line"><span class="regexp">  bindDateChange: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('picker发送选择改变，携带值为', e.detail.value)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      date: e.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/时间选择器事件</span></span><br><span class="line"><span class="regexp">  bindTimeChange: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('picker发送选择改变，携带值为', e.detail.value)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      time: e.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/日期选择器</span></span><br><span class="line"><span class="regexp">  bindRegionChange: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('picker发送选择改变，携带值为', e.detail.value)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      region: e.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="4-3-交互组件"><a href="#4-3-交互组件" class="headerlink" title="4.3 交互组件"></a>4.3 交互组件</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showToast.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showToast.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">  &lt;button type=<span class="string">"primary"</span> bindtap=<span class="string">"btnToDo"</span>&gt;click me....&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  btnToDo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 当点击按钮触发</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1111</span>)</span><br><span class="line">   <span class="comment">// 交互操作组件 必须通过调用API方式使用</span></span><br><span class="line">    <span class="comment">// wx.showActionSheet(&#123;</span></span><br><span class="line">    <span class="comment">//   // 显示出来的项目列表</span></span><br><span class="line">    <span class="comment">//   itemList: ["新增","删除","修改"],</span></span><br><span class="line">    <span class="comment">//   // 点击其中任一项的回调</span></span><br><span class="line">    <span class="comment">//   success: function (res) &#123;</span></span><br><span class="line">    <span class="comment">//     // res.cancel 指的是是否点击了取消</span></span><br><span class="line">    <span class="comment">//     if (!res.cancel) &#123;</span></span><br><span class="line">    <span class="comment">//       // tapIndex指的是点击的下标</span></span><br><span class="line">    <span class="comment">//       console.log(res.tapIndex)</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// wx.showModal(&#123;</span></span><br><span class="line">    <span class="comment">//   title: '提示',</span></span><br><span class="line">    <span class="comment">//   content: '这是一个模态弹窗',</span></span><br><span class="line">    <span class="comment">//   success: function(res) &#123;</span></span><br><span class="line">    <span class="comment">//     if (res.confirm) &#123;</span></span><br><span class="line">    <span class="comment">//       console.log('用户点击确定')</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    wx.showToast(&#123;</span><br><span class="line">      title: <span class="string">'成功'</span>,</span><br><span class="line">      <span class="comment">// 只支持 success 和 loading</span></span><br><span class="line">      icon: <span class="string">'loading'</span>,</span><br><span class="line">      duration: <span class="number">2000</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="4-4-媒体组件"><a href="#4-4-媒体组件" class="headerlink" title="4.4 媒体组件"></a>4.4 媒体组件</h2><h3 id="4-4-1-image"><a href="#4-4-1-image" class="headerlink" title="4.4.1 image"></a>4.4.1 image</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;image src=<span class="string">"/assets/images/zcs65a.jpg"</span> lazy-load&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">/</span>*这边设置src路径的时候不需要使用相对路径，/本身代表项目根路径  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.container image&#123;</span></span><br><span class="line"><span class="regexp">  width: 750rpx;</span></span><br><span class="line"><span class="regexp">  /</span>*rpx单位：参照设计稿尺寸，如果设计稿以iphone6屏幕为基准</span><br><span class="line">     iphone6 屏幕大小是<span class="number">375</span>*<span class="number">667</span></span><br><span class="line"></span><br><span class="line">     图片大小是<span class="number">750</span>*<span class="number">1124</span>px，则可以设置图片宽高为</span><br><span class="line">     width:<span class="number">750</span>rpx;</span><br><span class="line">     height:<span class="number">1124</span>rpx;</span><br><span class="line"></span><br><span class="line">     iphone5  <span class="number">1</span>rpx = <span class="number">0.42</span>px</span><br><span class="line">     iphone6 <span class="number">1</span>rpx = <span class="number">0.5</span>px</span><br><span class="line">     iphone6plus <span class="number">1</span>rpx = <span class="number">0.552</span>px</span><br><span class="line"></span><br><span class="line">     实际开发中，只需要参照设计稿去设置rpx的值就可以，不需要再额外考虑屏幕的适配</span><br><span class="line">  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  height: 1124rpx;</span></span><br><span class="line"><span class="regexp">  /</span>* height: <span class="number">562</span>px; *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">注意：</span></span><br><span class="line"><span class="regexp">1.image组件默认宽度300px、高度225px，很多时候我们都不需要这个默认宽高，记得手动设置宽高</span></span><br><span class="line"><span class="regexp">2.微信小程序的图片是支持 lazy-load</span></span><br><span class="line"><span class="regexp">3.mode 有 13 种模式，其中 4 种是缩放模式，9种是裁剪模式。</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">aspectFit和widthFix区别：</span></span><br><span class="line"><span class="regexp">1.aspectFit：保持图片宽高比例，让长边完全显示出来，但是图片如果没有设置过宽高，还是原来默认的宽高</span></span><br><span class="line"><span class="regexp">2.widthFix：图片宽度填充，高度由图片宽高比自动计算。</span></span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576222641112.png"  alt="1576222641112"></p>
<h3 id="4-4-2-audio"><a href="#4-4-2-audio" class="headerlink" title="4.4.2 audio"></a>4.4.2 audio</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- audio.wxml --&gt;</span><br><span class="line">&lt;audio poster=<span class="string">"&#123;&#123;poster&#125;&#125;"</span> name=<span class="string">"&#123;&#123;name&#125;&#125;"</span> author=<span class="string">"&#123;&#123;author&#125;&#125;"</span> src=<span class="string">"&#123;&#123;src&#125;&#125;"</span> id=<span class="string">"myAudio"</span> controls loop&gt;&lt;<span class="regexp">/audio&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;button type="primary" bindtap="audioPlay"&gt;播放&lt;/</span>button&gt;</span><br><span class="line">&lt;button type=<span class="string">"primary"</span> bindtap=<span class="string">"audioPause"</span>&gt;暂停&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button type="primary" bindtap="audio14"&gt;设置当前播放时间为14秒&lt;/</span>button&gt;</span><br><span class="line">&lt;button type=<span class="string">"primary"</span> bindtap=<span class="string">"audioStart"</span>&gt;回到开头&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ audio.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  onReady: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 使用 wx.createAudioContext 获取 audio 上下文 context</span></span><br><span class="line"><span class="regexp">    this.audioCtx = wx.createAudioContext('myAudio')</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    poster: 'http:/</span><span class="regexp">/y.gtimg.cn/mu</span>sic/photo_new/T002R300x300M000003rsKF44GyaSk.jpg?max_age=<span class="number">2592000</span><span class="string">',</span></span><br><span class="line"><span class="string">    name: '</span>此时此刻<span class="string">',</span></span><br><span class="line"><span class="string">    author: '</span>许巍<span class="string">',</span></span><br><span class="line"><span class="string">    src: '</span>http:<span class="comment">//ws.stream.qqmusic.qq.com/M500001VfvsJ21xFqb.mp3?guid=ffffffff82def4af4b12b3cd9337d5e7&amp;uin=346897220&amp;vkey=6292F51E1E384E06DCBDC9AB7C49FD713D632D313AC4858BACB8DDD29067D3C601481D36E62053BF8DFEAF74C0A5CCFADD6471160CAF3E6A&amp;fromtag=46',</span></span><br><span class="line">  &#125;,</span><br><span class="line">  audioPlay: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.audioCtx.play()</span><br><span class="line">  &#125;,</span><br><span class="line">  audioPause: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.audioCtx.pause()</span><br><span class="line">  &#125;,</span><br><span class="line">  audio14: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.audioCtx.seek(<span class="number">14</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  audioStart: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.audioCtx.seek(<span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="4-4-3-camera"><a href="#4-4-3-camera" class="headerlink" title="4.4.3 camera"></a>4.4.3 camera</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- camera.wxml --&gt;</span><br><span class="line">&lt;camera device-position=<span class="string">"back"</span> flash=<span class="string">"off"</span> binderror=<span class="string">"error"</span> style=<span class="string">"width: 100%; height: 300px;"</span>&gt;&lt;<span class="regexp">/camera&gt;</span></span><br><span class="line"><span class="regexp">&lt;button type="primary" bindtap="takePhoto"&gt;拍照&lt;/</span>button&gt;</span><br><span class="line">&lt;view&gt;预览&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;image mode="widthFix" src="&#123;&#123;src&#125;&#125;"&gt;&lt;/im</span>age&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  takePhoto() &#123;</span><br><span class="line">    <span class="keyword">const</span> ctx = wx.createCameraContext()</span><br><span class="line">    ctx.takePhoto(&#123;</span><br><span class="line">      quality: <span class="string">'high'</span>,</span><br><span class="line">      success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          src: res.tempImagePath</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  error(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.detail)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="4-4-4-vedio组件"><a href="#4-4-4-vedio组件" class="headerlink" title="4.4.4 vedio组件"></a>4.4.4 vedio组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"section tc"</span>&gt;</span><br><span class="line">  &lt;video id=<span class="string">"myVideo"</span> src=<span class="string">"http://wxsnsdy.tc.qq.com/105/20210/snsdyvideodownload?filekey=30280201010421301f0201690402534804102ca905ce620b1241b726bc41dcff44e00204012882540400&amp;bizid=1023&amp;hy=SH&amp;fileparam=302c020101042530230204136ffd93020457e3c4ff02024ef202031e8d7f02030f42400204045a320a0201000400"</span> danmu-list=<span class="string">"&#123;&#123;danmuList&#125;&#125;"</span> enable-danmu danmu-btn controls&gt;&lt;<span class="regexp">/video&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  onReady: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.videoContext = wx.createVideoContext(<span class="string">'myVideo'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  inputValue: <span class="string">''</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    src: <span class="string">''</span>,</span><br><span class="line">    danmuList: [</span><br><span class="line">      &#123;</span><br><span class="line">        text: <span class="string">'第 1s 出现的弹幕'</span>,</span><br><span class="line">        color: <span class="string">'#ff0000'</span>,</span><br><span class="line">        time: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        text: <span class="string">'第 3s 出现的弹幕'</span>,</span><br><span class="line">        color: <span class="string">'#ff00ff'</span>,</span><br><span class="line">        time: <span class="number">3</span></span><br><span class="line">      &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="4-5-常用布局标签"><a href="#4-5-常用布局标签" class="headerlink" title="4.5 常用布局标签"></a>4.5 常用布局标签</h2><h3 id="4-5-1-scroll-view"><a href="#4-5-1-scroll-view" class="headerlink" title="4.5.1 scroll-view"></a>4.5.1 scroll-view</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--垂直滚动，这里必须设置高度--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span>=<span class="string">"&#123;&#123;true&#125;&#125;"</span> <span class="attr">style</span>=<span class="string">"height: 200px"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: red; width: 100px; height: 100px"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: green; width: 100px; height: 100px"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: blue; width: 100px; height: 100px"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: yellow; width: 100px; height: 100px"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--  white-space</span></span><br><span class="line"><span class="comment">  normal: 正常无变化(默认处理方式.文本自动处理换行.假如抵达容器边界内容会转到下一行)</span></span><br><span class="line"><span class="comment">  pre: 保持HTML源代码的空格与换行,等同与pre标签</span></span><br><span class="line"><span class="comment">  nowrap: 强制文本在一行,除非遇到br换行标签</span></span><br><span class="line"><span class="comment">  pre-wrap: 同pre属性,但是遇到超出容器范围的时候会自动换行</span></span><br><span class="line"><span class="comment">  pre-line: 同pre属性,但是遇到连续空格会被看作一个空格</span></span><br><span class="line"><span class="comment">  inherit: 继承</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--水平滚动--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-x</span>=<span class="string">"&#123;&#123;true&#125;&#125;"</span> <span class="attr">style</span>=<span class="string">" white-space: nowrap;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: red; width: 200px; height: 100px; display: inline-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: green; width: 200px; height: 100px; display: inline-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: blue; width: 200px; height: 100px; display: inline-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background: yellow; width: 200px; height: 100px; display: inline-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">注意点：scroll-y="&#123;&#123;true&#125;&#125;" 和scroll-y="true"的区别：</span><br><span class="line">scroll-y="&#123;&#123;true&#125;&#125;" 设置值为true</span><br><span class="line">scroll-y="true"      设置值为字符串"true"，结果仍然为true</span><br><span class="line">scroll-y="false"      设置值为字符串"false"，结果仍然为true</span><br></pre></td></tr></table></figure>

<h3 id="4-5-2-swiper"><a href="#4-5-2-swiper" class="headerlink" title="4.5.2 swiper"></a>4.5.2 swiper</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt;</span><br><span class="line">   &lt;!--circular:<span class="literal">true</span>  循环轮播</span><br><span class="line">       swiper组件会有一个默认高度是<span class="number">150</span>px</span><br><span class="line">       --&gt;</span><br><span class="line">  &lt;swiper indicator-dots=<span class="string">"&#123;&#123;indicatorDots&#125;&#125;"</span> autoplay=<span class="string">"&#123;&#123;autoplay&#125;&#125;"</span> interval=<span class="string">"&#123;&#123;interval&#125;&#125;"</span> duration=<span class="string">"&#123;&#123;duration&#125;&#125;"</span> circular=<span class="string">"&#123;&#123;true&#125;&#125;"</span>&gt;</span><br><span class="line">    &lt;block wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;imgUrls&#125;&#125;"</span>&gt;</span><br><span class="line">      &lt;swiper-item&gt;</span><br><span class="line">        &lt;!--widthFix:保持图片宽高比不变--&gt;</span><br><span class="line">        &lt;image src=<span class="string">"&#123;&#123;item&#125;&#125;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"slide-image"</span> mode=<span class="string">"widthFix"</span> /&gt;</span><br><span class="line">      &lt;<span class="regexp">/swiper-item&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>block&gt;</span><br><span class="line">  &lt;<span class="regexp">/swiper&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    imgUrls: [</span><br><span class="line">      <span class="string">'https://images.unsplash.com/photo-1551334787-21e6bd3ab135?w=640'</span>,</span><br><span class="line">      <span class="string">'https://images.unsplash.com/photo-1551214012-84f95e060dee?w=640'</span>,</span><br><span class="line">      <span class="string">'https://images.unsplash.com/photo-1551446591-142875a901a1?w=640'</span></span><br><span class="line">    ],</span><br><span class="line">    indicatorDots: <span class="literal">true</span>,</span><br><span class="line">    autoplay: <span class="literal">true</span>,</span><br><span class="line">    interval: <span class="number">5000</span>,</span><br><span class="line">    duration: <span class="number">1000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//图片宽高是：640*427</span></span><br><span class="line"><span class="comment">//swiper默认高度是150px，如果不该swiper的高度，那么当屏幕变大后，图片由于100%宽度会拉升，而高度拉升部分会被父亲swiper挡住。因此这边要修改swiper的高度</span></span><br><span class="line">.slide-image&#123;</span><br><span class="line">      width:<span class="number">100</span>%;</span><br><span class="line">&#125;</span><br><span class="line">swiper&#123;</span><br><span class="line">    width:<span class="number">750</span>rpx;</span><br><span class="line">    height:<span class="number">500</span>rpx;    <span class="comment">//  750*427/640</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576222939456.png"  alt="1576222939456"></p>
<h2 id="4-6-地图组件"><a href="#4-6-地图组件" class="headerlink" title="4.6 地图组件"></a>4.6 地图组件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">  &lt;map id=<span class="string">"map"</span> longitude=<span class="string">"&#123;&#123;longitude&#125;&#125;"</span> latitude=<span class="string">"&#123;&#123;latitude&#125;&#125;"</span> scale=<span class="string">"&#123;&#123;scale&#125;&#125;"</span> controls=<span class="string">"&#123;&#123;controls&#125;&#125;"</span> bindcontroltap=<span class="string">"controltap"</span> markers=<span class="string">"&#123;&#123;markers&#125;&#125;"</span> circles=<span class="string">"&#123;&#123;circles&#125;&#125;"</span> bindmarkertap=<span class="string">"markertap"</span> polyline=<span class="string">"&#123;&#123;polyline&#125;&#125;"</span> bindregionchange=<span class="string">"regionchange"</span> show-location style=<span class="string">"width: 100%; height: &#123;&#123;view.Height&#125;&#125;px;"</span>&gt;&lt;<span class="regexp">/map&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/app.json中添加定位权限</span></span><br><span class="line"><span class="regexp"> "permission": &#123;</span></span><br><span class="line"><span class="regexp">    "scope.userLocation": &#123;</span></span><br><span class="line"><span class="regexp">      "desc": "你的位置信息将用于小程序位置接口的效果展示"</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    Height: 0,</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/缩放比例</span></span><br><span class="line"><span class="regexp">    scale: 13,</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/经纬度</span></span><br><span class="line"><span class="regexp">    latitude: "",</span></span><br><span class="line"><span class="regexp">    longitude: "",</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/地图上的标记</span></span><br><span class="line"><span class="regexp">    markers: [],</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/地图上显示的控件</span></span><br><span class="line"><span class="regexp">    controls: [&#123;</span></span><br><span class="line"><span class="regexp">      id: 1,</span></span><br><span class="line"><span class="regexp">      iconPath: '../../assets/tabs/profile.png',</span></span><br><span class="line"><span class="regexp">      position: &#123;</span></span><br><span class="line"><span class="regexp">        left: 320,</span></span><br><span class="line"><span class="regexp">        top: 100 - 50,</span></span><br><span class="line"><span class="regexp">        width: 20,</span></span><br><span class="line"><span class="regexp">        height: 20</span></span><br><span class="line"><span class="regexp">      &#125;,</span></span><br><span class="line"><span class="regexp">      clickable: true</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    &#123;</span></span><br><span class="line"><span class="regexp">      id: 2,</span></span><br><span class="line"><span class="regexp">      iconPath: '/assets/tabs/message.png',</span></span><br><span class="line"><span class="regexp">      position: &#123;</span></span><br><span class="line"><span class="regexp">        left: 340,</span></span><br><span class="line"><span class="regexp">        top: 100 - 50,</span></span><br><span class="line"><span class="regexp">        width: 20,</span></span><br><span class="line"><span class="regexp">        height: 20</span></span><br><span class="line"><span class="regexp">      &#125;,</span></span><br><span class="line"><span class="regexp">      clickable: true</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    ],</span></span><br><span class="line"><span class="regexp">    circles: []</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  onLoad: function () &#123;</span></span><br><span class="line"><span class="regexp">    var _this = this;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    wx.getSystemInfo(&#123;</span></span><br><span class="line"><span class="regexp">      success: function (res) &#123;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/设置map高度，根据当前设备宽高满屏显示</span></span><br><span class="line"><span class="regexp">        _this.setData(&#123;</span></span><br><span class="line"><span class="regexp">          view: &#123;</span></span><br><span class="line"><span class="regexp">            Height: res.windowHeight</span></span><br><span class="line"><span class="regexp">          &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    wx.getLocation(&#123;</span></span><br><span class="line"><span class="regexp">      type: 'wgs84', /</span><span class="regexp">/ 默认为 wgs84 返回 gps 坐标，gcj02 返回可用于 wx.openLocation 的坐标</span></span><br><span class="line"><span class="regexp">                     /</span><span class="regexp">/WGS-84：GPS坐标系</span></span><br><span class="line"><span class="regexp">					 /</span><span class="regexp">/GCJ-02：火星坐标系，国测局02年发布的坐标体系，高德，腾讯等使用。</span></span><br><span class="line"><span class="regexp">					 /</span><span class="regexp">/BD-09：百度坐标系，百度自研，百度地图使用。</span></span><br><span class="line"><span class="regexp">      success: function (res) &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        _this.setData(&#123;</span></span><br><span class="line"><span class="regexp">          latitude: res.latitude,</span></span><br><span class="line"><span class="regexp">          longitude: res.longitude,</span></span><br><span class="line"><span class="regexp">          markers: [&#123;</span></span><br><span class="line"><span class="regexp">            id: "1",</span></span><br><span class="line"><span class="regexp">            latitude: res.latitude,</span></span><br><span class="line"><span class="regexp">            longitude: res.longitude,</span></span><br><span class="line"><span class="regexp">            width: 50,</span></span><br><span class="line"><span class="regexp">            height: 50,</span></span><br><span class="line"><span class="regexp">            iconPath: "/assets/tabs/home.png",</span></span><br><span class="line"><span class="regexp">            title: "哪里"</span></span><br><span class="line"><span class="regexp">          &#125;],</span></span><br><span class="line"><span class="regexp">          circles: [&#123;</span></span><br><span class="line"><span class="regexp">            latitude: res.latitude,</span></span><br><span class="line"><span class="regexp">            longitude: res.longitude,</span></span><br><span class="line"><span class="regexp">            color: '#FF0000DD',</span></span><br><span class="line"><span class="regexp">            fillColor: '#7cb5ec88',</span></span><br><span class="line"><span class="regexp">            radius: 3000,</span></span><br><span class="line"><span class="regexp">            strokeWidth: 1</span></span><br><span class="line"><span class="regexp">          &#125;]</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &#125;)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  regionchange(e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log("regionchange===" + e.type)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/点击merkers</span></span><br><span class="line"><span class="regexp">  markertap(e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log(e.markerId)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    wx.showActionSheet(&#123;</span></span><br><span class="line"><span class="regexp">      itemList: ["A"],</span></span><br><span class="line"><span class="regexp">      success: function (res) &#123;</span></span><br><span class="line"><span class="regexp">        console.log(res.tapIndex)</span></span><br><span class="line"><span class="regexp">      &#125;,</span></span><br><span class="line"><span class="regexp">      fail: function (res) &#123;</span></span><br><span class="line"><span class="regexp">        console.log(res.errMsg)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/点击缩放按钮动态请求数据</span></span><br><span class="line"><span class="regexp">  controltap(e) &#123;</span></span><br><span class="line"><span class="regexp">    var that = this;</span></span><br><span class="line"><span class="regexp">    console.log("scale===" + this.data.scale)</span></span><br><span class="line"><span class="regexp">    if (e.controlId === 1) &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ if (this.data.scale === 13) &#123;</span></span><br><span class="line"><span class="regexp">      that.setData(&#123;</span></span><br><span class="line"><span class="regexp">        scale: --this.data.scale</span></span><br><span class="line"><span class="regexp">      &#125;)</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ &#125;</span></span><br><span class="line"><span class="regexp">    &#125; else &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/  if (this.data.scale !== 13) &#123;</span></span><br><span class="line"><span class="regexp">      that.setData(&#123;</span></span><br><span class="line"><span class="regexp">        scale: ++this.data.scale</span></span><br><span class="line"><span class="regexp">      &#125;)</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="4-7-画布"><a href="#4-7-画布" class="headerlink" title="4.7 画布"></a>4.7 画布</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/canvas.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/ability/canvas.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- canvas.wxml --&gt;</span><br><span class="line">&lt;canvas style=<span class="string">"width: 300px; height: 200px;"</span> canvas-id=<span class="string">"firstCanvas"</span>&gt;&lt;<span class="regexp">/canvas&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  onReady: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 使用 wx.createContext 获取绘图上下文 context</span></span><br><span class="line"><span class="regexp">    var context = wx.createCanvasContext('firstCanvas')</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    context.setStrokeStyle("#00ff00")</span></span><br><span class="line"><span class="regexp">    context.setLineWidth(5)</span></span><br><span class="line"><span class="regexp">    context.rect(0, 0, 200, 200)</span></span><br><span class="line"><span class="regexp">    context.stroke()</span></span><br><span class="line"><span class="regexp">    context.setStrokeStyle("#ff0000")</span></span><br><span class="line"><span class="regexp">    context.setLineWidth(2)</span></span><br><span class="line"><span class="regexp">    context.moveTo(160, 100)</span></span><br><span class="line"><span class="regexp">    context.arc(100, 100, 60, 0, 2 * Math.PI, true)</span></span><br><span class="line"><span class="regexp">    context.moveTo(140, 100)</span></span><br><span class="line"><span class="regexp">    context.arc(100, 100, 40, 0, Math.PI, false)</span></span><br><span class="line"><span class="regexp">    context.moveTo(85, 80)</span></span><br><span class="line"><span class="regexp">    context.arc(80, 80, 5, 0, 2 * Math.PI, true)</span></span><br><span class="line"><span class="regexp">    context.moveTo(125, 80)</span></span><br><span class="line"><span class="regexp">    context.arc(120, 80, 5, 0, 2 * Math.PI, true)</span></span><br><span class="line"><span class="regexp">    context.stroke()</span></span><br><span class="line"><span class="regexp">    context.draw()</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="4-8-flex布局"><a href="#4-8-flex布局" class="headerlink" title="4.8 flex布局"></a>4.8 flex布局</h2><h3 id="4-8-1-flex简介"><a href="#4-8-1-flex简介" class="headerlink" title="4.8.1 flex简介"></a>4.8.1 flex简介</h3><p>在微信小程序中， <a href="https://developers.weixin.qq.com/miniprogram/dev/component/view.html" target="_blank" rel="noopener">view</a>是最基础的布局容器，其支持两种布局方式<code>block</code>、<code>flex</code>，默认情况下，<a href="https://developers.weixin.qq.com/miniprogram/dev/component/view.html" target="_blank" rel="noopener">view</a>的布局方式是<code>block</code>，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt;</span><br><span class="line">    &lt;view style&#x3D;&#39;background:red;&#39;&gt;1&lt;&#x2F;view&gt;</span><br><span class="line">    &lt;view style&#x3D;&#39;background:blue;&#39;&gt;2&lt;&#x2F;view&gt;</span><br><span class="line">    &lt;view style&#x3D;&#39;background:yellow;&#39;&gt;3&lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569552921995.png"  alt="1569552921995"></p>
<pre><code>微信小程序经常使用flex布局。

以前在网页开发过程中，布局一直是不可或缺的，从最早的表格布局，到后来的DIV+CSS布局，现在再到CSS3的伸缩布局。

CSS3在布局方面做了非常大的改进，使得我们对块级元素的布局排列变得十分灵活，适应性非常强，其强大的伸缩性，在响应式开中可以发挥极大的作用。</code></pre><blockquote>
<p>参考链接：<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex</a></p>
</blockquote>
<p><strong>主轴：</strong>Flex容器的主轴主要用来配置Flex项目，默认是水平方向</p>
<p><strong>侧轴：</strong>与主轴垂直的轴称作侧轴，默认是垂直方向的</p>
<p><strong>方向：</strong>默认主轴从左向右，侧轴默认从上到下</p>
<p><em>主轴和侧轴并不是固定不变的，通过flex-direction可以互换。</em>          </p>
<h3 id="4-8-2-flex使用说明"><a href="#4-8-2-flex使用说明" class="headerlink" title="4.8.2 flex使用说明"></a>4.8.2 flex使用说明</h3><ol>
<li>指定一个父盒子为伸缩盒子，即指定：<code>display: flex</code></li>
<li>明确你需要的主侧轴方向，并设置<code>flex-direction</code> 默认是row ，纵向是column</li>
<li>设置父盒子的属性来调整子元素的布局，例如<code>align-items</code></li>
<li>设置子盒子的宽高或者比例，完成具体的子元素在父盒子中的布局</li>
</ol>
<h3 id="4-8-3-flex各个属性介绍"><a href="#4-8-3-flex各个属性介绍" class="headerlink" title="4.8.3 flex各个属性介绍"></a>4.8.3 flex各个属性介绍</h3><ol>
<li><p><code>flex-direction</code>调整主轴方向（默认为水平方向）</p>
</li>
<li><p><code>justify-content</code>调整主轴对齐</p>
</li>
<li><p><code>align-items</code>调整侧轴对齐（子元素可以使用<code>align-self</code>覆盖）</p>
</li>
<li><p><code>flex-wrap</code>控制是否换行</p>
</li>
<li><p><code>align-content</code>堆栈（由flex-wrap产生的独立行）对齐</p>
</li>
<li><p><code>flex-flow</code>是<code>flex-direction</code> + <code>flex-wrap</code>的简写形式</p>
</li>
<li><p><code>flex</code>是子项目在主轴的缩放比例，不指定flex属性，则不参与伸缩分配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">flex 是 flex-grow、flex-shrink、flex-basis的缩写。</span><br><span class="line">该属性有两个快捷值：auto (1 1 auto) 和 none (0 0 auto)</span><br><span class="line"></span><br><span class="line">.item &#123;flex: 2;&#125;</span><br><span class="line">&#x2F;*等效于*&#x2F;</span><br><span class="line">.item &#123;</span><br><span class="line">    flex-grow: 2;</span><br><span class="line">    flex-shrink: 1;</span><br><span class="line">    flex-basis: 0%;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">flex-basis属性作用：用于设置子元素的宽度，如果写了这个属性会替换掉width属性值。</span><br><span class="line"></span><br><span class="line">flex-basis:0&#x2F;0%;   设置子元素的宽度为0px(不占用宽度，此时flex-grow会生效)</span><br><span class="line">flex-basis:auto;   在确定子元素宽度的时候首先会去参考子元素的width属性值，在没有设置width属性的宽度的情况下会参照元素的content的宽度</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>order</code>控制子项目的排列顺序，正序方式排序，从小到大</p>
</li>
</ol>
<p><em>此知识点重在理解，要明确找出主轴、侧轴、方向，各属性对应的属性值可参考示例源码。</em></p>
<h2 id="4-9-cloud-music的flex布局案例"><a href="#4-9-cloud-music的flex布局案例" class="headerlink" title="4.9 cloud music的flex布局案例"></a>4.9 cloud music的flex布局案例</h2><h3 id="4-9-1-导航栏颜色"><a href="#4-9-1-导航栏颜色" class="headerlink" title="4.9.1 导航栏颜色"></a>4.9.1 导航栏颜色</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pages/index/index.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"Music Player"</span>,</span><br><span class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#333"</span>,</span><br><span class="line">    <span class="string">"navigationBarTextStyle"</span>: <span class="string">"white"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-9-2-首页结构划分"><a href="#4-9-2-首页结构划分" class="headerlink" title="4.9.2 首页结构划分"></a>4.9.2 首页结构划分</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"root"</span>&gt;</span><br><span class="line">  &lt;!-- 标签栏的页签 固定高度 --&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"tabs"</span>&gt;</span><br><span class="line">   </span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!-- 内容区域 自适应高度 --&gt;</span></span><br><span class="line"><span class="regexp">  &lt;scroll-view class="content" scroll-y&gt;</span></span><br><span class="line"><span class="regexp">   </span></span><br><span class="line"><span class="regexp">  &lt;/</span>scroll-view&gt;</span><br><span class="line">  &lt;!-- 播放控制条 固定高度 --&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"player"</span>&gt;</span><br><span class="line">   </span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">page &#123;</span><br><span class="line">  height: <span class="number">100</span>%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.root &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  height: <span class="number">100</span>%;</span><br><span class="line">  background-color: #f0f0f0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.tabs&#123;</span><br><span class="line">  height: <span class="number">100</span>rpx;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content&#123;</span><br><span class="line">  flex: <span class="number">1</span>;</span><br><span class="line">  background-color: yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.player&#123;</span><br><span class="line">  height: <span class="number">100</span>rpx;</span><br><span class="line">  background-color: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-9-3-首页标签栏"><a href="#4-9-3-首页标签栏" class="headerlink" title="4.9.3 首页标签栏"></a>4.9.3 首页标签栏</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!-- 标签栏的页签 固定高度 --&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"tabs"</span>&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item active"</span>&gt;</span><br><span class="line">      &lt;text&gt;个性推荐&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">      &lt;text&gt;歌单&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">      &lt;text&gt;主播电台&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">      &lt;text&gt;排行榜&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">.tabs&#123;</span></span><br><span class="line"><span class="regexp">  /</span>* height: <span class="number">100</span>rpx; *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  background-color: red;</span></span><br><span class="line"><span class="regexp">  display: flex;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.tabs .item &#123;</span></span><br><span class="line"><span class="regexp">  flex: 1;</span></span><br><span class="line"><span class="regexp">  text-align: center;</span></span><br><span class="line"><span class="regexp">  font-size: 12px;</span></span><br><span class="line"><span class="regexp">  background-color: #222;</span></span><br><span class="line"><span class="regexp">  color: #ccc;</span></span><br><span class="line"><span class="regexp">  padding: 8px 0;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.tabs .item.active &#123;</span></span><br><span class="line"><span class="regexp">  color: #fff;</span></span><br><span class="line"><span class="regexp">  border-bottom: 2px solid #e9232c;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-9-4-播放栏"><a href="#4-9-4-播放栏" class="headerlink" title="4.9.4 播放栏"></a>4.9.4 播放栏</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!-- 播放控制条条 固定高度 --&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"player"</span>&gt;</span><br><span class="line">   &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"poster"</span>&gt;</span><br><span class="line">      &lt;image src=<span class="string">"../../images/poster.jpg"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"info"</span>&gt;</span><br><span class="line">      &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"title"</span>&gt;一生中最爱&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;text class="artist"&gt;谭咏麟&lt;/</span>text&gt;</span><br><span class="line">    &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="controls"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;image src="../</span>../images/<span class="number">01.</span>png<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">      &lt;image src="</span>../../images/<span class="number">02.</span>png<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">      &lt;image src="</span>../../images/<span class="number">03.</span>png<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">    &lt;/view&gt;</span></span><br><span class="line"><span class="string">  &lt;/view&gt;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">/*player样式*/</span></span><br><span class="line"><span class="string">.player&#123;</span></span><br><span class="line"><span class="string">  height: 100rpx;</span></span><br><span class="line"><span class="string">  background-color:#17181A;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.poster image &#123;</span></span><br><span class="line"><span class="string">  width: 40px;</span></span><br><span class="line"><span class="string">  height: 40px;</span></span><br><span class="line"><span class="string">  margin: 5px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.info &#123;</span></span><br><span class="line"><span class="string">  flex: 1;</span></span><br><span class="line"><span class="string">  color: #888;</span></span><br><span class="line"><span class="string">  font-size: 14px;</span></span><br><span class="line"><span class="string">  margin: 5px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.info .title&#123;</span></span><br><span class="line"><span class="string">  display: block;</span></span><br><span class="line"><span class="string">  font-size: 16px;</span></span><br><span class="line"><span class="string">  color: #ccc;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.controls image &#123;</span></span><br><span class="line"><span class="string">  width: 40px;</span></span><br><span class="line"><span class="string">  height: 40px;</span></span><br><span class="line"><span class="string">  margin: 5px 2px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-9-5-内容栏"><a href="#4-9-5-内容栏" class="headerlink" title="4.9.5 内容栏"></a>4.9.5 内容栏</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!-- 内容区域 自适应高度 --&gt;</span><br><span class="line">  &lt;scroll-view <span class="class"><span class="keyword">class</span></span>=<span class="string">"content"</span> scroll-y&gt;</span><br><span class="line">     &lt;!-<span class="number">-1.</span>图片轮播--&gt;</span><br><span class="line">    &lt;swiper <span class="class"><span class="keyword">class</span></span>=<span class="string">"slide"</span> autoplay indicator-dots&gt;</span><br><span class="line">      &lt;swiper-item&gt;</span><br><span class="line">        &lt;image src=<span class="string">"../../images/slide.png"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>swiper-item&gt;</span><br><span class="line">      &lt;swiper-item&gt;</span><br><span class="line">        &lt;image src=<span class="string">"../../images/slide.png"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>swiper-item&gt;</span><br><span class="line">      &lt;swiper-item&gt;</span><br><span class="line">        &lt;image src=<span class="string">"../../images/slide.png"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>swiper-item&gt;</span><br><span class="line">    &lt;<span class="regexp">/swiper&gt;</span></span><br><span class="line"><span class="regexp">      &lt;!--2.模块入口--&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="portals"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;view class="item"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;image src="../</span>../images/<span class="number">04.</span>png<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;私人FM&lt;/text&gt;</span></span><br><span class="line"><span class="string">      &lt;/view&gt;</span></span><br><span class="line"><span class="string">      &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src="</span>../../images/<span class="number">05.</span>png<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;每日歌曲推荐&lt;/text&gt;</span></span><br><span class="line"><span class="string">      &lt;/view&gt;</span></span><br><span class="line"><span class="string">      &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src="</span>../../images/<span class="number">06.</span>png<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;云音乐新歌榜&lt;/text&gt;</span></span><br><span class="line"><span class="string">      &lt;/view&gt;</span></span><br><span class="line"><span class="string">    &lt;/view&gt;</span></span><br><span class="line"><span class="string">    &lt;!--3.推荐歌单--&gt;</span></span><br><span class="line"><span class="string">    &lt;view class="</span>list<span class="string">"&gt;</span></span><br><span class="line"><span class="string">      &lt;view class="</span>title<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;推荐歌单&lt;/text&gt;</span></span><br><span class="line"><span class="string">      &lt;/view&gt;</span></span><br><span class="line"><span class="string">      &lt;view class="</span>inner<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">          &lt;image src="</span>../../images/poster.jpg<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">          &lt;text&gt;一生中最爱的是谁谁？&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;/view&gt;</span></span><br><span class="line"><span class="string">        &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">          &lt;image src="</span>../../images/poster.jpg<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">          &lt;text&gt;一生中最爱的是谁谁？&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;/view&gt;</span></span><br><span class="line"><span class="string">        &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">          &lt;image src="</span>../../images/poster.jpg<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">          &lt;text&gt;一生中最爱的是谁谁？&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;/view&gt;</span></span><br><span class="line"><span class="string">        &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">          &lt;image src="</span>../../images/poster.jpg<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">          &lt;text&gt;一生中最爱的是谁谁？&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;/view&gt;</span></span><br><span class="line"><span class="string">        &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">          &lt;image src="</span>../../images/poster.jpg<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">          &lt;text&gt;一生中最爱的是谁谁？&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;/view&gt;</span></span><br><span class="line"><span class="string">        &lt;view class="</span>item<span class="string">"&gt;</span></span><br><span class="line"><span class="string">          &lt;image src="</span>../../images/poster.jpg<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">          &lt;text&gt;一生中最爱的是谁谁？&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;/view&gt;</span></span><br><span class="line"><span class="string">      &lt;/view&gt;</span></span><br><span class="line"><span class="string">    &lt;/view&gt;</span></span><br><span class="line"><span class="string">  &lt;/scroll-view&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.content&#123;</span></span><br><span class="line"><span class="string">  flex: 1;</span></span><br><span class="line"><span class="string">  background-color: yellow;</span></span><br><span class="line"><span class="string">  overflow: hidden;  /*超出范围隐藏*/</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.slide image &#123;</span></span><br><span class="line"><span class="string">  width: 100%;</span></span><br><span class="line"><span class="string">  height: 260rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*portals 开启flex布局*/</span></span><br><span class="line"><span class="string">.portals &#123;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  margin-bottom: 30rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.portals .item &#123;</span></span><br><span class="line"><span class="string">  flex: 1;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.portals .item image &#123;</span></span><br><span class="line"><span class="string">  width: 120rpx;</span></span><br><span class="line"><span class="string">  height: 120rpx;</span></span><br><span class="line"><span class="string">  /*图片改成块级元素后可以设置margin:0 auto设置居中*/</span></span><br><span class="line"><span class="string">  display: block;</span></span><br><span class="line"><span class="string">  margin: 20rpx auto;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.portals .item text &#123;</span></span><br><span class="line"><span class="string">  display: block;  /*text默认是行内元素，把他转换成块级元素再设置居中就可以*/</span></span><br><span class="line"><span class="string">  font-size: 24rpx;</span></span><br><span class="line"><span class="string">  text-align: center;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.list .title &#123;</span></span><br><span class="line"><span class="string">  margin: 10rpx 20rpx;</span></span><br><span class="line"><span class="string">  font-size: 28rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.list .inner &#123;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  flex-wrap: wrap;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.list .inner .item &#123;</span></span><br><span class="line"><span class="string">  width: 33.33333333%;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.list .inner .item image &#123;</span></span><br><span class="line"><span class="string">  display: block;</span></span><br><span class="line"><span class="string">  width: 240rpx;</span></span><br><span class="line"><span class="string">  height: 240rpx;</span></span><br><span class="line"><span class="string">  margin: 0 auto;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.list .inner .item text &#123;</span></span><br><span class="line"><span class="string">  font-size: 28rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="5-自定义组件"><a href="#5-自定义组件" class="headerlink" title="5.自定义组件"></a>5.自定义组件</h1><h2 id="5-1-自定义组件的基本步骤"><a href="#5-1-自定义组件的基本步骤" class="headerlink" title="5.1 自定义组件的基本步骤"></a>5.1 自定义组件的基本步骤</h2><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576226443920.png"  alt="1576226443920"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.pages下新建components文件夹</span></span><br><span class="line"><span class="comment">//2.components文件夹下新建一个文件夹Tabs</span></span><br><span class="line"><span class="comment">//3.Tabs下新tabs.js   tabs.json   tabs.wxml   tabs.wxss</span></span><br><span class="line"><span class="comment">//4.tabs.json</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//声明组件</span></span><br><span class="line">      <span class="string">"component"</span>: <span class="literal">true</span>, </span><br><span class="line">      <span class="string">"usingComponents"</span>: &#123; </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//5.tabs.wxml</span></span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"tabs"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"tabs_title"</span>&gt;</span><br><span class="line">    &lt;!-- <span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"title_item active"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"title_item"</span>&gt;原创&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="title_item"&gt;分类&lt;/</span>view&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"title_item"</span>&gt;关于&lt;<span class="regexp">/view&gt; --&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;view </span></span><br><span class="line"><span class="regexp">    wx:for="&#123;&#123;tabs&#125;&#125;"</span></span><br><span class="line"><span class="regexp">    wx:key="id"</span></span><br><span class="line"><span class="regexp">    class="title_item &#123;&#123;item.isActive?'active':''&#125;&#125;"</span></span><br><span class="line"><span class="regexp">    bindtap="hanldeItemTap"</span></span><br><span class="line"><span class="regexp">    data-index="&#123;&#123;index&#125;&#125;"</span></span><br><span class="line"><span class="regexp">    &gt;</span></span><br><span class="line"><span class="regexp">    &#123;&#123;item.name&#125;&#125;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="tabs_content"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!-- </span></span><br><span class="line"><span class="regexp">      slot 标签 其实就是一个占位符 插槽</span></span><br><span class="line"><span class="regexp">      等到 父组件调用 子组件的时候 再传递 标签过来 最终 这些被传递的标签</span></span><br><span class="line"><span class="regexp">      就会替换 slot 插槽的位置 </span></span><br><span class="line"><span class="regexp">     --&gt;</span></span><br><span class="line"><span class="regexp">    &lt;slot&gt;&lt;/</span>slot&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//6.tabs.wxss</span></span><br><span class="line">.tabs&#123;&#125;</span><br><span class="line">.tabs_title&#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  padding: <span class="number">10</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">.title_item&#123;</span><br><span class="line">  flex: <span class="number">1</span>;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line">&#125;</span><br><span class="line">.active&#123;</span><br><span class="line">  color:red;</span><br><span class="line">  border-bottom: <span class="number">5</span>rpx solid currentColor;</span><br><span class="line">&#125;</span><br><span class="line">.tabs_content&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//7.tabs.js</span></span><br><span class="line"><span class="comment">// components/Tabs.js</span></span><br><span class="line">Component(&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 里面存放的是 要从父组件中接收的数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  properties: &#123;</span><br><span class="line">    <span class="comment">// 要接收的数据的名称</span></span><br><span class="line">    <span class="comment">// aaa:&#123;</span></span><br><span class="line">    <span class="comment">//   // type  要接收的数据的类型 </span></span><br><span class="line">    <span class="comment">//   type:String,</span></span><br><span class="line">    <span class="comment">//   // value  默认值</span></span><br><span class="line">    <span class="comment">//   value:""</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    tabs:&#123;</span><br><span class="line">      type:<span class="built_in">Array</span>,</span><br><span class="line">      value:[]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 组件的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    <span class="comment">// tabs</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  1 页面.js 文件中 存放事件回调函数的时候 存放在data同层级下！！！</span></span><br><span class="line"><span class="comment">  2 组件.js 文件中 存放事件回调函数的时候 必须要存在在 methods中！！！</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line">    hanldeItemTap(e)&#123;</span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">      1 绑定点击事件  需要在methods中绑定</span></span><br><span class="line"><span class="comment">      2 获取被点击的索引 </span></span><br><span class="line"><span class="comment">      3 获取原数组 </span></span><br><span class="line"><span class="comment">      4 对数组循环</span></span><br><span class="line"><span class="comment">        1 给每一个循环性 选中属性 改为 false</span></span><br><span class="line"><span class="comment">        2 给 当前的索引的 项 添加激活选中效果就可以了！！！</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">       </span></span><br><span class="line"><span class="comment">       5 点击事件触发的时候 </span></span><br><span class="line"><span class="comment">          触发父组件中的自定义事件 同时传递数据给  父组件  </span></span><br><span class="line"><span class="comment">          this.triggerEvent("父组件自定义事件的名称",要传递的参数)</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//  2 获取索引</span></span><br><span class="line">      <span class="keyword">const</span> &#123;index&#125;=e.currentTarget.dataset;</span><br><span class="line">      <span class="comment">// 5 触发父组件中的自定义事件 同时传递数据给  </span></span><br><span class="line">      <span class="keyword">this</span>.triggerEvent(<span class="string">"itemChange"</span>,&#123;index&#125;);</span><br><span class="line">      <span class="comment">// 3 获取data中的数组</span></span><br><span class="line">      <span class="comment">// 解构  对 复杂类型进行结构的时候 复制了一份 变量的引用而已</span></span><br><span class="line">      <span class="comment">// 最严谨的做法 重新拷贝一份 数组，再对这个数组的备份进行处理，</span></span><br><span class="line">      <span class="comment">// let tabs=JSON.parse(JSON.stringify(this.data.tabs));</span></span><br><span class="line">      <span class="comment">// 不要直接修改 this.data.数据 </span></span><br><span class="line">      <span class="comment">// let &#123;tabs&#125;=this.data;</span></span><br><span class="line">      <span class="comment">// let tabs=this.data;</span></span><br><span class="line">      <span class="comment">// 4 循环数组</span></span><br><span class="line">      <span class="comment">// [].forEach 遍历数组 遍历数组的时候 修改了 v ，也会导致源数组被修改</span></span><br><span class="line">      <span class="comment">// tabs.forEach((v,i)=&gt;i===index?v.isActive=true:v.isActive=false);</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// this.setData(&#123;</span></span><br><span class="line">        <span class="comment">// tabs</span></span><br><span class="line">      <span class="comment">// &#125;)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="5-2-使用自定义组件"><a href="#5-2-使用自定义组件" class="headerlink" title="5.2 使用自定义组件"></a>5.2 使用自定义组件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.index.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"usingComponents"</span>: &#123;</span><br><span class="line">    <span class="string">"Tabs"</span>:<span class="string">"../../components/Tabs/Tabs"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.index.wxml</span></span><br><span class="line">&lt;!-- </span><br><span class="line">  <span class="number">1</span> 父组件(页面) 向子组件 传递数据 通过 标签属性的方式来传递</span><br><span class="line">    <span class="number">1</span> 在子组件上进行接收</span><br><span class="line">    <span class="number">2</span> 把这个数据当成是data中的数据直接用即可</span><br><span class="line">  <span class="number">2</span> 子向父传递数据 通过事件的方式传递</span><br><span class="line">    <span class="number">1</span> 在子组件的标签上加入一个 自定义事件</span><br><span class="line">  </span><br><span class="line"> --&gt;</span><br><span class="line">&lt;Tabs tabs=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span> binditemChange=<span class="string">"handleItemChange"</span> &gt;</span><br><span class="line"></span><br><span class="line">&lt;block wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;tabs[0].isActive&#125;&#125;"</span>&gt;<span class="number">0</span> &lt;<span class="regexp">/block&gt;</span></span><br><span class="line"><span class="regexp">&lt;block wx:elif="&#123;&#123;tabs[1].isActive&#125;&#125;"&gt;1 &lt;/</span>block&gt;</span><br><span class="line">&lt;block wx:elif=<span class="string">"&#123;&#123;tabs[2].isActive&#125;&#125;"</span>&gt;<span class="number">2</span> &lt;<span class="regexp">/block&gt;</span></span><br><span class="line"><span class="regexp">&lt;block wx:else&gt;3&lt;/</span>block&gt;</span><br><span class="line">&lt;<span class="regexp">/Tabs&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/3.index.js</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ pages/</span>demo17/demo18.js</span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line"></span><br><span class="line">    tabs: [</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="number">0</span>,</span><br><span class="line">        name: <span class="string">"首页"</span>,</span><br><span class="line">        isActive: <span class="literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="number">1</span>,</span><br><span class="line">        name: <span class="string">"原创"</span>,</span><br><span class="line">        isActive: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">      ,</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="number">2</span>,</span><br><span class="line">        name: <span class="string">"分类"</span>,</span><br><span class="line">        isActive: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">      ,</span><br><span class="line">      &#123;</span><br><span class="line">        id: <span class="number">3</span>,</span><br><span class="line">        name: <span class="string">"关于"</span>,</span><br><span class="line">        isActive: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义事件 用来接收子组件传递的数据的</span></span><br><span class="line">  handleItemChange(e) &#123;</span><br><span class="line">    <span class="comment">// 接收传递过来的参数</span></span><br><span class="line">    <span class="keyword">const</span> &#123; index &#125; = e.detail;</span><br><span class="line">    <span class="keyword">let</span> &#123; tabs &#125; = <span class="keyword">this</span>.data;</span><br><span class="line">    tabs.forEach(<span class="function">(<span class="params">v, i</span>) =&gt;</span> i === index ? v.isActive = <span class="literal">true</span> : v.isActive = <span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      tabs</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="5-3-父子组件的通信"><a href="#5-3-父子组件的通信" class="headerlink" title="5.3 父子组件的通信"></a>5.3 父子组件的通信</h2><h3 id="5-3-1-父传子"><a href="#5-3-1-父传子" class="headerlink" title="5.3.1 父传子"></a>5.3.1 父传子</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在子组件中声明properties</span></span><br><span class="line">Component(&#123;</span><br><span class="line">  properties: &#123;</span><br><span class="line">    tabs:&#123;</span><br><span class="line">      type:<span class="built_in">Array</span>,</span><br><span class="line">      value:[]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 父组件在使用子组件的时候给子组件传递数据</span></span><br><span class="line">&lt;Tabs tabs=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span>&gt;&lt;<span class="regexp">/Tabs&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-2-子传父"><a href="#5-3-2-子传父" class="headerlink" title="5.3.2 子传父"></a>5.3.2 子传父</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件在使用子组件的时候给子组件传递事件</span></span><br><span class="line">&lt;Tabs tabs=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span> binditemChange=<span class="string">"handleItemChange"</span>&gt;&lt;<span class="regexp">/Tabs&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/在子组件的点击方法中触发父组件传递过来的事件</span></span><br><span class="line"><span class="regexp">&lt;view wx:for="&#123;&#123;tabs&#125;&#125;" class="title_item &#123;&#123;item.isActive?'active':''&#125;&#125;" wx:for-index="index" wx:key="item.id" wx:for-item="item" bindtap="hanldeItemTap" data-index="&#123;&#123;index&#125;&#125;"&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">hanldeItemTap(e)&#123;</span></span><br><span class="line"><span class="regexp">    var index = e.currentTarget.dataset.index;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/在孩子中触发父亲传递过来的事件</span></span><br><span class="line"><span class="regexp">    this.triggerEvent("itemChange",&#123;index&#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="5-4-组件的生命周期"><a href="#5-4-组件的生命周期" class="headerlink" title="5.4 组件的生命周期"></a>5.4 组件的生命周期</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html</a></p>
<pre><code>组件的生命周期，指的是组件自身的一些函数，这些函数在特殊的时间点或遇到一些特殊的框架事件时被自动触发。其中，最重要的生命周期是 `created` `attached` `detached` ，包含一个组件实例生命流程的最主要时间点</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/Dialog/dialog.js</span></span><br><span class="line">Component(&#123;</span><br><span class="line">  <span class="comment">//组件的生命周期</span></span><br><span class="line">  lifetimes: &#123;</span><br><span class="line">    created:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="comment">//在组件实例刚刚被创建时执行</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"created"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    attached: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 在组件实例进入页面节点树时执行</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"attached"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    detached: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 在组件实例被从页面节点树移除时执行</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"detached"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576227711864.png"  alt="1576227711864"></p>
<h2 id="5-5-组件数据监听"><a href="#5-5-组件数据监听" class="headerlink" title="5.5 组件数据监听"></a>5.5 组件数据监听</h2><pre><code>数据监听器可以用于监听和响应任何属性和数据字段的变化。类似于vue的watch</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">      numberA: <span class="number">1</span>,</span><br><span class="line">      numberB: <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  observers: &#123;</span><br><span class="line">    <span class="string">'numberA, numberB'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">numberA, numberB</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 在 numberA 或者 numberB 被设置时，执行这个函数</span></span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        sum: numberA + numberB</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/*监听所有数据的变化*/</span></span><br><span class="line">     <span class="string">'**'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 每次 setData 都触发</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="5-6-常用第三方组件库"><a href="#5-6-常用第三方组件库" class="headerlink" title="5.6 常用第三方组件库"></a>5.6 常用第三方组件库</h2><h3 id="5-6-1-组件库介绍"><a href="#5-6-1-组件库介绍" class="headerlink" title="5.6.1 组件库介绍"></a>5.6.1 组件库介绍</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>WeUI WXSS ： WeUI WXSS是腾讯官方UI组件库WeUI的小程序版，提供了跟微信界面风格一致的用户体验。</span><br><span class="line">   GitHub地址：https:<span class="comment">//github.com/Tencent/weui-wxss npm下载：npm i weui-wxss</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>iView WeApp：iView是TalkingData发布的一款高质量的基于Vue.js组件库，而iView weapp则是它们的小程序版本。</span><br><span class="line">   GitHub地址：https:<span class="comment">//github.com/TalkingData/iview-weapp npm下载：npm i iview-weapp</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>ZanUI WeApp：ZanUI WeApp是有赞移动 Web UI 规范 ZanUI 的小程序实现版本，结合了微信的视觉规范，为用户提供更加统一的使用感受。现已包含 badge、btn、card、cell、dialog、icon、label、noticebar、panel、popup、<span class="keyword">switch</span>、tab、toast、tooltips 等组件或元素。</span><br><span class="line">   GitHub地址：https:<span class="comment">//github.com/youzan/zanui-weapp npm下载：npm i zanui-weapp</span></span><br><span class="line">   另外，ZanUI也使用mpvue重写了zanui-weapp，实现了其中所有组件，为使用mpvue的开发者提供了方便。</span><br><span class="line">   GitHub地址：https:<span class="comment">//github.com/samwang1027/mpvue-zanui npm下载：npm i mpvue-zanui</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>MinUI ：MinUI 是蘑菇街前端开发团队开发的基于微信小程序自定义组件特性开发而成的一套简洁、易用、高效的组件库，适用场景广，覆盖小程序原生框架，各种小程序组件主流框架等，并且提供了专门的命令行工具。</span><br><span class="line">GitHub地址：https:<span class="comment">//github.com/meili/minui</span></span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>Wux WeApp：Wux WeApp也是一个非常不错的微信小程序自定义 UI 组件库，组件比较丰富，值得使用。</span><br><span class="line">GitHub地址：https:<span class="comment">//github.com/wux-weapp/wux-weapp npm下载：npm i wux-weapp</span></span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>ColorUI：ColorUI是一个Css类的UI组件库！不是一个Js框架。相比于同类小程序组件库，ColorUI更注重于视觉交互！其组件在美观性方面比较突出。</span><br><span class="line">GitHub地址：https:<span class="comment">//github.com/weilanwl/ColorUI</span></span><br></pre></td></tr></table></figure>

<h3 id="5-6-2-iView基本使用"><a href="#5-6-2-iView基本使用" class="headerlink" title="5.6.2 iView基本使用"></a>5.6.2 iView基本使用</h3><p><a href="https://weapp.iviewui.com/docs/guide/start" target="_blank" rel="noopener">https://weapp.iviewui.com/docs/guide/start</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>将 dist 目录拷贝到自己的项目中。然后按照如下的方式使用组件，以 Button 为例，其它组件在对应的文档页查看：</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 添加需要的组件。在页面的 json 中配置（路径根据自己项目位置配置）：</span><br><span class="line"></span><br><span class="line"><span class="string">"usingComponents"</span>: &#123;</span><br><span class="line">    <span class="string">"i-button"</span>: <span class="string">"../../dist/button/index"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 在 wxml 中使用组件：</span><br><span class="line"></span><br><span class="line">&lt;i-button type=<span class="string">"primary"</span> bind:click=<span class="string">"handleClick"</span>&gt;这是一个按钮&lt;<span class="regexp">/i-button&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-6-3-字体图标的使用"><a href="#5-6-3-字体图标的使用" class="headerlink" title="5.6.3 字体图标的使用"></a>5.6.3 字体图标的使用</h3><p>1、第一步：我们需要进入Font Awesome官网下载字体图标的文件</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576234396718.png"  alt="1576234396718"></p>
<p>2、第二步：我们需要用到一个Transfonter生成工具。打开刚才下载的文件，在fonts文件夹找到fontawesome-webfont.ttf</p>
<p>打开Transfonter官网，将fontawesome-webfont.ttf上传，选择base64编码，然后convert</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576234431715.png"  alt="1576234431715"></p>
<p>3、第三步：等待转换，转换完成后，点击download下载，下载完成后打开文件，找到stylesheet.css，将源码复制下来，然后进入小程序，将复制的代码放到app.wxss</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576234446512.png"  alt="1576234446512"></p>
<p>4、最后一步：找到font-awesome里的font-awesome.css，除去第一段，将其他的都复制下来放到app.wxss，然后按照font-awesome的规范来用就可以了</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576234462972.png"  alt="1576234462972"></p>
<p>5、使用字体图标</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@import &#39;..&#x2F;..&#x2F;styles&#x2F;stylesheet.wxss&#39;</span><br><span class="line"></span><br><span class="line">&lt;i class&#x3D;&quot;fa fa-play&quot;&gt;&lt;&#x2F;i&gt;</span><br></pre></td></tr></table></figure>

<h1 id="6-小程序的页面跳转"><a href="#6-小程序的页面跳转" class="headerlink" title="6.小程序的页面跳转"></a>6.小程序的页面跳转</h1><h2 id="6-1-页面跳转传值"><a href="#6-1-页面跳转传值" class="headerlink" title="6.1 页面跳转传值"></a>6.1 页面跳转传值</h2><pre><code>在微信小程序开发工具中，我们可以编辑app.json中的pages字段来快速创建页面，比如</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"pages"</span>: [</span><br><span class="line">   <span class="string">"pages/demo1/demo1"</span>,</span><br><span class="line">   <span class="string">"pages/demo2/demo2"</span>,</span><br><span class="line">   <span class="string">"pages/demo3/demo3"</span></span><br><span class="line"> ],</span><br></pre></td></tr></table></figure>

<pre><code>此时会自动帮我们创建demo1、demo2、demo3三个页面</code></pre><h3 id="6-1-1-使用url传参"><a href="#6-1-1-使用url传参" class="headerlink" title="6.1.1 使用url传参"></a>6.1.1 使用url传参</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.demo1.wxml</span></span><br><span class="line">&lt;view&gt;</span><br><span class="line">    &lt;!--hover-<span class="class"><span class="keyword">class</span></span>=<span class="string">"none"</span> 去除点击导航按钮的样式--&gt;</span><br><span class="line">   &lt;navigator url=<span class="string">"/pages/demo2/demo2?name=zhangsan&amp;age=12"</span> hover-<span class="class"><span class="keyword">class</span></span>=<span class="string">"none"</span>&gt;跳转demo2&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.demo2.js</span></span><br><span class="line"><span class="comment">//在onload方法中通过options来获取页面1传递的参数</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="6-1-2-编程式导航传参"><a href="#6-1-2-编程式导航传参" class="headerlink" title="6.1.2 编程式导航传参"></a>6.1.2 编程式导航传参</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">wx.navigateTo(&#123;</span><br><span class="line">  url: <span class="string">'test?id=1'</span>,</span><br><span class="line">  events: &#123;</span><br><span class="line">    <span class="comment">// 为指定事件添加一个监听器，获取被打开页面传送到当前页面的数据</span></span><br><span class="line">    acceptDataFromOpenedPage: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;,</span><br><span class="line">    someEvent: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 通过eventChannel向被打开页面传送数据</span></span><br><span class="line">    res.eventChannel.emit(<span class="string">'acceptDataFromOpenerPage'</span>, &#123; <span class="attr">data</span>: <span class="string">'test'</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//test.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span>(<span class="params">option</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(option.query)</span><br><span class="line">    <span class="keyword">const</span> eventChannel = <span class="keyword">this</span>.getOpenerEventChannel()</span><br><span class="line">    eventChannel.emit(<span class="string">'acceptDataFromOpenedPage'</span>, &#123;<span class="attr">data</span>: <span class="string">'test'</span>&#125;);</span><br><span class="line">    eventChannel.emit(<span class="string">'someEvent'</span>, &#123;<span class="attr">data</span>: <span class="string">'test'</span>&#125;);</span><br><span class="line">    <span class="comment">// 监听acceptDataFromOpenerPage事件，获取上一页面通过eventChannel传送到当前页面的数据</span></span><br><span class="line">    eventChannel.on(<span class="string">'acceptDataFromOpenerPage'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="6-2-导航模式"><a href="#6-2-导航模式" class="headerlink" title="6.2 导航模式"></a>6.2 导航模式</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt;</span><br><span class="line">   &lt;navigator url=<span class="string">"/pages/demo2/demo2?name=zhangsan&amp;age=12"</span> open-type=<span class="string">"redirectTo"</span> &gt;跳转demo2&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">navigate   打开新页面，新页面会压栈</span><br><span class="line">redirect    页面重定向，新页面不会压栈，而是把原来的页面替换掉</span><br><span class="line">navigateBack   回到上一个页面</span><br><span class="line">reLaunch    重新加载指定页面，页面全部出栈，只留下新的页面</span><br><span class="line">switchTab   tab切换，页面全部出栈，只留下新的 Tab 页面</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//注意点：</span></span><br><span class="line">navigate, redirect 只能打开非 tabBar 页面。</span><br><span class="line">switchTab 只能打开 tabBar 页面。</span><br><span class="line">reLaunch 可以打开任意页面。</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//回退两层，可以通过getCurrentPages()方法来查看栈中的页面个数</span></span><br><span class="line">wx.navigateBack(&#123;</span><br><span class="line">    <span class="comment">//当delta超出历史记录，返回首页</span></span><br><span class="line">    delta:<span class="number">2</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="6-3-页面数据共享"><a href="#6-3-页面数据共享" class="headerlink" title="6.3 页面数据共享"></a>6.3 页面数据共享</h2><h3 id="6-3-1-使用全局变量"><a href="#6-3-1-使用全局变量" class="headerlink" title="6.3.1 使用全局变量"></a>6.3.1 使用全局变量</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line">  App(&#123;</span><br><span class="line">  onLaunch: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 登录</span></span><br><span class="line">    wx.login(&#123;</span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 发送 res.code 到后台换取 openId, sessionKey, unionId</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 全局变量</span></span><br><span class="line">  globalData: &#123;</span><br><span class="line">    userInfo: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> app = getApp();</span><br><span class="line">    <span class="keyword">if</span> (app.globalData.userInfo === <span class="literal">null</span>)&#123;</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123; <span class="string">"haveLogin"</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123; <span class="string">"haveLogin"</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="6-3-2-使用缓存"><a href="#6-3-2-使用缓存" class="headerlink" title="6.3.2 使用缓存"></a>6.3.2 使用缓存</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//缓存数据</span></span><br><span class="line"><span class="comment">//不管什么数据，最终都会调用toString()将数据转换成字符串存进去</span></span><br><span class="line">wx.setStorage(&#123;</span><br><span class="line">    key: <span class="string">'userInfo'</span>,</span><br><span class="line">    data: res.userInfo</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getUsersInfo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//读取缓存登录</span></span><br><span class="line">    wx.getStorage(&#123;</span><br><span class="line">        key: <span class="string">'userInfo'</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.userInfo = res.userInfo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-生命周期"><a href="#7-生命周期" class="headerlink" title="7 生命周期"></a>7 生命周期</h1><h2 id="7-1-应用的生命周期"><a href="#7-1-应用的生命周期" class="headerlink" title="7.1 应用的生命周期"></a>7.1 应用的生命周期</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">App(&#123;&#125;)     App方法的作用：用来创建应用程序对象，并指定应用程序的生命周期</span><br><span class="line"></span><br><span class="line"><span class="comment">//app.js</span></span><br><span class="line">App(&#123;</span><br><span class="line">  <span class="comment">//  1 应用第一次启动的就会触发的事件  </span></span><br><span class="line">  onLaunch() &#123;</span><br><span class="line">    <span class="comment">//  在应用第一次启动的时候 获取用户的个人信息 </span></span><br><span class="line">    <span class="comment">// console.log("onLaunch");</span></span><br><span class="line">    <span class="comment">// aabbcc</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// js的方式来跳转 不能触发 onPageNotFound</span></span><br><span class="line">    <span class="comment">// wx.navigateTo(&#123;</span></span><br><span class="line">    <span class="comment">//   url: '/11/22/33'</span></span><br><span class="line">    <span class="comment">// &#125;);</span></span><br><span class="line">      </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2 应用 被用户看到 </span></span><br><span class="line">  onShow()&#123;</span><br><span class="line">    <span class="comment">// 对应用的数据或者页面效果 重置 </span></span><br><span class="line">    <span class="comment">// console.log("onShow");</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 3 应用 被隐藏了 </span></span><br><span class="line">  onHide()&#123;</span><br><span class="line">    <span class="comment">// 暂停或者清除定时器 </span></span><br><span class="line">    <span class="comment">// console.log("Hide");</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 4 应用的代码发生了报错的时候 就会触发</span></span><br><span class="line">  onError(err)&#123;</span><br><span class="line">    <span class="comment">// 在应用发生代码报错的时候，收集用户的错误信息，通过异步请求 将错误的信息发送后台去</span></span><br><span class="line">    <span class="comment">// console.log("onError");</span></span><br><span class="line">    <span class="comment">// console.log(err);</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 5 页面找不到就会触发 </span></span><br><span class="line">  <span class="comment">//  应用第一次启动的时候，如果找不到第一个入口页面 才会触发</span></span><br><span class="line">  onPageNotFound()&#123;</span><br><span class="line">    <span class="comment">// 如果页面不存在了 通过js的方式来重新跳转页面 重新跳到第二个首页</span></span><br><span class="line">    <span class="comment">// 不能跳到tabbar页面  导航组件类似  </span></span><br><span class="line">    wx.navigateTo(&#123;</span><br><span class="line">      url: <span class="string">'/pages/demo09/demo09'</span> </span><br><span class="line">    &#125;);  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">// console.log("onPageNotFound");</span></span><br><span class="line">  &#125;,</span><br><span class="line">   <span class="comment">//全局数据</span></span><br><span class="line">  globalData: <span class="string">'I am global data'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576227793464.png"  alt="1576227793464"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576228221331.png"  alt="1576228221331"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570002017840.png"  alt="1570002017840"></p>
<h2 id="7-2-页面的生命周期"><a href="#7-2-页面的生命周期" class="headerlink" title="7.2 页面的生命周期"></a>7.2 页面的生命周期</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">index.js  负责页面的逻辑</span><br><span class="line">index.wxml  页面的内容，严格遵循xml规范</span><br><span class="line">index.wxss  页面的样式</span><br><span class="line">index.json   页面的配置文件</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages/demo18/demo18.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onLoad"</span>);</span><br><span class="line">    <span class="comment">// onLoad发送异步请求来初始化页面数据 </span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面显示</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onShow: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onShow"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 生命周期函数--监听页面初次渲染完成</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  onReady: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onReady"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面隐藏</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onHide: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onHide"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面卸载 也是可以通过点击超链接来演示 </span></span><br><span class="line"><span class="comment">   * </span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onUnload: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onUnload"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面相关事件处理函数--监听用户下拉动作</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onPullDownRefresh: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onPullDownRefresh"</span>);</span><br><span class="line">    <span class="comment">// 页面的数据 或者效果 重新 刷新</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面上拉触底事件的处理函数</span></span><br><span class="line"><span class="comment">   * 需要让页面 出现上下滚动才行 </span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onReachBottom: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onReachBottom"</span>);</span><br><span class="line">    <span class="comment">// 上拉加载下一页数据 </span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 用户点击右上角分享</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onShareAppMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onShareAppMessage"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面滚动 就可以触发 </span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onPageScroll()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onPageScroll"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的尺寸发生改变的时候 触发</span></span><br><span class="line"><span class="comment">   * 小程序 发生了 横屏竖屏 切换的时候触发 </span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onResize()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onResize"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 1 必须要求当前页面 也是tabbar页面</span></span><br><span class="line"><span class="comment">   * 2 点击的自己的tab item的时候才触发</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onTabItemTap()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onTabItemTap"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!--pages/demo18/demo18.wxml--&gt;</span><br><span class="line">&lt;text&gt;pages/demo18/demo18.wxml&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;navigator url="/</span>pages/demo17/demo17<span class="string">" open-type="</span>navigate<span class="string">"&gt;</span></span><br><span class="line"><span class="string">  demo17</span></span><br><span class="line"><span class="string">&lt;/navigator&gt;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">&lt;navigator url="</span>/pages/demo17/demo17<span class="string">" open-type="</span>redirect<span class="string">"&gt;</span></span><br><span class="line"><span class="string">  demo17 redirect</span></span><br><span class="line"><span class="string">&lt;/navigator&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;1&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;2&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;3&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;4&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;5&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;6&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;7&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;8&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;9&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;10&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;11&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;12&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;13&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;14&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;15&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;16&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;17&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;18&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;19&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;20&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;21&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;22&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;23&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;24&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;25&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;26&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;27&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;28&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;29&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;30&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;31&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;32&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;33&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;34&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;35&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;36&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;37&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;38&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;39&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;40&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;41&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;42&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;43&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;44&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;45&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;46&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;47&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;48&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;49&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view&gt;50&lt;/view&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*demo18.json:如果要onResize执行，需要开启屏幕旋转*/</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    "</span>pageOrientation<span class="string">": "</span>auto<span class="string">"</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576227820608.png"  alt="1576227820608"></p>
<h1 id="8-微信小程序开放能力"><a href="#8-微信小程序开放能力" class="headerlink" title="8.微信小程序开放能力"></a>8.微信小程序开放能力</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> &lt;!-- </span><br><span class="line">  button 开放能力</span><br><span class="line">  open-type：</span><br><span class="line">  <span class="number">1</span> contact 直接打开客服对话功能  需要在微信小程序的后台配置   只能够通过真机调试来打开 </span><br><span class="line">  <span class="number">2</span> share 转发当前的小程序 到微信朋友中   不能把小程序 分享到 朋友圈 </span><br><span class="line">  <span class="number">3</span> getPhoneNumber 获取当前用户的手机号码信息 结合一个事件来使用  不是企业的小程序账号没有权限来获取用户的手机号码 </span><br><span class="line">    a) 绑定一个事件 bindgetphonenumber </span><br><span class="line">    b) 在事件的回调函数中  通过参数来获取信息 </span><br><span class="line">    c) 获取到的信息  已经加密过了 </span><br><span class="line">      需要用户自己待见小程序的后台服务器，在后台服务器中进行解析手机号码，返回到小程序中 就可以看到信息了</span><br><span class="line">  <span class="number">4</span> getUserInfo 获取当前用户的个人信息</span><br><span class="line">    a) 使用方法 类似 获取用户的手机号码</span><br><span class="line">    b) 可以直接获取 不存在加密的字段 </span><br><span class="line">  <span class="number">5</span> launchApp 在小程序当中 直接打开 app</span><br><span class="line">    a) 需要现在 app中 通过app的某个链接 打开 小程序</span><br><span class="line">    b) 在小程序 中 再通过 这个功能 打开 app</span><br><span class="line">  <span class="number">6</span> openSetting 打开小程序内置的 授权页面</span><br><span class="line">    a) 授权页面中 只会出现 用户曾经点击过的 权限 </span><br><span class="line">  <span class="number">7</span> feedback 打开 小程序内置的 意见反馈页面 </span><br><span class="line">    a) 只能够通过真机调试来打开 </span><br><span class="line">  --&gt;</span><br><span class="line">&lt;button open-type=<span class="string">"contact"</span>&gt;contact&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button open-type="share"&gt;share&lt;/</span>button&gt;</span><br><span class="line">&lt;button open-type=<span class="string">"getPhoneNumber"</span> bindgetphonenumber=<span class="string">"getPhoneNumber"</span>&gt;getPhoneNumber&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button open-type="getUserInfo" bindgetuserinfo="getUserInfo"&gt;getUserInfo&lt;/</span>button&gt;</span><br><span class="line">&lt;button open-type=<span class="string">"launchApp"</span>&gt;launchApp&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button open-type="openSetting"&gt;openSetting&lt;/</span>button&gt;</span><br><span class="line">&lt;button open-type=<span class="string">"feedback"</span>&gt;feedback&lt;<span class="regexp">/button&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="8-1-获取用户信息"><a href="#8-1-获取用户信息" class="headerlink" title="8.1 获取用户信息"></a>8.1 获取用户信息</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;button </span><br><span class="line">	wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;canIUse&#125;&#125;"</span> </span><br><span class="line">	open-type=<span class="string">"getUserInfo"</span> </span><br><span class="line">	bindgetuserinfo=<span class="string">"bindGetUserInfo"</span></span><br><span class="line">&gt;获取用户信息&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;view wx:else&gt;请升级微信版本&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取应用实例</span></span><br><span class="line"><span class="keyword">const</span> app = getApp()</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    <span class="comment">//判断小程序的API，回调，参数，组件等是否在当前版本可用。</span></span><br><span class="line">    canIUse: wx.canIUse(<span class="string">'button.open-type.getUserInfo'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  bindGetUserInfo: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.detail.userInfo)</span><br><span class="line">    <span class="keyword">if</span> (e.detail.userInfo) &#123;</span><br><span class="line">      <span class="comment">//用户按了允许授权按钮</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//用户按了拒绝按钮</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="8-2-登陆"><a href="#8-2-登陆" class="headerlink" title="8.2 登陆"></a>8.2 登陆</h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  &lt;button bindtap=<span class="string">"loginHandler"</span>&gt;login&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">   loginHandler:function(e)&#123;</span></span><br><span class="line"><span class="regexp">    wx.login(&#123;</span></span><br><span class="line"><span class="regexp">      success:(res)=&gt;&#123;</span></span><br><span class="line"><span class="regexp">        console.log(res)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp"> /</span><span class="regexp">/关于openid获取   openid是小程序的唯一标识，做支付功能的时候需要用到openid(支付需要企业账号)</span></span><br><span class="line"><span class="regexp">https:/</span><span class="regexp">/www.cnblogs.com/</span>legendheng/p/<span class="number">9469173.</span>html</span><br></pre></td></tr></table></figure>

<h2 id="8-3-打开客服"><a href="#8-3-打开客服" class="headerlink" title="8.3 打开客服"></a>8.3 打开客服</h2><p>a. 把微信小程序测试号换成我们注册的账号</p>
<p>b.到微信小程序后台配置客服人员</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576224742351.png"  alt="1576224742351"></p>
<p>c.添加开发者</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576225645067.png"  alt="1576225645067"></p>
<p>d.用户用微信扫一扫打开小程序，然后点击contact就可以和客服人员聊天了</p>
<p>e.管理员可以登录网页端客服或 移动端小程序客服 进行客服沟通</p>
<h2 id="8-4-转发"><a href="#8-4-转发" class="headerlink" title="8.4 转发"></a>8.4 转发</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">'share'</span> id=<span class="string">"shareBtn"</span> open-type=<span class="string">"share"</span> type=<span class="string">"primary"</span>&gt;</span><br><span class="line">  分享</span><br><span class="line">&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/获取应用实例</span></span><br><span class="line"><span class="regexp">const app = getApp()</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  onLoad: function (options) &#123;</span></span><br><span class="line"><span class="regexp">    console.log(options);</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span>**</span><br><span class="line">  * 进行页面分享</span><br><span class="line">  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  onShareAppMessage: function (options) &#123;</span></span><br><span class="line"><span class="regexp">    if (options.from === 'button') &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ 来自页面内转发按钮</span></span><br><span class="line"><span class="regexp">      console.log(options.target)</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/## 此为转发页面所显示的标题</span></span><br><span class="line"><span class="regexp">      title: '好友代付', </span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/## 此为转发给微信好友或微信群后，对方点击后进入的页面链接在onload中的options中可以获取到参数</span></span><br><span class="line"><span class="regexp">      path: 'pages/</span>profile/profile?sn=<span class="number">123</span><span class="string">', </span></span><br><span class="line"><span class="string">      //## 转发操作成功后的回调函数，用于对发起者的提示语句或其他逻辑处理</span></span><br><span class="line"><span class="string">      //https://mp.weixin.qq.com/s?__biz=MjM5NDAwMTA2MA==&amp;mid=2695730124&amp;idx=1&amp;sn=666a448b047d657350de7684798f48d3&amp;chksm=83d74a07b4a0c311569a748f4d11a5ebcce3ba8f6bd5a4b3183a4fea0b3442634a1c71d3cdd0&amp;scene=21#wechat_redirect</span></span><br><span class="line"><span class="string">      success: function (res) &#123;</span></span><br><span class="line"><span class="string">        // 转发成功</span></span><br><span class="line"><span class="string">        console.log("转发成功:" + JSON.stringify(res));</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      fail: function (res) &#123;</span></span><br><span class="line"><span class="string">        // 转发失败</span></span><br><span class="line"><span class="string">        console.log("转发失败:" + JSON.stringify(res));</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="8-5-获取用户地址"><a href="#8-5-获取用户地址" class="headerlink" title="8.5 获取用户地址"></a>8.5 获取用户地址</h2><h3 id="8-5-1-基于回调的解决方案"><a href="#8-5-1-基于回调的解决方案" class="headerlink" title="8.5.1 基于回调的解决方案"></a>8.5.1 基于回调的解决方案</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">handleChooseAddress()&#123;</span><br><span class="line">    <span class="comment">//获取之前的设置状态</span></span><br><span class="line">    wx.getSetting(&#123;</span><br><span class="line">        success:<span class="function">(<span class="params">result</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">//获取用户之前对于地址的操作</span></span><br><span class="line">            <span class="keyword">const</span> scopeAddress = result.authSetting[<span class="string">'scope.address'</span>];</span><br><span class="line">            <span class="comment">//如果从来没有点击过或者同意用户地址的授权</span></span><br><span class="line">            <span class="keyword">if</span>(scopeAddress===<span class="literal">true</span>||scopeAddress===<span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="comment">//选择收获地址</span></span><br><span class="line">                wx.chooseAddress(&#123;</span><br><span class="line">                    success:<span class="function">(<span class="params">result1</span>)=&gt;</span>&#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(result1);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//如果用户之前点击了拒绝</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//打开设置页面</span></span><br><span class="line">                wx.openSetting(&#123;</span><br><span class="line">                    success:<span class="function">(<span class="params">result2</span>)=&gt;</span>&#123;</span><br><span class="line">                        <span class="comment">//重新选择收获地址</span></span><br><span class="line">                        wx.chooseAddress(&#123;</span><br><span class="line">                            success:<span class="function">(<span class="params">result3</span>)=&gt;</span>&#123;</span><br><span class="line">                                <span class="built_in">console</span>.log(result3);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-5-2-基于async-的解决放案"><a href="#8-5-2-基于async-的解决放案" class="headerlink" title="8.5.2 基于async 的解决放案"></a>8.5.2 基于async 的解决放案</h3><ol>
<li><p>在小程序的开发共具中，勾选 es6转es5语法</p>
</li>
<li><p>下载 facebook的regenerator库中的 regenerator/packages/regenerator-runtime/runtime.js</p>
<p><a href="https://github.com/facebook/regenerator/blob/5703a79746fffc152600fdcef46ba9230671025a/packages/regenerator-runtime/runtime.js" target="_blank" rel="noopener">https://github.com/facebook/regenerator/blob/5703a79746fffc152600fdcef46ba9230671025a/packages/regenerator-runtime/runtime.js</a></p>
</li>
<li><p>在小程序目录下新建文件夹 lib/runtime/runtime.js ，将代码拷贝进去</p>
</li>
<li><p>在每一个需要使用async语法的js文件中，都引用（不能全局引用）</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getSetting, chooseAddress, openSetting&#125; <span class="keyword">from</span> <span class="string">"../../utils/asyncWx.js"</span>;</span><br><span class="line"><span class="keyword">import</span> regeneratorRuntime <span class="keyword">from</span> <span class="string">'../../lib/runtime/runtime'</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> handleChooseAddress() &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 1 获取 权限状态</span></span><br><span class="line">      <span class="keyword">const</span> res1 = <span class="keyword">await</span> getSetting();</span><br><span class="line">      <span class="keyword">const</span> scopeAddress = res1.authSetting[<span class="string">"scope.address"</span>];</span><br><span class="line">      <span class="comment">// 2 判断 权限状态</span></span><br><span class="line">      <span class="keyword">if</span> (scopeAddress === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">await</span> openSetting();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 4 调用获取收货地址的 api</span></span><br><span class="line">      <span class="keyword">let</span> address = <span class="keyword">await</span> chooseAddress();</span><br><span class="line">      <span class="built_in">console</span>.log(address)</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">//asyncWx.js</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * promise 形式  getSetting</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getSetting=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">    wx.getSetting(&#123;</span><br><span class="line">      success: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(result);</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * promise 形式  chooseAddress</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> chooseAddress=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">    wx.chooseAddress(&#123;</span><br><span class="line">      success: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(result);</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * promise 形式  openSetting</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> openSetting=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">    wx.openSetting(&#123;</span><br><span class="line">      success: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(result);</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9-本地生活项目"><a href="#9-本地生活项目" class="headerlink" title="9.本地生活项目"></a>9.本地生活项目</h1><h2 id="9-1-小程序外观、工具栏和公共样式"><a href="#9-1-小程序外观、工具栏和公共样式" class="headerlink" title="9.1 小程序外观、工具栏和公共样式"></a>9.1 小程序外观、工具栏和公共样式</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#app.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"pages"</span>: [</span><br><span class="line">    <span class="string">"pages/index/index"</span>,</span><br><span class="line">    <span class="string">"pages/message/message"</span>,</span><br><span class="line">    <span class="string">"pages/profile/profile"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"window"</span>: &#123;</span><br><span class="line">    <span class="string">"backgroundTextStyle"</span>: <span class="string">"light"</span>,</span><br><span class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#3a4861"</span>,</span><br><span class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"本地生活"</span>,</span><br><span class="line">    <span class="string">"navigationBarTextStyle"</span>: <span class="string">"black"</span>,</span><br><span class="line">    <span class="string">"backgroundColor"</span>:<span class="string">"#bcc0c9"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"sitemapLocation"</span>: <span class="string">"sitemap.json"</span>,</span><br><span class="line">  <span class="string">"tabBar"</span>: &#123;</span><br><span class="line">    <span class="string">"color"</span>: <span class="string">"#999"</span>,</span><br><span class="line">    <span class="string">"selectedColor"</span>: <span class="string">"#333"</span>,</span><br><span class="line">    <span class="string">"borderStyle"</span>: <span class="string">"black"</span>,</span><br><span class="line">    <span class="string">"position"</span>: <span class="string">"bottom"</span>,</span><br><span class="line">    <span class="string">"backgroundColor"</span>:<span class="string">"#fff"</span>,</span><br><span class="line">    <span class="string">"list"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/index/index"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"首页"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"assets/tabs/home.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"assets/tabs/home-active.png"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/message/message"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"消息"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"assets/tabs/message.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"assets/tabs/message-active.png"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"pagePath"</span>: <span class="string">"pages/profile/profile"</span>,</span><br><span class="line">        <span class="string">"text"</span>: <span class="string">"我的"</span>,</span><br><span class="line">        <span class="string">"iconPath"</span>: <span class="string">"assets/tabs/profile.png"</span>,</span><br><span class="line">        <span class="string">"selectedIconPath"</span>: <span class="string">"assets/tabs/profile-active.png"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.app.wxss</span><br><span class="line">page &#123;</span><br><span class="line">  background-color: #f0f0f0;</span><br><span class="line">  font-size:<span class="number">18</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-2-首页布局"><a href="#9-2-首页布局" class="headerlink" title="9.2 首页布局"></a>9.2 首页布局</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 首页轮播图分区 --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">'sliders'</span>&gt;</span><br><span class="line">    &lt;swiper indicator-dots=<span class="string">"&#123;&#123;true&#125;&#125;"</span> autoplay=<span class="string">"&#123;&#123;true&#125;&#125;"</span> interval=<span class="string">"2500"</span> duration=<span class="string">"400"</span> circular&gt;</span><br><span class="line">        &lt;swiper-item&gt;</span><br><span class="line">          &lt;image src=<span class="string">"/assets/images/banner-01.png"</span> mode=<span class="string">"aspectFill"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>swiper-item&gt;</span><br><span class="line">        &lt;swiper-item&gt;</span><br><span class="line">          &lt;image src=<span class="string">"/assets/images/banner-02.png"</span> mode=<span class="string">"aspectFill"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>swiper-item&gt;</span><br><span class="line">    &lt;<span class="regexp">/swiper&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line">&lt;!-- 首页导航分区 --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">'grids bgw'</span>&gt;</span><br><span class="line">    &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">        &lt;image src=<span class="string">'/assets/icons/grid-01.png'</span> lazy-load&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">        &lt;text&gt;测试&lt;/</span>text&gt;</span><br><span class="line">    &lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;image src='/</span>assets/icons/grid<span class="number">-02.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-03.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-04.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-05.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-06.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-07.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-08.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">     &lt;navigator  class="item"&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/icons/grid<span class="number">-09.</span>png<span class="string">' lazy-load&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">        &lt;text&gt;测试&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;!-- 首页入口分区 --&gt;</span></span><br><span class="line"><span class="string">&lt;view class='</span>enter<span class="string">'&gt;</span></span><br><span class="line"><span class="string">    &lt;navigator class='</span>item<span class="string">'&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/images/link<span class="number">-01.</span>png<span class="string">'&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">    &lt;navigator class='</span>item<span class="string">'&gt;</span></span><br><span class="line"><span class="string">        &lt;image src='</span>/assets/images/link<span class="number">-02.</span>png<span class="string">'&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">    &lt;/navigator&gt;</span></span><br><span class="line"><span class="string">&lt;/view&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*1.轮播图样式*/</span></span><br><span class="line"><span class="string">.sliders&#123;</span></span><br><span class="line"><span class="string">  height: 300rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.sliders image&#123;</span></span><br><span class="line"><span class="string">  /*1.图片需要设置宽高，如果不设置宽高，微信小程序中的图片会有默认的宽高</span></span><br><span class="line"><span class="string">     2.这边当图片设置宽高之后，发现图片失真了，此时需要设置image的mode</span></span><br><span class="line"><span class="string">     https://developers.weixin.qq.com/miniprogram/dev/component/image.html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">https://blog.csdn.net/qq_2842405070/article/details/69382503</span></span><br><span class="line"><span class="string">     */</span></span><br><span class="line"><span class="string">  width: 100%;</span></span><br><span class="line"><span class="string">  height: 100%;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*首页九宫格样式*/</span></span><br><span class="line"><span class="string">.grids&#123;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  flex-wrap: wrap;</span></span><br><span class="line"><span class="string">  font-size: 28rpx;</span></span><br><span class="line"><span class="string">  color: #888;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.grids .item&#123;</span></span><br><span class="line"><span class="string">  width: 250rpx;</span></span><br><span class="line"><span class="string">  height: 250rpx;</span></span><br><span class="line"><span class="string">  border-right: 1rpx solid #ddd;</span></span><br><span class="line"><span class="string">  border-top: 1rpx solid #ddd;</span></span><br><span class="line"><span class="string">  box-sizing: border-box;</span></span><br><span class="line"><span class="string">  /*让item内容在item容器内水平垂直居中*/</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  flex-direction: column;</span></span><br><span class="line"><span class="string">  justify-content: center;</span></span><br><span class="line"><span class="string">  align-items: center;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*给3的倍数的item添加做边框*/</span></span><br><span class="line"><span class="string">.grids .item:nth-last-child(3n)&#123;</span></span><br><span class="line"><span class="string">   border-left: 1rpx solid #ddd;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">/*给第7 8 9 个item添加下边框*/</span></span><br><span class="line"><span class="string">.grids .item:nth-child(n+7)&#123;</span></span><br><span class="line"><span class="string">  border-bottom: 1rpx solid #ddd;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.grids .item image&#123;</span></span><br><span class="line"><span class="string">  width: 70rpx;</span></span><br><span class="line"><span class="string">  height: 70rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.grids .item text&#123;</span></span><br><span class="line"><span class="string">  margin-top: 20rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/*首页入口样式*/</span></span><br><span class="line"><span class="string">.enter &#123;</span></span><br><span class="line"><span class="string">    display: flex;</span></span><br><span class="line"><span class="string">    padding: 20rpx 25rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.enter .item &#123;</span></span><br><span class="line"><span class="string">    width: 50%;</span></span><br><span class="line"><span class="string">    display: flex;</span></span><br><span class="line"><span class="string">    justify-content: center;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.enter image &#123;</span></span><br><span class="line"><span class="string">    width: 320rpx;</span></span><br><span class="line"><span class="string">    height: 178rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="9-3-首页请求数据"><a href="#9-3-首页请求数据" class="headerlink" title="9.3 首页请求数据"></a>9.3 首页请求数据</h2><h3 id="9-3-1-wx-request基本使用"><a href="#9-3-1-wx-request基本使用" class="headerlink" title="9.3.1 wx.request基本使用"></a>9.3.1 wx.request基本使用</h3><p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/network/request/wx.request.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/network/request/wx.request.html</a></p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad:<span class="function"><span class="keyword">function</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//小程序中没有跨域问题</span></span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      <span class="comment">//请求地址</span></span><br><span class="line">      url: <span class="string">'https://locally.uieee.com/slides'</span>,</span><br><span class="line">      <span class="comment">//请求方式</span></span><br><span class="line">      method:<span class="string">"get"</span>,</span><br><span class="line">      <span class="comment">//请求参数</span></span><br><span class="line">      data:&#123;&#125;,</span><br><span class="line">      <span class="comment">//设置请求头</span></span><br><span class="line">      header: &#123;&#125;,</span><br><span class="line">      <span class="comment">//请求返回结果的数据类型</span></span><br><span class="line">      dataType:<span class="string">"json"</span>,</span><br><span class="line">      <span class="comment">//请求回调</span></span><br><span class="line">      success:<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 请求失败执行的回调函数</span></span><br><span class="line">      fail: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;&#125;,</span><br><span class="line">       <span class="comment">// 接口调用结束的回调函数（调用成功、失败都会执行）</span></span><br><span class="line">       complete: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;&#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569742369137.png"  alt="1569742369137"></p>
<p>发现报错，原因是微信小程序中发请求得先在小程序后台配置合法的域名请求列表。</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569742448980.png"  alt="1569742448980"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569742508228.png"  alt="1569742508228"></p>
<pre><code>此时发现可以正常请求网络了。</code></pre><blockquote>
<p>注意点：</p>
</blockquote>
<pre><code>小程序在线上的版本都是需要使用https的请求,同时只能请求到自己在微信公众号中配置好的https服务器。不过在开发环境中,在电脑上的微信web开具中的 详情底下的不进行https校验打上勾即可发送http请求,也使用小程序request的api进行发送.</code></pre><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569742566195.png"  alt="1569742566195"></p>
<pre><code>关于搭建https服务器，参照服务器搭建部分内容。</code></pre><h3 id="9-3-2-首页完成数据请求和绑定"><a href="#9-3-2-首页完成数据请求和绑定" class="headerlink" title="9.3.2 首页完成数据请求和绑定"></a>9.3.2 首页完成数据请求和绑定</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    sliderList:[],</span><br><span class="line">    navList:[]</span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad:<span class="function"><span class="keyword">function</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: <span class="string">"https://locally.uieee.com/slides"</span>,</span><br><span class="line">      success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *   this.setData 有两个功能：</span></span><br><span class="line"><span class="comment">         *      1. 更新数据</span></span><br><span class="line"><span class="comment">         *      2. 更新视图</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          sliderList: res.data</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">/* 2.请求导航 */</span></span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: <span class="string">"https://locally.uieee.com/categories"</span>,</span><br><span class="line">      <span class="comment">//这边使用箭头函数来解决函数中的this问题</span></span><br><span class="line">      success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// console.log(res);</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *   this.setData 有两个功能：</span></span><br><span class="line"><span class="comment">         *      1. 更新数据</span></span><br><span class="line"><span class="comment">         *      2. 更新视图</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          navList: res.data</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- 首页轮播图分区 --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">'sliders'</span>&gt;</span><br><span class="line">    &lt;swiper indicator-dots=<span class="string">"true"</span> autoplay=<span class="string">"true"</span> interval=<span class="string">"2500"</span> duration=<span class="string">"400"</span> circular&gt;</span><br><span class="line">        &lt;swiper-item wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;sliderList&#125;&#125;"</span> wx:key=<span class="string">"id"</span>&gt;</span><br><span class="line">          &lt;image src=<span class="string">"&#123;&#123;item.image&#125;&#125;"</span> mode=<span class="string">"aspectFill"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>swiper-item&gt;</span><br><span class="line">    &lt;<span class="regexp">/swiper&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line">&lt;!-- 首页导航分区 --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">'grids bgw'</span>&gt;</span><br><span class="line">    &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span> wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;navList&#125;&#125;"</span> wx:key=<span class="string">"id"</span>&gt;</span><br><span class="line">        &lt;image src=<span class="string">'&#123;&#123;item.icon&#125;&#125;'</span> lazy-load&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">        &lt;text&gt;&#123;&#123;item.name&#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">    &lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br></pre></td></tr></table></figure>

<h3 id="9-3-3-请求工具类的封装"><a href="#9-3-3-请求工具类的封装" class="headerlink" title="9.3.3 请求工具类的封装"></a>9.3.3 请求工具类的封装</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//utils/fetch.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同时发送异步代码的次数</span></span><br><span class="line"><span class="keyword">let</span> ajaxTimes=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">url, data</span>) =&gt;</span> &#123;</span><br><span class="line">  ajaxTimes++;</span><br><span class="line">  <span class="comment">// 显示加载中 效果</span></span><br><span class="line">  wx.showLoading(&#123;</span><br><span class="line">    title: <span class="string">"加载中"</span>,</span><br><span class="line">    mask: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: <span class="string">`https://locally.uieee.com/<span class="subst">$&#123;url&#125;</span>`</span>,</span><br><span class="line">      data:data,</span><br><span class="line">      success: resolve,</span><br><span class="line">      fail: reject,</span><br><span class="line">      complete:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">         ajaxTimes--;</span><br><span class="line">         <span class="keyword">if</span>(ajaxTimes===<span class="number">0</span>)&#123;</span><br><span class="line">             <span class="comment">//  关闭正在等待的图标</span></span><br><span class="line">             wx.hideLoading();</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//index/index.js</span></span><br><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">'../../utils/fetch.js'</span>)</span><br><span class="line"></span><br><span class="line">onLoad:<span class="function"><span class="keyword">function</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    fetch(<span class="string">"slides"</span>).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        sliderList: res.data</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    fetch(<span class="string">"categories"</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        navList: res.data</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-4-列表页面"><a href="#9-4-列表页面" class="headerlink" title="9.4 列表页面"></a>9.4 列表页面</h2><h3 id="9-4-1-首页跳转到列表页面"><a href="#9-4-1-首页跳转到列表页面" class="headerlink" title="9.4.1 首页跳转到列表页面"></a>9.4.1 首页跳转到列表页面</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//1.app.json</span></span><br><span class="line"> <span class="string">"pages"</span>: [</span><br><span class="line">    <span class="string">"pages/index/index"</span>,</span><br><span class="line">    <span class="string">"pages/message/message"</span>,</span><br><span class="line">    <span class="string">"pages/profile/profile"</span>,</span><br><span class="line">    <span class="string">"pages/list/list"</span></span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.index.wxml</span></span><br><span class="line">&lt;!-- 首页导航分区 --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">'grids bgw'</span>&gt;</span><br><span class="line">    &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span> url=<span class="string">"/pages/list/list?category=&#123;&#123;item.id&#125;&#125;"</span> wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;navList&#125;&#125;"</span> wx:key=<span class="string">"id"</span>&gt;</span><br><span class="line">        &lt;image src=<span class="string">'&#123;&#123;item.icon&#125;&#125;'</span> lazy-load&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">        &lt;text&gt;&#123;&#123;item.name&#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">    &lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.list.js</span></span><br><span class="line"> onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options.category)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="9-4-2-扩展组件的使用"><a href="#9-4-2-扩展组件的使用" class="headerlink" title="9.4.2 扩展组件的使用"></a>9.4.2 扩展组件的使用</h3><p><a href="https://developers.weixin.qq.com/miniprogram/dev/extended/weui/quickstart.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/extended/weui/quickstart.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.下载相关需要使用的组件</span></span><br><span class="line"><span class="comment">//2.在需要引入扩展组件的页面模块中，修改.json文件</span></span><br><span class="line"><span class="comment">//3.使用扩展组件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.list.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"usingComponents"</span>: &#123;</span><br><span class="line">    <span class="string">"mp-searchbar"</span>: <span class="string">"../components/searchbar/searchbar"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.list.wxml</span></span><br><span class="line">&lt;mp-searchbar placeholder=<span class="string">"请输入关键字搜索"</span> bindselectresult=<span class="string">"selectResult"</span> search=<span class="string">"&#123;&#123;search&#125;&#125;"</span>&gt;&lt;<span class="regexp">/mp-searchbar&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/3.list.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data: &#123;</span></span><br><span class="line"><span class="regexp">    hasMore:true,</span></span><br><span class="line"><span class="regexp">    </span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  onLoad: function (options) &#123;</span></span><br><span class="line"><span class="regexp">    console.log(options.category)</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      search: this.search.bind(this)</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  search: function (value) &#123;</span></span><br><span class="line"><span class="regexp">    return new Promise((resolve, reject) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">      setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/在这更改数据源</span></span><br><span class="line"><span class="regexp">        resolve([&#123; text: '搜索结果', value: 1 &#125;, &#123; text: '搜索结果2', value: 2 &#125;])</span></span><br><span class="line"><span class="regexp">      &#125;, 200)</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/选中某个搜索结果后</span></span><br><span class="line"><span class="regexp">  selectResult: function (e) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('select result', e.detail)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-3-列表页面布局"><a href="#9-4-3-列表页面布局" class="headerlink" title="9.4.3 列表页面布局"></a>9.4.3 列表页面布局</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;mp-searchbar placeholder=<span class="string">"请输入关键字搜索"</span> bindselectresult=<span class="string">"selectResult"</span> search=<span class="string">"&#123;&#123;search&#125;&#125;"</span>&gt;&lt;<span class="regexp">/mp-searchbar&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;view class="shop"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;image class="shop-img" src="http:/</span><span class="regexp">/p0.meituan.net/</span><span class="number">200.0</span>/deal/<span class="number">5511</span>b4e5b25fdd67aea0bbca8656ec581139488.jpg@<span class="number">200</span>_0_800_800a%<span class="number">7</span>C267h_267w_2e_90Q<span class="string">"&gt;&lt;/image&gt;</span></span><br><span class="line"><span class="string">    &lt;view class="</span>shop-info<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;text class="</span>shop-title ell<span class="string">"&gt;模板：店铺名称很长很长很长很长很长很长&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;text class="</span>shop-tel<span class="string">"&gt;电话：&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;text class="</span>shop-address<span class="string">"&gt;地址：&lt;/text&gt;</span></span><br><span class="line"><span class="string">        &lt;text class="</span>shop-time<span class="string">"&gt;营业时间：&lt;/text&gt;</span></span><br><span class="line"><span class="string">    &lt;/view&gt;</span></span><br><span class="line"><span class="string">    &lt;view class="</span>shop-star<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;view class='star-after'&gt;★★★★★&lt;/view&gt;</span></span><br><span class="line"><span class="string">        &lt;view class='star-before' style="</span>width:<span class="number">50</span>%;<span class="string">"&gt;★★★★★&lt;/view&gt;</span></span><br><span class="line"><span class="string">    &lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;/view&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;view class="</span>loadmore loading<span class="string">" wx:if="</span>&#123;&#123; hasMore &#125;&#125;<span class="string">"&gt;正在加载...&lt;/view&gt;</span></span><br><span class="line"><span class="string">&lt;view class="</span>loadmore<span class="string">" wx:else&gt;你已经到达我的底线了&lt;/view&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">page&#123;</span></span><br><span class="line"><span class="string">  background-color: #fff</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">.shop&#123;</span></span><br><span class="line"><span class="string">  padding: 20rpx;</span></span><br><span class="line"><span class="string">  border-bottom: 1rpx solid #ddd;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  position: relative</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">.shop-img&#123;</span></span><br><span class="line"><span class="string">  width: 160rpx;</span></span><br><span class="line"><span class="string">  height:  160rpx;</span></span><br><span class="line"><span class="string">  margin-right: 20rpx</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">.shop-info&#123;</span></span><br><span class="line"><span class="string"> width: 370rpx;</span></span><br><span class="line"><span class="string"> display: flex;</span></span><br><span class="line"><span class="string"> flex-direction: column;</span></span><br><span class="line"><span class="string"> font-size: 12px;</span></span><br><span class="line"><span class="string"> color: #666;</span></span><br><span class="line"><span class="string"> line-height: 1.5;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">.shop-title&#123;</span></span><br><span class="line"><span class="string">  font-size: 16px;</span></span><br><span class="line"><span class="string">  color: #333;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">.shop-star&#123;</span></span><br><span class="line"><span class="string">  position: absolute;</span></span><br><span class="line"><span class="string">  right: 20rpx;</span></span><br><span class="line"><span class="string">  top: 20rpx;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">/*评分星星*/</span></span><br><span class="line"><span class="string">.star-after&#123;</span></span><br><span class="line"><span class="string">  color: #e2e2e2;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.star-before&#123;</span></span><br><span class="line"><span class="string">  color: #f19138;</span></span><br><span class="line"><span class="string">  position: absolute;</span></span><br><span class="line"><span class="string">  left: 0px;</span></span><br><span class="line"><span class="string">  top:0px;</span></span><br><span class="line"><span class="string">  overflow: hidden;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.loadmore&#123;</span></span><br><span class="line"><span class="string">  text-align: center;</span></span><br><span class="line"><span class="string">  color: #888;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-4-列表页面导航栏标题"><a href="#9-4-4-列表页面导航栏标题" class="headerlink" title="9.4.4 列表页面导航栏标题"></a>9.4.4 列表页面导航栏标题</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(options.category)</span><br><span class="line">  <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">    search: <span class="keyword">this</span>.search.bind(<span class="keyword">this</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//这边有可能请求回来之后，onready还没有执行，因此设置导航栏标签的事情应该在onread函数中执行，此时能确保页面加载完毕</span></span><br><span class="line">  fetch(<span class="string">`categories/<span class="subst">$&#123;options.category&#125;</span>`</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    wx.setNavigationBarTitle(&#123;</span><br><span class="line">      title: res.data.name</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="9-4-5-列表页面数据获取显示"><a href="#9-4-5-列表页面数据获取显示" class="headerlink" title="9.4.5 列表页面数据获取显示"></a>9.4.5 列表页面数据获取显示</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">'../../utils/fetch.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// pages/list/list.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    hasMore: <span class="literal">true</span>,</span><br><span class="line">    title: <span class="string">""</span>,</span><br><span class="line">    shopList: [],</span><br><span class="line">    pageSize: <span class="number">20</span>,</span><br><span class="line">    pageIndex: <span class="number">0</span>,</span><br><span class="line">    category:<span class="literal">null</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options.category)</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      search: <span class="keyword">this</span>.search.bind(<span class="keyword">this</span>),</span><br><span class="line">      category: options.category</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这边有可能请求回来之后，onready还没有执行，因此设置导航栏标签的事情应该在onread函数中执行，此时能确保页面加载完毕</span></span><br><span class="line">    fetch(<span class="string">`categories/<span class="subst">$&#123;options.category&#125;</span>`</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      wx.setNavigationBarTitle(&#123;</span><br><span class="line">        title: res.data.name</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据分页请求列表数据</span></span><br><span class="line">    <span class="keyword">var</span> data = &#123;</span><br><span class="line">      _limit: <span class="keyword">this</span>.data.pageSize,</span><br><span class="line">      _page: ++<span class="keyword">this</span>.data.pageIndex</span><br><span class="line">    &#125;</span><br><span class="line">    fetch(<span class="string">`categories/<span class="subst">$&#123;options.category&#125;</span>/shops`</span>, data).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(res)</span><br><span class="line">      <span class="keyword">var</span> newList = <span class="keyword">this</span>.data.shopList.concat(res.data);</span><br><span class="line">      <span class="comment">// 2.3 获取数据的总数</span></span><br><span class="line">      <span class="keyword">var</span> count = <span class="built_in">parseInt</span>(res.header[<span class="string">'X-Total-Count'</span>]);</span><br><span class="line">      <span class="comment">// 2.4 用于判断比较是否还有更多数据</span></span><br><span class="line">      <span class="keyword">var</span> flag = <span class="keyword">this</span>.data.pageIndex * <span class="keyword">this</span>.data.pageSize &lt; count;</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        shopList: newList,</span><br><span class="line">        hasMore: flag,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  search: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//在这更改数据源</span></span><br><span class="line">        resolve([&#123;</span><br><span class="line">          text: <span class="string">'搜索结果'</span>,</span><br><span class="line">          value: <span class="number">1</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          text: <span class="string">'搜索结果2'</span>,</span><br><span class="line">          value: <span class="number">2</span></span><br><span class="line">        &#125;])</span><br><span class="line">      &#125;, <span class="number">200</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//选中某个搜索结果后</span></span><br><span class="line">  selectResult: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'select result'</span>, e.detail)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"shop"</span> wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123; shopList &#125;&#125;"</span> wx:key=<span class="string">"id"</span>&gt;</span><br><span class="line">    &lt;image <span class="class"><span class="keyword">class</span></span>=<span class="string">"shop-img"</span> src=<span class="string">"&#123;&#123; item.images[0] &#125;&#125;"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view class="shop-info"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;text class="shop-title ell"&gt;&#123;&#123; item.name &#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">        &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"shop-tel"</span>&gt;电话：&#123;&#123; item.phone &#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">        &lt;text class="shop-address"&gt;地址：&#123;&#123; item.address &#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">        &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"shop-time"</span>&gt;营业时间：&#123;&#123; item.businessHours &#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"shop-star"</span>&gt;</span><br><span class="line">        &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">'star-after'</span>&gt;★★★★★&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">        &lt;view class='star-before' style="width:&#123;&#123; item.score &#125;&#125;%;"&gt;★★★★★&lt;/</span>view&gt;</span><br><span class="line">    &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br></pre></td></tr></table></figure>

<h3 id="9-4-6-上拉加载实现"><a href="#9-4-6-上拉加载实现" class="headerlink" title="9.4.6 上拉加载实现"></a>9.4.6 上拉加载实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载更多样式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//app.wxss</span></span><br><span class="line">.loadmore &#123;</span><br><span class="line">    color: #888;</span><br><span class="line">    font-size: <span class="number">16</span>px;</span><br><span class="line">    line-height: <span class="number">100</span>rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.loadmore.loading::before &#123;</span><br><span class="line">    content: <span class="string">''</span>;</span><br><span class="line">    width: <span class="number">40</span>rpx;</span><br><span class="line">    height: <span class="number">40</span>rpx;</span><br><span class="line">    margin-top: <span class="number">-10</span>rpx;</span><br><span class="line">    margin-right: <span class="number">10</span>rpx;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line">    animation: loading <span class="number">1</span>s steps(<span class="number">12</span>) infinite;</span><br><span class="line">    background: transparent url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgxMDB2MTAwSDB6Ii8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTlFOUU5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTMwKSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iIzk4OTY5NyIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgzMCAxMDUuOTggNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjOUI5OTlBIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDYwIDc1Ljk4IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0EzQTFBMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA2NSA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNBQkE5QUEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoMTIwIDU4LjY2IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0IyQjJCMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgxNTAgNTQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjQkFCOEI5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDE4MCA1MCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDMkMwQzEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTE1MCA0NS45OCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDQkNCQ0IiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTEyMCA0MS4zNCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNEMkQyRDIiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM1IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0RBREFEQSIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgtNjAgMjQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTJFMkUyIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKC0zMCAtNS45OCA2NSkiLz48L3N2Zz4=) no-repeat;</span><br><span class="line">    background-size: <span class="number">100</span>%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes loading &#123;</span><br><span class="line">    <span class="number">0</span>% &#123;</span><br><span class="line">        transform: rotate(<span class="number">0</span>deg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">100</span>% &#123;</span><br><span class="line">        transform: rotate(<span class="number">-360</span>deg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.list.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"usingComponents"</span>: &#123;</span><br><span class="line">    <span class="string">"mp-searchbar"</span>: <span class="string">"../components/searchbar/searchbar"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"onReachBottomDistance"</span>:<span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.list.js</span></span><br><span class="line">onReachBottom:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"xxx"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">'../../utils/fetch.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// pages/list/list.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    hasMore: <span class="literal">true</span>,</span><br><span class="line">    title: <span class="string">""</span>,</span><br><span class="line">    shopList: [],</span><br><span class="line">    pageSize: <span class="number">20</span>,</span><br><span class="line">    pageIndex: <span class="number">0</span>,</span><br><span class="line">    category:<span class="literal">null</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options.category)</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      search: <span class="keyword">this</span>.search.bind(<span class="keyword">this</span>),</span><br><span class="line">      category: options.category</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这边有可能请求回来之后，onready还没有执行，因此设置导航栏标签的事情应该在onread函数中执行，此时能确保页面加载完毕</span></span><br><span class="line">    fetch(<span class="string">`categories/<span class="subst">$&#123;<span class="keyword">this</span>.data.category&#125;</span>`</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      wx.setNavigationBarTitle(&#123;</span><br><span class="line">        title: res.data.name</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.loadMore();</span><br><span class="line">  &#125;,</span><br><span class="line">  loadMore:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.data.hasMore) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//根据分页请求列表数据</span></span><br><span class="line">    <span class="keyword">var</span> data = &#123;</span><br><span class="line">      _limit: <span class="keyword">this</span>.data.pageSize,</span><br><span class="line">      _page: ++<span class="keyword">this</span>.data.pageIndex</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fetch(<span class="string">`categories/<span class="subst">$&#123;<span class="keyword">this</span>.data.category&#125;</span>/shops`</span>, data).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(res)</span><br><span class="line">      <span class="keyword">var</span> newList = <span class="keyword">this</span>.data.shopList.concat(res.data);</span><br><span class="line">      <span class="comment">// 2.3 获取数据的总数</span></span><br><span class="line">      <span class="keyword">var</span> count = <span class="built_in">parseInt</span>(res.header[<span class="string">'X-Total-Count'</span>]);</span><br><span class="line">      <span class="comment">// 2.4 用于判断比较是否还有更多数据</span></span><br><span class="line">      <span class="keyword">var</span> flag = <span class="keyword">this</span>.data.pageIndex * <span class="keyword">this</span>.data.pageSize &lt; count;</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        shopList: newList,</span><br><span class="line">        hasMore: flag,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  onReachBottom:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"xxx"</span>)</span><br><span class="line">    <span class="keyword">this</span>.loadMore();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="9-4-5-使用微信小程序API实现加载动画"><a href="#9-4-5-使用微信小程序API实现加载动画" class="headerlink" title="9.4.5 使用微信小程序API实现加载动画"></a>9.4.5 使用微信小程序API实现加载动画</h3><p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.hideLoading.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.hideLoading.html</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wx.showNavigationBarLoading()</span><br><span class="line">wx.hideNavigationBarLoading()</span><br><span class="line"></span><br><span class="line">wx.showLoading(&#123;</span><br><span class="line">    title:<span class="string">"努力加载中...."</span></span><br><span class="line">&#125;)</span><br><span class="line">wx.hideLoading()</span><br></pre></td></tr></table></figure>

<h3 id="9-4-6-下拉刷新"><a href="#9-4-6-下拉刷新" class="headerlink" title="9.4.6 下拉刷新"></a>9.4.6 下拉刷新</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"usingComponents"</span>: &#123;</span><br><span class="line">    <span class="string">"mp-searchbar"</span>: <span class="string">"../components/searchbar/searchbar"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"onReachBottomDistance"</span>:<span class="number">20</span>,</span><br><span class="line">  <span class="string">"enablePullDownRefresh"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> onPullDownRefresh: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"下拉事件"</span>);</span><br><span class="line">    <span class="comment">// 下拉刷新页面</span></span><br><span class="line">    <span class="comment">// 3.1 把数据先设置回默认值</span></span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      shopList: [],</span><br><span class="line">      pageIndex: <span class="number">0</span>,</span><br><span class="line">      hasMore: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">   <span class="comment">// 3.2 再重新请求数据</span></span><br><span class="line">    <span class="keyword">this</span>.loadMore().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="comment">// 3.3 加载数据完成之后停止下拉刷新(loadMore方法返回了一个Promise)</span></span><br><span class="line">      wx.stopPullDownRefresh();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="9-5-详情页"><a href="#9-5-详情页" class="headerlink" title="9.5 详情页"></a>9.5 详情页</h2><h3 id="9-5-1-wxs的使用"><a href="#9-5-1-wxs的使用" class="headerlink" title="9.5.1 wxs的使用"></a>9.5.1 wxs的使用</h3><p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxs/" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxs/</a></p>
<p>wxs：是小程序的一套脚本语言，结合 <code>WXML</code>，可以构建出页面的结构。主要用于编写页面内的一些模块，写一些js逻辑以便在页面使用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// page.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    a:<span class="number">1</span>,</span><br><span class="line">    b:<span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!--wxml--&gt;</span><br><span class="line">&lt;!-- 下面的 getSum 函数，接收两个值，求两个值的和 --&gt;</span><br><span class="line">&lt;wxs <span class="built_in">module</span>=<span class="string">"m1"</span>&gt;</span><br><span class="line"><span class="keyword">var</span> getSum = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sum = <span class="literal">undefined</span>;</span><br><span class="line">  sum = a+b</span><br><span class="line">  <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports.getSum = getSum;</span><br><span class="line">&lt;<span class="regexp">/wxs&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!-- 调用 wxs 里面的 getMax 函数，参数为 page.js 里面的 array --&gt;</span></span><br><span class="line"><span class="regexp">&lt;view&gt; &#123;&#123;m1.getSum(a,b)&#125;&#125; &lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--注意：</span><br><span class="line"><span class="number">1.</span>在插值表达式中只可以这样用:&#123;&#123;data中的数据&#125;&#125;。不可以&#123;&#123;data中的方法&#125;&#125;</span><br><span class="line"><span class="number">2.</span>wxs中不支持es6的新特性--&gt;</span><br></pre></td></tr></table></figure>

<h3 id="9-5-2-详情页实现"><a href="#9-5-2-详情页实现" class="headerlink" title="9.5.2 详情页实现"></a>9.5.2 详情页实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 顶部轮播图  --&gt;</span><br><span class="line">&lt;swiper <span class="class"><span class="keyword">class</span></span>=<span class="string">'slider'</span> autoplay=<span class="string">"&#123;&#123;true&#125;&#125;"</span> interval=<span class="string">"5000"</span> duration=<span class="string">"1000"</span>&gt;</span><br><span class="line">  &lt;block wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;shop.images&#125;&#125;"</span> wx:key=<span class="string">"unique"</span>&gt;</span><br><span class="line">    &lt;swiper-item&gt;</span><br><span class="line">      &lt;!--点击图片显示预览，data-src：传递数据--&gt;</span><br><span class="line">      &lt;image bindtap=<span class="string">"preview"</span> data-src=<span class="string">"&#123;&#123;item&#125;&#125;"</span> src=<span class="string">"&#123;&#123;item&#125;&#125;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"slide-image"</span>/&gt;</span><br><span class="line">    &lt;<span class="regexp">/swiper-item&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>block&gt;</span><br><span class="line">&lt;<span class="regexp">/swiper&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!-- 内容区域  --&gt;</span></span><br><span class="line"><span class="regexp">&lt;view class='product'&gt;</span></span><br><span class="line"><span class="regexp">  &lt;text class='pro-name'&gt;&#123;&#123; shop.name &#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">  &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">'pro-phone'</span>&gt;电话: &#123;&#123; shop.phone &#125;&#125; &lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">  &lt;text class='pro-address'&gt;地址: &#123;&#123; shop.address &#125;&#125; &lt;/</span>text&gt;</span><br><span class="line">  &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">'pro-time'</span>&gt;营业时间: &#123;&#123; shop.businessHours &#125;&#125; &lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 评论区域  --&gt;</span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"comments"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span> wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123; shop.comments &#125;&#125;"</span> wx:key=<span class="string">"unique"</span>&gt;</span><br><span class="line">    &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"name"</span>&gt;&#123;&#123; item.name &#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;text class="date"&gt;&#123;&#123; item.date &#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">    &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"rating"</span>&gt;&#123;&#123; item.rating &#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;text class="content"&gt;&#123;&#123; item.content &#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">    &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"images"</span> &gt;</span><br><span class="line">      &lt;image wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123; item.images &#125;&#125;"</span> wx:key=<span class="string">"unique"</span> wx:<span class="keyword">for</span>-item=<span class="string">"v"</span> src=<span class="string">'&#123;&#123; imgutil.size(v) &#125;&#125;'</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--页面内的模块：写一些js逻辑，用来替换字符串的指定内容</span><br><span class="line">因为服务器给我们返回了下面的网址，下面网址直接打开是显示不了图片的，我们需要将网址中的w.h换成具体的尺寸</span><br><span class="line"><span class="string">"http://p0.meituan.net/w.h/shaitu/4ffbaec3f82fe3b4240aedb22fee22e5267105.jpg"</span></span><br><span class="line">--&gt;</span><br><span class="line">&lt;!-- 注意：这里不支持es6的一些新特性  --&gt;</span><br><span class="line">&lt;wxs <span class="built_in">module</span>=<span class="string">"imgutil"</span>&gt;</span><br><span class="line">  <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    size: <span class="function"><span class="keyword">function</span>(<span class="params"> input </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> input.replace(<span class="string">"w.h"</span>, <span class="string">"100.100"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/wxs&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span>* 轮播图样式  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">.slider &#123;</span></span><br><span class="line"><span class="regexp">  width: 750rpx;</span></span><br><span class="line"><span class="regexp">  height: 500rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.slider image &#123;</span></span><br><span class="line"><span class="regexp">  width: 100%;</span></span><br><span class="line"><span class="regexp">  height: 100%;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span>* 商品详情页样式  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">.product &#123;</span></span><br><span class="line"><span class="regexp">  display: flex;</span></span><br><span class="line"><span class="regexp">  flex-direction: column;</span></span><br><span class="line"><span class="regexp">  background-color: white;</span></span><br><span class="line"><span class="regexp">  font-size: 14px;</span></span><br><span class="line"><span class="regexp">  padding: 20rpx 30rpx;</span></span><br><span class="line"><span class="regexp">  color: rgb(110,115,126);</span></span><br><span class="line"><span class="regexp">  border-top: 1rpx solid #ddd;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.pro-name &#123;</span></span><br><span class="line"><span class="regexp">  font-size: 20px;</span></span><br><span class="line"><span class="regexp">  color: rgb(56,64,74);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span>* 评论样式  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">.comments &#123;</span></span><br><span class="line"><span class="regexp">  margin-top: 20rpx;</span></span><br><span class="line"><span class="regexp">  padding: 20rpx;</span></span><br><span class="line"><span class="regexp">  background-color: #fff;</span></span><br><span class="line"><span class="regexp">  color: #345;</span></span><br><span class="line"><span class="regexp">  font-size: 24rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.comments .item &#123;</span></span><br><span class="line"><span class="regexp">  display: flex;</span></span><br><span class="line"><span class="regexp">  position: relative;</span></span><br><span class="line"><span class="regexp">  flex-direction: column;</span></span><br><span class="line"><span class="regexp">  padding: 20rpx;</span></span><br><span class="line"><span class="regexp">  border-bottom: 1rpx solid #eee;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.comments .item .name &#123;</span></span><br><span class="line"><span class="regexp">  margin-top: 20rpx;</span></span><br><span class="line"><span class="regexp">  font-size: 36rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.comments .item .date &#123;</span></span><br><span class="line"><span class="regexp">  align-self: flex-end;</span></span><br><span class="line"><span class="regexp">  margin: -40rpx 0 20rpx;</span></span><br><span class="line"><span class="regexp">  color: #567;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.comments .item .rating &#123;</span></span><br><span class="line"><span class="regexp">  position: absolute;</span></span><br><span class="line"><span class="regexp">  top: 20rpx;</span></span><br><span class="line"><span class="regexp">  right: 10rpx;</span></span><br><span class="line"><span class="regexp">  color: #ee523d;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.comments .item image &#123;</span></span><br><span class="line"><span class="regexp">  width: 110rpx;</span></span><br><span class="line"><span class="regexp">  height: 110rpx;</span></span><br><span class="line"><span class="regexp">  margin: 10rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const fetch = require('../</span>../utils/fetch.js<span class="string">')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Page(&#123;</span></span><br><span class="line"><span class="string">  data: &#123;</span></span><br><span class="line"><span class="string">    shop: &#123;&#125;,</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  onLoad: function (options) &#123;</span></span><br><span class="line"><span class="string">    let shopid = options.item</span></span><br><span class="line"><span class="string">    fetch(`shops/$&#123;shopid&#125;`).then(res =&gt; &#123;</span></span><br><span class="line"><span class="string">      console.log(res.data);</span></span><br><span class="line"><span class="string">      this.setData(&#123; shop: res.data &#125;)</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // 该方法用于图片预览</span></span><br><span class="line"><span class="string">//https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.previewImage.html</span></span><br><span class="line"><span class="string">  preview(e) &#123;</span></span><br><span class="line"><span class="string">    wx.previewImage(&#123;</span></span><br><span class="line"><span class="string">      current: e.target.dataset.src, // 当前显示图片的http链接</span></span><br><span class="line"><span class="string">      urls: this.data.shop.images // 需要预览的图片http链接列表</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="9-6-消息页"><a href="#9-6-消息页" class="headerlink" title="9.6 消息页"></a>9.6 消息页</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"messages"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span> wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123; messages &#125;&#125;"</span> wx:key=<span class="string">"unquine"</span>&gt;</span><br><span class="line">    &lt;navigator&gt;</span><br><span class="line">      &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"title"</span>&gt;&#123;&#123; item.title &#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>navigator&gt;</span><br><span class="line">    &lt;text <span class="class"><span class="keyword">class</span></span>=<span class="string">"date"</span>&gt;&#123;&#123; item.date &#125;&#125;&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;navigator&gt;</span></span><br><span class="line"><span class="regexp">      &lt;image src="&#123;&#123; item.image &#125;&#125;"/</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;text class="summary"&gt;&#123;&#123; item.summary &#125;&#125;&lt;/</span>text&gt;</span><br><span class="line">    &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"expand"</span>&gt;Read All&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>view&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;view id="bottom"&gt;&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.messages &#123;</span><br><span class="line">  padding: <span class="number">60</span>rpx <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  margin-bottom: <span class="number">60</span>rpx;</span><br><span class="line">  padding: <span class="number">20</span>rpx <span class="number">35</span>rpx;</span><br><span class="line">  border: 1rpx solid #ddd;</span><br><span class="line">  border-radius: <span class="number">10</span>rpx;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item:last-child &#123;</span><br><span class="line">  margin-bottom: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item .title &#123;</span><br><span class="line">  font-size: <span class="number">40</span>rpx;</span><br><span class="line">  color: #222;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item .date &#123;</span><br><span class="line">  margin-bottom: <span class="number">10</span>rpx;</span><br><span class="line">  border-bottom: 1rpx solid #eee;</span><br><span class="line">  font-size: <span class="number">26</span>rpx;</span><br><span class="line">  color: #888;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item image &#123;</span><br><span class="line">  width: <span class="number">100</span>%;</span><br><span class="line">  height: <span class="number">300</span>rpx;</span><br><span class="line">  margin: <span class="number">10</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item .summary &#123;</span><br><span class="line">  margin-bottom: <span class="number">10</span>rpx;</span><br><span class="line">  padding-bottom: <span class="number">10</span>rpx;</span><br><span class="line">  border-bottom: 1rpx solid #eee;</span><br><span class="line">  font-size: <span class="number">28</span>rpx;</span><br><span class="line">  color: #444;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item .expand &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  color: #333;</span><br><span class="line">  font-size: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.messages .item .expand::after &#123;</span><br><span class="line">  content: <span class="string">''</span>;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  margin-right: <span class="number">10</span>rpx;</span><br><span class="line">  height: <span class="number">10</span>rpx;</span><br><span class="line">  width: <span class="number">10</span>rpx;</span><br><span class="line">  border: 0 solid #ccc;</span><br><span class="line">  border-width: <span class="number">3</span>rpx <span class="number">3</span>rpx <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  transform: matrix(<span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// pages/message/message.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    messages: []</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> messages = <span class="keyword">this</span>.data.messages</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++) &#123;</span><br><span class="line">      messages.push(&#123;</span><br><span class="line">        title: <span class="string">'免费送票！超有内涵的门票。'</span>,</span><br><span class="line">        date: i + <span class="string">' September'</span>,</span><br><span class="line">        image: <span class="string">'https://unsplash.it/400/300'</span>,</span><br><span class="line">        summary: <span class="string">'最糟糕的，也许就是最幸运的。'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setData(&#123; messages &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  onReady() &#123;</span><br><span class="line">    <span class="keyword">const</span> query = wx.createSelectorQuery()</span><br><span class="line">    <span class="comment">//创建一个查询请求</span></span><br><span class="line">    query.select(<span class="string">'#bottom'</span>).boundingClientRect()</span><br><span class="line">    <span class="comment">//执行上面的查询请求，让页面滚动到底部</span></span><br><span class="line">    query.exec(<span class="function"><span class="params">res</span> =&gt;</span> wx.pageScrollTo(&#123; <span class="attr">scrollTop</span>: res[<span class="number">0</span>].top &#125;))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="9-7-个人页"><a href="#9-7-个人页" class="headerlink" title="9.7 个人页"></a>9.7 个人页</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"avatar"</span>&gt;</span><br><span class="line">  &lt;image src=<span class="string">"/assets/avatar.png"</span> bindtap=<span class="string">"loginHandle"</span>&gt;&lt;<span class="regexp">/image&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line">&lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"cells"</span>&gt;</span><br><span class="line">  &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;个人资料&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">  &lt;navigator class="item"&gt;我的优惠券&lt;/</span>navigator&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"divider"</span>&gt;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;navigator class="item"&gt;常见问题&lt;/</span>navigator&gt;</span><br><span class="line">  &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;使用条款&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">  &lt;navigator class="item"&gt;隐私权政策&lt;/</span>navigator&gt;</span><br><span class="line">  &lt;navigator <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;联系客服&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="divider"&gt;&lt;/</span>view&gt;</span><br><span class="line">  &lt;navigator url=<span class="string">"/pages/setting/setting"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;设置&lt;<span class="regexp">/navigator&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.avatar &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line">  height: <span class="number">400</span>rpx;</span><br><span class="line">  background-color: #3a4861;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.avatar image &#123;</span><br><span class="line">  width: <span class="number">220</span>rpx;</span><br><span class="line">  height: <span class="number">220</span>rpx;</span><br><span class="line">  border-radius: <span class="number">50</span>%;</span><br><span class="line">  box-shadow: 0 0 0 10rpx #777f92;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.cells &#123;</span><br><span class="line">  margin-top: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.cells .item &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  position: relative;</span><br><span class="line">  padding: <span class="number">20</span>rpx <span class="number">30</span>rpx;</span><br><span class="line">  border-bottom: 1rpx solid #f0f0f0;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  font-size: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.cells .item::after &#123;</span><br><span class="line">  content: <span class="string">''</span>;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  height: <span class="number">10</span>rpx;</span><br><span class="line">  width: <span class="number">10</span>rpx;</span><br><span class="line">  border: 0 solid #ccc;</span><br><span class="line">  border-width: <span class="number">3</span>rpx <span class="number">3</span>rpx <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  transform: matrix(<span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.cells .divider &#123;</span><br><span class="line">  height: <span class="number">20</span>rpx;</span><br><span class="line">  box-shadow: inset 0 1rpx 2rpx #eee;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-8-小程序调试"><a href="#9-8-小程序调试" class="headerlink" title="9.8 小程序调试"></a>9.8 小程序调试</h2><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1570004655409.png"  alt="1570004655409"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1569997119951.png"  alt="1569997119951"></p>
<h2 id="9-9-小程序发布"><a href="#9-9-小程序发布" class="headerlink" title="9.9 小程序发布"></a>9.9 小程序发布</h2><p>1.把不校验合法域名前面的勾去掉，然后重新编译运行项目，看项目是否会出问题</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576289706127.png"  alt="1576289706127"></p>
<p>2.修改小程序的Appid为自己注册的ip，不要使用测试号</p>
<p>3.点击上传按钮，将小程序上传到微信(注意：文件不超过2M，后期可以通过分包技术上传，但是总计不超过12M)</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576289845558.png"  alt="1576289845558"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576290078884.png"  alt="1576290078884"></p>
<p>4.登陆小程序后台，提交审核。审核通过之后，在线上版本会看到对应的小程序，此时就可以在微信的小程序中根据名字搜索到小程序了</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576290196252.png"  alt="1576290196252"></p>
<h1 id="10-微信公众号开发"><a href="#10-微信公众号开发" class="headerlink" title="10.微信公众号开发"></a>10.微信公众号开发</h1><h2 id="10-1-公众号分类"><a href="#10-1-公众号分类" class="headerlink" title="10.1 公众号分类"></a>10.1 公众号分类</h2><ul>
<li>微信公众平台是腾讯旗下的一个平台，微信公众平台中有以下三种<a href="https://www.baidu.com/s?wd=%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao" target="_blank" rel="noopener">微信公众号</a>类型：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、订阅号</span><br><span class="line">2、服务号</span><br><span class="line">3、企业号：企业号多半是企业内容使用，用于管理员工通讯，方便员工通讯，信息集合和消息通知等功能，相当与一个移动的小型oa系统了。一般不用来对外宣传推广</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570007801353.png"  alt="1570007801353"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570007831333.png"  alt="1570007831333"></p>
<ul>
<li><p>服务号和订阅号的区别：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.出现的位置不同</span><br><span class="line">2.单月发送的消息数量不同，订阅号每天1篇，服务号每月4篇</span><br><span class="line">3.订阅号没有9大接口和支付功能</span><br><span class="line">   9大接口包括：语音识别、客服接口、OAuth 2.0网页授权、生成带参数的二维码、获取用户地理位置、获取用户基本信息、获取关注者列表、用户分组接口、上传和下载多媒体文件</span><br></pre></td></tr></table></figure>

<blockquote>
<p>微信公众号认证账号和非认证账号的区别：认证账号就是可以在添加好友里根据名字搜索到该账号</p>
</blockquote>
</li>
</ul>
<h2 id="10-2-公众号注册"><a href="#10-2-公众号注册" class="headerlink" title="10.2 公众号注册"></a>10.2 公众号注册</h2><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570007773539.png"  alt="1570007773539"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570007910010.png"  alt="1570007910010"></p>
<h2 id="10-3-微信公众号基本功能"><a href="#10-3-微信公众号基本功能" class="headerlink" title="10.3 微信公众号基本功能"></a>10.3 微信公众号基本功能</h2><h3 id="10-3-1-自动回复"><a href="#10-3-1-自动回复" class="headerlink" title="10.3.1 自动回复"></a>10.3.1 自动回复</h3><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570008312002.png"  alt="1570008312002"></p>
<pre><code>&lt;https://kf.qq.com/faq/161221FZnEfe161221Ibmamq.html&gt;

收到消息回复在一小时内只能回复一到两条，所有有必要设置关键词回复</code></pre><h3 id="10-3-2-自定义菜单"><a href="#10-3-2-自定义菜单" class="headerlink" title="10.3.2 自定义菜单"></a>10.3.2 自定义菜单</h3><p><a href="http://classic.getemoji.com/" target="_blank" rel="noopener">http://classic.getemoji.com/</a> 可以在这个网址中选择对应的图标，给菜单的名字添加图标</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570009469509.png"  alt="1570009469509"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570009558069.png"  alt="1570009558069"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570009718993.png"  alt="1570009718993"></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/1570009813005.png"  alt="1570009813005"></p>
<h3 id="10-3-3-投票管理"><a href="#10-3-3-投票管理" class="headerlink" title="10.3.3 投票管理"></a>10.3.3 投票管理</h3><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576461102561.png"  alt="1576461102561"></p>
<p>投票管理需要插入到对应的文章后才能生效</p>
<h3 id="10-3-4-页面模板使用"><a href="#10-3-4-页面模板使用" class="headerlink" title="10.3.4 页面模板使用"></a>10.3.4 页面模板使用</h3><h4 id="a-添加页面模板"><a href="#a-添加页面模板" class="headerlink" title="a) 添加页面模板"></a>a) 添加页面模板</h4><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576463387072.png"  alt="1576463387072"></p>
<h4 id="b-绑定页面模板"><a href="#b-绑定页面模板" class="headerlink" title="b) 绑定页面模板"></a>b) 绑定页面模板</h4><p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576463332280.png"  alt="1576463332280"></p>
<h3 id="10-4-公众号后台开发"><a href="#10-4-公众号后台开发" class="headerlink" title="10.4 公众号后台开发"></a>10.4 公众号后台开发</h3><p>除了使用上面所提到的直接在微信公众号后台配置的基本功能之外，微信公众号还允许我们接入后台程序。需要注意的是，一旦后台接入之后，之前的配置会自动失效。</p>
<h4 id="10-4-1-后台接入"><a href="#10-4-1-后台接入" class="headerlink" title="10.4.1 后台接入"></a>10.4.1 后台接入</h4><p><strong>a) 微信公众号后台配置</strong></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576470117197.png"  alt="1576470117197"></p>
<p><strong>b) node后台</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> parseString = <span class="built_in">require</span>(<span class="string">'xml2js'</span>).parseString;<span class="comment">//引入xml2js包</span></span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sha1 = <span class="built_in">require</span>(<span class="string">'sha1'</span>);</span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    appID: <span class="string">'wx16b01d87eca9d8f4'</span>, <span class="comment">//公众号里面取</span></span><br><span class="line">    AppSecret: <span class="string">'41458d7494fe25ed6d957a7632d72cfa'</span>, <span class="comment">//公众号里面取</span></span><br><span class="line">    token: <span class="string">'mytoken1234'</span> <span class="comment">//自定义的token</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.method)</span><br><span class="line">    <span class="keyword">if</span> (req.method == <span class="string">'GET'</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> signature = req.query.signature,</span><br><span class="line">            timestamp = req.query.timestamp,</span><br><span class="line">            nonce = req.query.nonce,</span><br><span class="line">            echostr = req.query.echostr;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// token、timestamp、nonce三个参数进行字典序排序</span></span><br><span class="line">        <span class="keyword">var</span> arr = [config.token, timestamp, nonce].sort().join(<span class="string">''</span>);</span><br><span class="line">        <span class="comment">// sha1加密    </span></span><br><span class="line">        <span class="keyword">var</span> result = sha1(arr);</span><br><span class="line">        <span class="built_in">console</span>.log(result, signature)</span><br><span class="line">        <span class="keyword">if</span> (result === signature) &#123;</span><br><span class="line">            res.send(echostr);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.send(<span class="string">'mismatch'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        next()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8000</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"running...."</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>c) 将node后台端口通过ngrok映射到外网</strong></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576470280500.png"  alt="1576470280500"></p>
<p><strong>d) 后台接入流程</strong></p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576470380003.png"  alt="1576470380003"></p>
<h4 id="10-4-2-回复消息"><a href="#10-4-2-回复消息" class="headerlink" title="10.4.2 回复消息"></a>10.4.2 回复消息</h4><p><a href="https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Passive_user_reply_message.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Passive_user_reply_message.html</a></p>
<blockquote>
<p>公众号的接口权限可在后台查询，微信公众号在定义客户端和服务端交互的时候，使用的数据格式是xml。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;xml&gt;</span><br><span class="line">  &lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;&#x2F;ToUserName&gt;</span><br><span class="line">  &lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;&#x2F;FromUserName&gt;</span><br><span class="line">  &lt;CreateTime&gt;12345678&lt;&#x2F;CreateTime&gt;</span><br><span class="line">  &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;&#x2F;MsgType&gt;</span><br><span class="line">  &lt;Content&gt;&lt;![CDATA[你好]]&gt;&lt;&#x2F;Content&gt;</span><br><span class="line">&lt;&#x2F;xml&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理微信post消息请求 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> buffer = [];</span><br><span class="line">        <span class="comment">//监听 data 事件 用于接收数据</span></span><br><span class="line">        req.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            buffer.push(data);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//监听 end 事件 用于处理接收完成的数据</span></span><br><span class="line">        req.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//输出接收完成的数据</span></span><br><span class="line">            parseString(Buffer.concat(buffer).toString(<span class="string">'utf-8'</span>), &#123; <span class="attr">explicitArray</span>: <span class="literal">false</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="comment">//打印错误信息</span></span><br><span class="line">                    <span class="built_in">console</span>.log(err);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//打印解析结果</span></span><br><span class="line">                    <span class="built_in">console</span>.log(result);</span><br><span class="line">                    result = result.xml;</span><br><span class="line">                    <span class="keyword">var</span> toUser = result.ToUserName; <span class="comment">//接收方微信</span></span><br><span class="line">                    <span class="keyword">var</span> fromUser = result.FromUserName;<span class="comment">//发送仿微信</span></span><br><span class="line">                    <span class="keyword">if</span> (result.Event === <span class="string">'subscribe'</span>) &#123;</span><br><span class="line">                        <span class="comment">//回复消息</span></span><br><span class="line">                        <span class="keyword">var</span> xml = returntext(fromUser, toUser, <span class="string">'欢迎关注公众号,hahhh'</span>);</span><br><span class="line">                        <span class="built_in">console</span>.log(xml)</span><br><span class="line">                        res.send(xml)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">var</span> xml = returntext(fromUser, toUser, <span class="string">'您好'</span>);</span><br><span class="line">                        <span class="built_in">console</span>.log(xml)</span><br><span class="line">                        res.send(xml)</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//回复文本消息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">returntext</span>(<span class="params">toUser, fromUser, content</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xmlContent = <span class="string">"&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA["</span> + toUser + <span class="string">"]]&gt;&lt;/ToUserName&gt;"</span>;</span><br><span class="line">    xmlContent += <span class="string">"&lt;FromUserName&gt;&lt;![CDATA["</span> + fromUser + <span class="string">"]]&gt;&lt;/FromUserName&gt;"</span>;</span><br><span class="line">    xmlContent += <span class="string">"&lt;CreateTime&gt;"</span> + <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() + <span class="string">"&lt;/CreateTime&gt;"</span>;</span><br><span class="line">    xmlContent += <span class="string">"&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;"</span>;</span><br><span class="line">    xmlContent += <span class="string">"&lt;Content&gt;&lt;![CDATA["</span> + content + <span class="string">"]]&gt;&lt;/Content&gt;&lt;/xml&gt;"</span>;</span><br><span class="line">    <span class="keyword">return</span> xmlContent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-4-3-重新开启自定义菜单"><a href="#10-4-3-重新开启自定义菜单" class="headerlink" title="10.4.3 重新开启自定义菜单"></a>10.4.3 重新开启自定义菜单</h4><p>当接入公众号后台之后，原来的自定义菜单、回复等功能会失效。如果想自定义菜单和公众号后台同时生效，我们可以在添加功能插件–&gt;自定义菜单中开启。</p>
<p><img src="/" class="lazyload" data-src="/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/assets%5C1576469739930.png"  alt="1576469739930"></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小逸</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">http://yoursite.com/2019/11/11/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">小逸的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1588051543473&amp;di=67f191093aa1a813125aa3036b4aaf85&amp;imgtype=0&amp;src=http%3A%2F%2Fimg0.imgtn.bdimg.com%2Fit%2Fu%3D2340366615%2C2853341379%26fm%3D214%26gp%3D0.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/11/25/Flex%E5%B8%83%E5%B1%80%E6%95%99%E7%A8%8B%EF%BC%9A%E8%AF%AD%E6%B3%95%E7%AF%87-%E9%98%AE%E4%B8%80%E5%B3%B0/"><img class="prev_cover lazyload" data-src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071002.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Flex布局教程：语法篇-阮一峰</div></div></a></div><div class="next-post pull_right"><a href="/2019/10/20/Create-React-App/"><img class="next_cover lazyload" data-src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=2035944494,3453366933&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Create-React-App</div></div></a></div></nav></article></main><footer id="footer" style="background-image: url(https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2455514678,1879015385&amp;fm=26&amp;gp=0.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By 小逸</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>